"use strict";(self.webpackChunkwirepharma=self.webpackChunkwirepharma||[]).push([[261],{9261:(ii,xe,u)=>{u.r(xe),u.d(xe,{StockModule:()=>oi});var C=u(5357),Ue=u(499),e=u(5e3);let qe=(()=>{class o{constructor(){}ngOnInit(){}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.Xpm({type:o,selectors:[["ath-stock"]],decls:1,vars:0,template:function(t,i){1&t&&e._UZ(0,"router-outlet")},directives:[C.lC],encapsulation:2}),o})();var Q=u(5245),Qe=u(7238);let Fe=(()=>{class o{constructor(){}ngOnInit(){}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.Xpm({type:o,selectors:[["stock-panel"]],decls:155,vars:4,consts:[[1,"flex","flex-col","flex-auto","w-full"],[1,"flex","flex-wrap","w-full","max-w-screen-xl","p-6","mx-auto","md:p-8"],[1,"flex","items-center","justify-between","w-full"],[1,"text-3xl","font-semibold","leading-8","tracking-tight"],[1,"font-medium","tracking-tight","text-secondary"],[1,"grid","w-full","grid-cols-1","gap-8","mt-6","sm:grid-cols-2","lg:grid-cols-4","md:mt-8"],[1,"flex","flex-col","flex-auto","p-6","overflow-hidden","transition-shadow","duration-100","ease-linear","shadow","cursor-pointer","bg-card","rounded-2xl","hover:shadow-lg"],[1,"flex","items-start","justify-between"],[1,"text-lg","font-medium","leading-6","tracking-tight","truncate"],[1,"ml-2"],[1,"h-6","px-2","rounded-lg","min-h-6","bg-primary-100"],[1,"font-mono","text-lg","font-medium","text-primary-900"],["routerLink","/stock/panels/products",1,"flex","flex-col","flex-auto","p-6","overflow-hidden","transition-shadow","duration-100","ease-linear","shadow","cursor-pointer","bg-card","rounded-2xl","hover:shadow-lg"],[1,"w-full","mt-12"],[1,"text-2xl","font-semibold","leading-6","tracking-tight"],[1,"flex","flex-col","flex-auto","p-6","overflow-hidden","shadow","bg-card","rounded-2xl"],[1,"flex","items-start","justify-start"],[1,"mr-3",3,"svgIcon"],[1,"flex","flex-col","mt-5"],["routerLink","/stock/panels/products",1,"flex","items-center","justify-start","p-1.5","cursor-pointer","rounded-lg","hover:bg-hover"],[1,"flex","items-center","justify-center","w-6","h-6","mr-3","rounded-lg","bg-primary-100"],[1,"w-1","h-1","rounded-full","bg-primary-500"],[1,"text-lg","leading-6","tracking-tight"],["routerLink","/stock/panels/categories",1,"flex","items-center","justify-start","p-1.5","cursor-pointer","rounded-lg","hover:bg-hover"],["matTooltip","En desarrollo",1,"flex","items-center","justify-start","p-1.5","cursor-not-allowed","rounded-lg","hover:bg-hover"],[1,"flex","items-center","justify-center","w-6","h-6","mr-3","rounded-lg","bg-slate-100"],[1,"w-1","h-1","rounded-full","bg-slate-900"],["matTooltip","En desarrollo",1,"flex","items-center","justify-start","p-1.5","cursor-pointer","rounded-lg","hover:bg-hover"],["routerLink","/stock/panels/warehouse",1,"flex","items-center","justify-start","p-1.5","cursor-pointer","rounded-lg","hover:bg-hover"],["routerLink","/stock/panels/suppliers",1,"flex","items-center","justify-start","p-1.5","cursor-pointer","rounded-lg","hover:bg-hover"],["routerLink","/stock/panels/brands",1,"flex","items-center","justify-start","p-1.5","cursor-pointer","rounded-lg","hover:bg-hover"],["routerLink","/stock/panels/uom",1,"flex","items-center","justify-start","p-1.5","cursor-pointer","rounded-lg","hover:bg-hover"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div")(4,"div",3),e._uU(5,"Gesti\xf3n de Inventarios"),e.qZA(),e.TgZ(6,"div",4),e._uU(7," Este m\xf3dulo est\xe1 dedicado a todos los componentes de la gesti\xf3n de inventarios y productos. "),e.qZA()()(),e.TgZ(8,"div",5)(9,"div",6)(10,"div",7)(11,"div",8),e._uU(12,"Almacenes"),e.qZA(),e.TgZ(13,"div",9)(14,"div",10)(15,"span",11),e._uU(16,"0"),e.qZA()()()()(),e.TgZ(17,"div",6)(18,"div",7)(19,"div",8),e._uU(20,"Categor\xedas"),e.qZA(),e.TgZ(21,"div",9)(22,"div",10)(23,"span",11),e._uU(24,"0"),e.qZA()()()()(),e.TgZ(25,"div",12)(26,"div",7)(27,"div",8),e._uU(28,"Productos"),e.qZA(),e.TgZ(29,"div",9)(30,"div",10)(31,"span",11),e._uU(32,"0"),e.qZA()()()()(),e.TgZ(33,"div",6)(34,"div",7)(35,"div",8),e._uU(36,"Proveedores"),e.qZA(),e.TgZ(37,"div",9)(38,"div",10)(39,"span",11),e._uU(40,"0"),e.qZA()()()()(),e.TgZ(41,"div",6)(42,"div",7)(43,"div",8),e._uU(44,"Marcas"),e.qZA(),e.TgZ(45,"div",9)(46,"div",10)(47,"span",11),e._uU(48,"0"),e.qZA()()()()(),e.TgZ(49,"div",6)(50,"div",7)(51,"div",8),e._uU(52,"Entradas"),e.qZA()()(),e.TgZ(53,"div",6)(54,"div",7)(55,"div",8),e._uU(56,"Despachos"),e.qZA()()()(),e.TgZ(57,"div",13)(58,"div",14),e._uU(59,"Reportes y Listados"),e.qZA()(),e.TgZ(60,"div",5)(61,"div",15)(62,"div",16),e._UZ(63,"mat-icon",17),e.TgZ(64,"div",8),e._uU(65,"Productos y Precios"),e.qZA()(),e.TgZ(66,"div",18)(67,"div",19)(68,"div",20),e._UZ(69,"div",21),e.qZA(),e.TgZ(70,"div",22),e._uU(71,"Productos"),e.qZA()(),e.TgZ(72,"div",23)(73,"div",20),e._UZ(74,"div",21),e.qZA(),e.TgZ(75,"div",22),e._uU(76,"Categor\xedas de productos"),e.qZA()(),e.TgZ(77,"div",24)(78,"div",25),e._UZ(79,"div",26),e.qZA(),e.TgZ(80,"div",22),e._uU(81,"Arancel aduanero"),e.qZA()()()(),e.TgZ(82,"div",15)(83,"div",16),e._UZ(84,"mat-icon",17),e.TgZ(85,"div",8),e._uU(86,"Movimiento de inventarios"),e.qZA()(),e.TgZ(87,"div",18)(88,"div",24)(89,"div",25),e._UZ(90,"div",26),e.qZA(),e.TgZ(91,"div",22),e._uU(92,"\xd3rdenes"),e.qZA()(),e.TgZ(93,"div",24)(94,"div",25),e._UZ(95,"div",26),e.qZA(),e.TgZ(96,"div",22),e._uU(97,"Facturas de Compras"),e.qZA()(),e.TgZ(98,"div",24)(99,"div",25),e._UZ(100,"div",26),e.qZA(),e.TgZ(101,"div",22),e._uU(102,"Entrada de productos"),e.qZA()(),e.TgZ(103,"div",24)(104,"div",25),e._UZ(105,"div",26),e.qZA(),e.TgZ(106,"div",22),e._uU(107,"Registro de despachos"),e.qZA()()()(),e.TgZ(108,"div",15)(109,"div",16),e._UZ(110,"mat-icon",17),e.TgZ(111,"div",8),e._uU(112,"Informes de existencias"),e.qZA()(),e.TgZ(113,"div",18)(114,"div",27)(115,"div",25),e._UZ(116,"div",26),e.qZA(),e.TgZ(117,"div",22),e._uU(118,"Registro de operaciones"),e.qZA()(),e.TgZ(119,"div",24)(120,"div",25),e._UZ(121,"div",26),e.qZA(),e.TgZ(122,"div",22),e._uU(123,"Balance de inventarios"),e.qZA()(),e.TgZ(124,"div",24)(125,"div",25),e._UZ(126,"div",26),e.qZA(),e.TgZ(127,"div",22),e._uU(128,"Productos envejecidos"),e.qZA()()()(),e.TgZ(129,"div",15)(130,"div",16),e._UZ(131,"mat-icon",17),e.TgZ(132,"div",8),e._uU(133,"Nomencladores"),e.qZA()(),e.TgZ(134,"div",18)(135,"div",28)(136,"div",20),e._UZ(137,"div",21),e.qZA(),e.TgZ(138,"div",22),e._uU(139,"Almacenes"),e.qZA()(),e.TgZ(140,"div",29)(141,"div",20),e._UZ(142,"div",21),e.qZA(),e.TgZ(143,"div",22),e._uU(144,"Proveedores"),e.qZA()(),e.TgZ(145,"div",30)(146,"div",20),e._UZ(147,"div",21),e.qZA(),e.TgZ(148,"div",22),e._uU(149,"Marcas"),e.qZA()(),e.TgZ(150,"div",31)(151,"div",20),e._UZ(152,"div",21),e.qZA(),e.TgZ(153,"div",22),e._uU(154,"Unidades de medida"),e.qZA()()()()()()()),2&t&&(e.xp6(63),e.Q6J("svgIcon","heroicons_outline:document-text"),e.xp6(21),e.Q6J("svgIcon","heroicons_outline:document-text"),e.xp6(26),e.Q6J("svgIcon","heroicons_outline:document-text"),e.xp6(21),e.Q6J("svgIcon","heroicons_outline:document-text"))},directives:[C.rH,Q.Hw,Qe.gM],encapsulation:2}),o})(),Ne=(()=>{class o{constructor(){}ngOnInit(){}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.Xpm({type:o,selectors:[["stock-products"]],decls:1,vars:0,template:function(t,i){1&t&&e._UZ(0,"router-outlet")},directives:[C.lC],encapsulation:2}),o})();var r=u(3075),F=u(6087),k=u(4847),b=u(9646),w=u(7579),ee=u(6451),d=u(2722),J=u(8372),g=u(3900),f=u(4004),N=u(7489),h=u(5094);const ve=o=>o.brands,B=((0,h.P1)(ve,o=>o.brand),(0,h.P1)(ve,o=>o.brands)),de=o=>o.categories,te=((0,h.P1)(de,o=>o.category),(0,h.P1)(de,o=>o.categories)),oe=(0,h.P1)(de,o=>o.categoriesNodes);var ie=u(6428);const be=o=>o.products,$=((0,h.P1)(be,o=>o.product),(0,h.P1)(be,o=>o.products)),ke=o=>o.suppliers,R=((0,h.P1)(ke,o=>o.supplier),(0,h.P1)(ke,o=>o.suppliers));var L=u(4787);const Ze=o=>o.uoms,Y=((0,h.P1)(Ze,o=>o.uom),(0,h.P1)(Ze,o=>o.uoms));var E=u(8288),T=u(1683),Je=u(5840),S=u(520),Ce=u(1135),I=u(8505),ne=u(4813),v=u(5698),De=u(9300),re=u(5714),O=u(4967),z=u(2340);const U=z.N.API_URL;let se=(()=>{class o{constructor(t,i){this._httpClient=t,this.store=i,this._tags=new Ce.X(null)}get tags$(){return this._tags.asObservable()}getProducts(t=0,i=10,n="name",s="asc",c=""){const l=(new S.LE).append("page",t.toString()).append("size",i.toString()).append("sort",n).append("order",s).append("search",c);return this._httpClient.get(`${U}/products/`,{params:l}).pipe((0,I.b)(({pagination:m,products:Z})=>{this.store.dispatch((0,re.Jr)({pagination:m})),this.store.dispatch((0,O.RU)({products:Z}))}))}getProductById(t){return this._httpClient.get(`${U}/products/${t}`).pipe((0,ne.j)("product"),(0,I.b)(i=>{this.store.dispatch((0,O.Gr)({product:i}))}))}createProduct(t){return this.store.select($).pipe((0,v.q)(1),(0,g.w)(i=>this._httpClient.post(`${U}/products/`,t).pipe((0,I.b)(n=>{this.store.dispatch((0,O.RU)({products:[n.product,...i]}))}))))}updateProduct(t){return this.store.select($).pipe((0,v.q)(1),(0,g.w)(i=>this._httpClient.patch(`${U}/products/${t._id}`,t).pipe((0,f.U)(n=>{const s=(0,Je.Z)(i);return s[i.findIndex(l=>l._id===t._id)]=n.updatedProduct,this.store.dispatch((0,O.RU)({products:s})),n}))))}deleteProduct(t){return this.store.select($).pipe((0,v.q)(1),(0,g.w)(i=>this._httpClient.delete(`${U}/products/${t}`).pipe((0,f.U)(n=>{const s=i.findIndex(c=>c._id===t);return i.splice(s,1),this.store.dispatch((0,O.RU)({products:i})),n}))))}getTags(){return this._httpClient.get(`${U}/tags`).pipe((0,I.b)(({tags:t})=>{this._tags.next(t)}))}createTag(t){return this.tags$.pipe((0,v.q)(1),(0,g.w)(i=>this._httpClient.post(`${U}/tags`,t).pipe((0,f.U)(n=>(this._tags.next([...i,n.tag]),n.tag)))))}updateTag(t){return this.tags$.pipe((0,v.q)(1),(0,g.w)(i=>this._httpClient.patch(`${U}/tags/${t._id}`,t).pipe((0,f.U)(n=>{const s=i.findIndex(c=>c._id===t._id);return i[s]=n.tag,this._tags.next(i),n.tag}))))}deleteTag(t){return this.tags$.pipe((0,v.q)(1),(0,g.w)(i=>this._httpClient.delete(`${U}/tags/${t}`).pipe((0,f.U)(n=>{const s=i.findIndex(c=>c._id===t);return i.splice(s,1),this._tags.next(i),n}),(0,De.h)(n=>n),(0,g.w)(n=>this.store.select($).pipe((0,v.q)(1),(0,f.U)(s=>(s.forEach(c=>{const l=c.tags.findIndex(m=>m===t);l>-1&&c.tags.splice(l,1)}),n)))))))}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(S.eN),e.LFG(h.yh))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var _=u(7322),A=u(7531),y=u(7423),p=u(9808);function Pe(o,a){if(1&o&&e._UZ(0,"img",47),2&o){const t=e.oxw().$implicit;e.Q6J("alt","Product thumbnail image")("src",t.thumbnail,e.LSH)}}function Be(o,a){1&o&&(e.TgZ(0,"div",48),e._uU(1," SIN IMAGEN "),e.qZA())}function Re(o,a){1&o&&(e.TgZ(0,"div",49),e._UZ(1,"div",50),e.qZA())}function Le(o,a){1&o&&(e.TgZ(0,"div",51),e._UZ(1,"div",52),e.qZA())}function Ye(o,a){1&o&&(e.TgZ(0,"div",53),e._UZ(1,"div",54),e.qZA())}function Me(o,a){1&o&&(e.ynx(0),e._UZ(1,"mat-icon",55),e.BQk()),2&o&&(e.xp6(1),e.Q6J("svgIcon","heroicons_solid:check"))}function $e(o,a){1&o&&(e.ynx(0),e._UZ(1,"mat-icon",56),e.BQk()),2&o&&(e.xp6(1),e.Q6J("svgIcon","heroicons_solid:x"))}function Ee(o,a){if(1&o&&(e.ynx(0),e.TgZ(1,"div",32)(2,"div",33)(3,"div",34),e.YNc(4,Pe,1,2,"img",35),e.YNc(5,Be,2,0,"div",36),e.qZA()(),e.TgZ(6,"div",37),e._uU(7),e.qZA(),e.TgZ(8,"div",38),e._uU(9),e.qZA(),e.TgZ(10,"div",29),e._uU(11),e.ALo(12,"currency"),e.qZA(),e.TgZ(13,"div",39)(14,"div",40),e._uU(15),e.qZA(),e.YNc(16,Re,2,0,"div",41),e.YNc(17,Le,2,0,"div",42),e.YNc(18,Ye,2,0,"div",43),e.qZA(),e.TgZ(19,"div",44),e.YNc(20,Me,2,1,"ng-container",20),e.YNc(21,$e,2,1,"ng-container",20),e.qZA(),e.TgZ(22,"div")(23,"button",45),e._UZ(24,"mat-icon",46),e.qZA()()(),e.BQk()),2&o){const t=a.$implicit;e.xp6(4),e.Q6J("ngIf",t.thumbnail),e.xp6(1),e.Q6J("ngIf",!t.thumbnail),e.xp6(2),e.hij(" ",t.sku," "),e.xp6(2),e.hij(" ",t.name," "),e.xp6(2),e.hij(" ",e.gM2(12,13,t.price,"USD ","symbol","1.2-2")," "),e.xp6(4),e.Oqu(t.stock),e.xp6(1),e.Q6J("ngIf",t.stock<20),e.xp6(1),e.Q6J("ngIf",t.stock>=20&&t.stock<30),e.xp6(1),e.Q6J("ngIf",t.stock>=30),e.xp6(2),e.Q6J("ngIf",t.active),e.xp6(1),e.Q6J("ngIf",!t.active),e.xp6(2),e.Q6J("routerLink","/stock/panels/product/"+t._id),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:pencil")}}function Oe(o,a){if(1&o&&(e.ynx(0),e.YNc(1,Ee,25,18,"ng-container",31),e.BQk()),2&o){const t=a.ngIf,i=e.oxw(3);e.xp6(1),e.Q6J("ngForOf",t)("ngForTrackBy",i.trackByFn)}}const ze=function(o){return{"pointer-events-none":o}},je=function(){return[5,10,25,100]};function We(o,a){if(1&o&&(e.ynx(0),e.TgZ(1,"div",23)(2,"div",24),e._UZ(3,"div"),e.TgZ(4,"div",25),e._uU(5," SKU "),e.qZA(),e.TgZ(6,"div",26),e._uU(7,"Name"),e.qZA(),e.TgZ(8,"div",27),e._uU(9," Precio "),e.qZA(),e.TgZ(10,"div",28),e._uU(11," Stock "),e.qZA(),e.TgZ(12,"div",28),e._uU(13," Activo "),e.qZA(),e.TgZ(14,"div",29),e._uU(15,"Detalles"),e.qZA()(),e.YNc(16,Oe,2,2,"ng-container",20),e.ALo(17,"async"),e.qZA(),e._UZ(18,"mat-paginator",30),e.BQk()),2&o){const t=e.oxw(2);e.xp6(4),e.Q6J("mat-sort-header","sku"),e.xp6(2),e.Q6J("mat-sort-header","name"),e.xp6(2),e.Q6J("mat-sort-header","price"),e.xp6(2),e.Q6J("mat-sort-header","stock"),e.xp6(2),e.Q6J("mat-sort-header","active"),e.xp6(4),e.Q6J("ngIf",e.lcZ(17,12,t.products$)),e.xp6(2),e.Q6J("ngClass",e.VKq(14,ze,t.isLoading))("length",t.pagination.length)("pageIndex",t.pagination.page)("pageSize",t.pagination.size)("pageSizeOptions",e.DdM(16,je))("showFirstLastButtons",!0)}}function Ge(o,a){if(1&o&&(e.ynx(0),e.YNc(1,We,19,17,"ng-container",22),e.BQk()),2&o){const t=a.ngIf;e.oxw();const i=e.MAs(31);e.xp6(1),e.Q6J("ngIf",t.length>0)("ngIfElse",i)}}function Ve(o,a){1&o&&(e.TgZ(0,"div",57),e._uU(1,"\xa1No se ha creado ning\xfan producto!"),e.qZA())}let He=(()=>{class o{constructor(t,i,n,s,c){this._changeDetectorRef=t,this._fuseConfirmationService=i,this._formBuilder=n,this._productsService=s,this.store=c,this.flashMessage=null,this.isLoading=!1,this.products$=(0,b.of)([]),this.searchInputControl=new r.NI,this.selectedProduct=null,this.tagsEditMode=!1,this.user$=(0,b.of)(null),this.suppliers$=(0,b.of)(null),this.uoms$=(0,b.of)(null),this.user=null,this._unsubscribeAll=new w.x}ngOnInit(){this.user$=this.store.select(L.rk),this.user$.subscribe(t=>this.user=t),this.uoms$=this.store.select(Y),this.suppliers$=this.store.select(R),this.suppliers$.pipe((0,d.R)(this._unsubscribeAll)).subscribe(t=>{this.suppliers=t,this._changeDetectorRef.markForCheck()}),this.selectedProductForm=this._formBuilder.group({_id:[""],user:[this.user._id,[r.kI.required]],category:["626d9d45838863e9b45c33f4",[r.kI.required]],name:["Vitamina K12",[r.kI.required,r.kI.maxLength(255)]],description:["Lorem ipsum dolor sit amet, consectetur adipiscing elit, laborum.",[r.kI.maxLength(255)]],tags:[["626db1a3838863e9b45c34cc"]],sku:["MED-VIT-K12",[r.kI.maxLength(50)]],barcode:["412345678913",[r.kI.maxLength(50)]],brand:["626ab24c3ca7804115781c7e",[r.kI.required]],supplier:["626aceecfb8e86bda72f383f",[r.kI.required]],uom:["626a0ab18464f4f7ea718ab8",[r.kI.required]],currency:[{disabled:!0,value:"usd"},[r.kI.required]],stock:[25,[r.kI.required,r.kI.min(0),r.kI.max(999999999),r.kI.maxLength(9)]],onSale:[22,[r.kI.min(0),r.kI.max(999999999),r.kI.maxLength(9)]],cost:[1.5,[r.kI.min(0),r.kI.max(999999999),r.kI.maxLength(9),r.kI.pattern("[0-9.]+(.[0-9]{2})?")]],basePrice:[1.7,[r.kI.min(0),r.kI.max(999999999),r.kI.maxLength(9),r.kI.pattern("[0-9.]+(.[0-9]{2})?")]],taxPercent:[0,[r.kI.min(0),r.kI.max(999999999),r.kI.maxLength(9)]],price:[1.9,[r.kI.required,r.kI.min(0),r.kI.max(999999999),r.kI.maxLength(9),r.kI.pattern("[0-9.]+(.[0-9]{2})?")]],weight:[.15,[r.kI.required,r.kI.min(0),r.kI.max(999999999),r.kI.maxLength(9)]],thumbnail:[""],images:[[]],currentImageIndex:[0],active:[!0,[r.kI.required]]}),this.store.select(B).pipe((0,d.R)(this._unsubscribeAll)).subscribe(t=>{this.brands=t,this._changeDetectorRef.markForCheck()}),this.store.select(te).pipe((0,d.R)(this._unsubscribeAll)).subscribe(t=>{this.categories=t,this._changeDetectorRef.markForCheck()}),this.store.select(ie.B).pipe((0,d.R)(this._unsubscribeAll)).subscribe(t=>{this.pagination=t,this._changeDetectorRef.markForCheck()}),this.products$=this.store.select($),this._productsService.tags$.pipe((0,d.R)(this._unsubscribeAll)).subscribe(t=>{this.tags=t,this.filteredTags=t,this._changeDetectorRef.markForCheck()}),this.searchInputControl.valueChanges.pipe((0,d.R)(this._unsubscribeAll),(0,J.b)(300),(0,g.w)(t=>(this.closeDetails(),this.isLoading=!0,this._productsService.getProducts(0,10,"name","asc",t))),(0,f.U)(()=>{this.isLoading=!1})).subscribe()}ngAfterViewInit(){this._sort&&this._paginator&&(console.log("Paginator: ",this._paginator),this._sort.sort({id:"name",start:"asc",disableClear:!0}),this._changeDetectorRef.markForCheck(),this._sort.sortChange.pipe((0,d.R)(this._unsubscribeAll)).subscribe(()=>{this._paginator.pageIndex=0}),(0,ee.T)(this._sort.sortChange,this._paginator.page).pipe((0,g.w)(()=>(this.isLoading=!0,this._productsService.getProducts(this._paginator.pageIndex,this._paginator.pageSize,this._sort.active,this._sort.direction))),(0,f.U)(()=>{this.isLoading=!1})).subscribe())}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}toggleDetails(t){this.selectedProduct&&this.selectedProduct._id===t._id&&this.closeDetails()}closeDetails(){this.selectedProduct=null}cycleImages(t=!0){const i=this.selectedProductForm.get("images").value.length,n=this.selectedProductForm.get("currentImageIndex").value,s=n+1===i?0:n+1,c=n-1<0?i-1:n-1;t?this.selectedProductForm.get("currentImageIndex").setValue(s):this.selectedProductForm.get("currentImageIndex").setValue(c)}toggleTagsEditMode(){this.tagsEditMode=!this.tagsEditMode}filterTags(t){const i=t.target.value.toLowerCase();this.filteredTags=this.tags.filter(n=>n.name.toLowerCase().includes(i))}filterTagsInputKeyDown(t){if("Enter"!==t.key)return;if(0===this.filteredTags.length)return this.createTag(t.target.value),void(t.target.value="");const i=this.filteredTags[0];this.selectedProduct.tags.find(s=>s===i._id)?this.removeTagFromProduct(i):this.addTagToProduct(i)}createTag(t){this._productsService.createTag({active:!0,user:this.user._id,name:t}).subscribe(n=>{this.addTagToProduct(n)})}updateTagName(t,i){t.name=i.target.value,this._productsService.updateTag(t).pipe((0,J.b)(300)).subscribe(),this._changeDetectorRef.markForCheck()}deleteTag(t){this._productsService.deleteTag(t._id).subscribe(),this._changeDetectorRef.markForCheck()}addTagToProduct(t){const i=(0,N.cloneDeep)(this.selectedProduct);i.tags.unshift(t._id),this.selectedProductForm.get("tags").patchValue(i.tags),this._changeDetectorRef.markForCheck()}removeTagFromProduct(t){const i=this.selectedProductForm.getRawValue();i.tags.splice(i.tags.findIndex(n=>n===t._id),1),this.selectedProductForm.get("tags").patchValue(i.tags),this._changeDetectorRef.markForCheck()}toggleProductTag(t,i){i.checked?this.addTagToProduct(t):this.removeTagFromProduct(t)}shouldShowCreateTagButton(t){return!(""===t||this.tags.findIndex(i=>i.name.toLowerCase()===t.toLowerCase())>-1)}createProduct(){let t=this.selectedProductForm.getRawValue();t=(0,N.omit)(t,["_id","currentImageIndex"]),this.selectedProduct=t}saveProduct(){let t=this.selectedProductForm.getRawValue();t=(0,N.omit)(t,["_id","currentImageIndex"]),this._fuseConfirmationService.open({title:"Crear Producto",message:"\xbfEsta seguro que toda la informaci\xf3n es correcta?",icon:{show:!0,name:"heroicons_outline:question-mark-circle",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(n=>{"confirmed"===n&&this._productsService.createProduct(t).pipe((0,d.R)(this._unsubscribeAll)).subscribe(s=>{this.closeDetails(),this.selectedProductForm.reset(),this.selectedProductForm.patchValue({user:this.user._id,currency:"usd",images:[],tags:[],currentImageIndex:0}),this._fuseConfirmationService.open({title:"Confirmaci\xf3n",message:s.message,icon:{show:!0,name:"heroicons_outline:check",color:"success"},actions:{confirm:{show:!0,label:"Ok",color:"primary"},cancel:{show:!1}},dismissible:!1})},s=>{this._fuseConfirmationService.open({title:`${s.statusText}: ${s.status}`,message:s.error.message,icon:{show:!0,name:"heroicons_outline:exclamation-circle",color:"error"},actions:{confirm:{show:!0,label:"Ok",color:"primary"},cancel:{show:!1}},dismissible:!1})}),this._changeDetectorRef.markForCheck()})}updateSelectedProduct(){const t=this.selectedProductForm.getRawValue();delete t.currentImageIndex,this._productsService.updateProduct(t).subscribe(()=>{this.showFlashMessage("success")})}deleteSelectedProduct(){this._fuseConfirmationService.open({title:"Eliminar Producto",message:"\xbfEst\xe1 seguro que desea eliminar este producto? \xa1Esta acci\xf3n no tiene vuelta atr\xe1s!",actions:{confirm:{label:"Delete"}}}).afterClosed().subscribe(i=>{if("confirmed"===i){const n=this.selectedProductForm.getRawValue();this._productsService.deleteProduct(n.id).subscribe(()=>{this.closeDetails()})}})}showFlashMessage(t){this.flashMessage=t,this._changeDetectorRef.markForCheck(),setTimeout(()=>{this.flashMessage=null,this._changeDetectorRef.markForCheck()},3e3)}trackByFn(t,i){return i.id||t}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(e.sBO),e.Y36(T.R),e.Y36(r.qu),e.Y36(se),e.Y36(h.yh))},o.\u0275cmp=e.Xpm({type:o,selectors:[["stock-products-list"]],viewQuery:function(t,i){if(1&t&&(e.Gf(F.NW,5),e.Gf(k.YE,5)),2&t){let n;e.iGM(n=e.CRH())&&(i._paginator=n.first),e.iGM(n=e.CRH())&&(i._sort=n.first)}},decls:32,vars:10,consts:[[1,"flex","flex-col","flex-auto","min-w-0","sm:absolute","sm:inset-0","sm:overflow-hidden","bg-card","dark:bg-transparent"],[1,"relative","flex","flex-col","px-6","py-8","border-b","sm:flex-row","flex-0","sm:items-center","sm:justify-between","md:px-8"],[1,"flex-1","min-w-0"],[1,"flex","flex-wrap","items-center","font-medium"],["routerLink","/home",1,"whitespace-nowrap","text-primary-500"],[1,"flex","items-center","ml-1","whitespace-nowrap"],[1,"icon-size-5","text-secondary",3,"svgIcon"],["routerLink","/stock/panels",1,"ml-1","text-primary-500"],[1,"ml-1","text-primary-500"],[1,"mt-2"],[1,"text-3xl","font-extrabold","leading-7","tracking-tight","truncate","md:text-4xl","sm:leading-10"],[1,"flex","items-center","mt-6","shrink-0","sm:mt-0","sm:ml-4"],[1,"mr-4","fuse-mat-dense","fuse-mat-no-subscript","fuse-mat-rounded","min-w-64"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"formControl","autocomplete","placeholder"],["mat-raised-button","","routerLink","/stock/panels/product/new",1,"text-white","bg-gradient-to-r","from-primary-500","to-primary-600"],[3,"svgIcon"],[1,"ml-2","mr-1","text-white","hidden","sm:block"],[1,"flex","flex-auto","overflow-hidden"],[1,"flex","flex-col","flex-auto","overflow-hidden","sm:mb-18","sm:overflow-y-auto"],[4,"ngIf"],["noProducts",""],[4,"ngIf","ngIfElse"],[1,"grid"],["matSort","","matSortDisableClear","",1,"sticky","top-0","z-10","grid","gap-4","px-6","py-4","font-semibold","shadow","inventory-grid","md:px-8","text-md","text-secondary","bg-gray-50","dark:bg-black","dark:bg-opacity-5"],[1,"hidden","md:block",3,"mat-sort-header"],[3,"mat-sort-header"],[1,"hidden","sm:block",3,"mat-sort-header"],[1,"hidden","lg:block",3,"mat-sort-header"],[1,"hidden","sm:block"],[1,"z-10","border-b","sm:absolute","sm:inset-x-0","sm:bottom-0","sm:border-t","sm:border-b-0","bg-gray-50","dark:bg-transparent",3,"ngClass","length","pageIndex","pageSize","pageSizeOptions","showFirstLastButtons"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"grid","items-center","gap-4","px-6","py-3","border-b","inventory-grid","md:px-8"],[1,"flex","items-center"],[1,"relative","flex","items-center","justify-center","w-12","h-12","mr-6","overflow-hidden","border","rounded","flex-0"],["class","w-8",3,"alt","src",4,"ngIf"],["class","flex items-center justify-center w-full h-full text-xs font-semibold leading-none text-center uppercase",4,"ngIf"],[1,"hidden","truncate","md:block"],[1,"truncate"],[1,"items-center","hidden","lg:flex"],[1,"min-w-4"],["class","flex items-end w-1 h-4 ml-2 overflow-hidden bg-red-200 rounded",4,"ngIf"],["class","flex items-end w-1 h-4 ml-2 overflow-hidden bg-orange-200 rounded",4,"ngIf"],["class","flex items-end w-1 h-4 ml-2 overflow-hidden bg-green-100 rounded",4,"ngIf"],[1,"hidden","lg:block"],["mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"routerLink"],[1,"icon-size-5",3,"svgIcon"],[1,"w-8",3,"alt","src"],[1,"flex","items-center","justify-center","w-full","h-full","text-xs","font-semibold","leading-none","text-center","uppercase"],[1,"flex","items-end","w-1","h-4","ml-2","overflow-hidden","bg-red-200","rounded"],[1,"flex","w-full","bg-red-600","h-1/3"],[1,"flex","items-end","w-1","h-4","ml-2","overflow-hidden","bg-orange-200","rounded"],[1,"flex","w-full","bg-orange-400","h-2/4"],[1,"flex","items-end","w-1","h-4","ml-2","overflow-hidden","bg-green-100","rounded"],[1,"flex","w-full","h-full","bg-green-400"],[1,"text-green-400","icon-size-5",3,"svgIcon"],[1,"text-gray-400","icon-size-5",3,"svgIcon"],[1,"p-8","text-4xl","font-semibold","tracking-tight","text-center","border-t","sm:p-16"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div")(5,"a",4),e._uU(6,"Inicio"),e.qZA()(),e.TgZ(7,"div",5),e._UZ(8,"mat-icon",6),e.TgZ(9,"a",7),e._uU(10,"Inventario"),e.qZA()(),e.TgZ(11,"div",5),e._UZ(12,"mat-icon",6),e.TgZ(13,"a",8),e._uU(14,"Productos"),e.qZA()()(),e.TgZ(15,"div",9)(16,"h2",10),e._uU(17," Productos "),e.qZA()()(),e.TgZ(18,"div",11)(19,"mat-form-field",12),e._UZ(20,"mat-icon",13)(21,"input",14),e.qZA(),e.TgZ(22,"button",15),e._UZ(23,"mat-icon",16),e.TgZ(24,"span",17),e._uU(25,"Agregar"),e.qZA()()()(),e.TgZ(26,"div",18)(27,"div",19),e.YNc(28,Ge,2,2,"ng-container",20),e.ALo(29,"async"),e.YNc(30,Ve,2,0,"ng-template",null,21,e.W1O),e.qZA()()()),2&t&&(e.xp6(8),e.Q6J("svgIcon","heroicons_solid:chevron-right"),e.xp6(4),e.Q6J("svgIcon","heroicons_solid:chevron-right"),e.xp6(8),e.Q6J("svgIcon","heroicons_solid:search"),e.xp6(1),e.Q6J("formControl",i.searchInputControl)("autocomplete","off")("placeholder","Buscar productos"),e.xp6(2),e.Q6J("svgIcon","heroicons_outline:plus"),e.xp6(5),e.Q6J("ngIf",e.lcZ(29,8,i.products$)))},directives:[C.yS,Q.Hw,_.KE,_.qo,A.Nt,r.Fj,r.JJ,r.oH,y.lW,C.rH,p.O5,k.YE,k.nU,p.sg,F.NW,p.mk],pipes:[p.Ov,p.H9],styles:[".inventory-grid{grid-template-columns:48px auto 40px}@media (min-width: 600px){.inventory-grid{grid-template-columns:48px auto 112px 72px}}@media (min-width: 960px){.inventory-grid{grid-template-columns:48px 112px auto 112px 72px}}@media (min-width: 1280px){.inventory-grid{grid-template-columns:48px 112px auto 112px 96px 96px 72px}}\n"],encapsulation:2,data:{animation:E.L},changeDetection:0}),o})();var x=u(8966),ae=u(5119),ce=u(2368);function Xe(o,a){1&o&&(e.TgZ(0,"h2",7),e._uU(1," Agregar Almac\xe9n "),e.qZA())}function Ke(o,a){1&o&&(e.TgZ(0,"h2",7),e._uU(1," Editar Almac\xe9n "),e.qZA())}function et(o,a){if(1&o&&(e.TgZ(0,"div",8)(1,"div",9)(2,"div",10)(3,"div",11)(4,"div",12)(5,"h6",13),e._uU(6,"Nombre"),e.qZA(),e.TgZ(7,"span",14),e._uU(8),e.qZA()()()()()()),2&o){const t=e.oxw();e.xp6(8),e.Oqu(t.data.warehouse.name||"Sin nombre")}}function tt(o,a){if(1&o&&(e.TgZ(0,"div",15)(1,"div",16)(2,"form",17)(3,"div",18)(4,"mat-form-field",19)(5,"mat-label"),e._uU(6,"Nombre"),e.qZA(),e._UZ(7,"input",20),e.qZA()(),e.TgZ(8,"div",18)(9,"mat-form-field",19)(10,"mat-label"),e._uU(11,"Descripci\xf3n"),e.qZA(),e.TgZ(12,"textarea",21),e._uU(13,"                                "),e.qZA()()(),e.TgZ(14,"div",18)(15,"mat-form-field",19)(16,"mat-label"),e._uU(17,"Cuenta contable"),e.qZA(),e._UZ(18,"input",20),e.qZA()(),e.TgZ(19,"div",18)(20,"mat-form-field",19)(21,"mat-label"),e._uU(22,"Importe inicial"),e.qZA(),e._UZ(23,"input",22),e.qZA()(),e.TgZ(24,"div",23)(25,"span",24),e._uU(26,"Estado"),e.qZA(),e.TgZ(27,"mat-slide-toggle",25),e._uU(28),e.qZA()()()()()),2&o){const t=e.oxw();e.xp6(2),e.Q6J("formGroup",t.warehouseForm)("autocomplete","off"),e.xp6(5),e.Q6J("formControlName","name")("placeholder","Nombre del Almac\xe9n"),e.xp6(5),e.Q6J("matAutosizeMinRows",1)("formControlName","description"),e.xp6(6),e.Q6J("formControlName","account")("placeholder","Nombre del Almac\xe9n"),e.xp6(5),e.Q6J("formControlName","value"),e.xp6(4),e.Q6J("formControlName","active")("color","primary"),e.xp6(1),e.hij(" ",!0===t.warehouseForm.get("active").value?"Activo":"Inactivo"," ")}}function ot(o,a){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",28),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).updateWarehouse()}),e._uU(2," Actualizar "),e.qZA(),e.BQk()}if(2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("color","primary")("disabled",t.warehouseForm.invalid)("matDialogClose","confirmed")}}function it(o,a){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",28),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).createWarehouse()}),e._uU(2," Agregar "),e.qZA(),e.BQk()}if(2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("color","primary")("disabled",t.warehouseForm.invalid)("matDialogClose","confirmed")}}function nt(o,a){if(1&o&&(e.ynx(0),e.TgZ(1,"div",26),e.ynx(2),e.TgZ(3,"button",27),e._uU(4," Cancelar "),e.qZA(),e.BQk(),e.YNc(5,ot,3,3,"ng-container",6),e.YNc(6,it,3,3,"ng-container",6),e.qZA(),e.BQk()),2&o){const t=e.oxw();e.xp6(3),e.Q6J("matDialogClose","cancelled"),e.xp6(2),e.Q6J("ngIf","edit"===t.data.dialogMode),e.xp6(1),e.Q6J("ngIf","add"===t.data.dialogMode)}}let rt=(()=>{class o{constructor(t,i,n,s,c){this.data=t,this._changeDetectorRef=i,this._formBuilder=n,this._fuseConfirmationService=s,this._dialogRef=c,this.dialogMode="view",this._unsubscribeAll=new w.x,this.dialogMode=t.dialogMode,this.warehouse=t.warehouse}ngOnInit(){this.warehouseForm=this._formBuilder.group({_id:[null],userId:["userId",[r.kI.required]],merchantId:["merchantId",[r.kI.required]],active:[!0,[r.kI.required]],name:[null,[r.kI.required,r.kI.minLength(3),r.kI.maxLength(250)]],description:[null,[r.kI.required,r.kI.minLength(3),r.kI.maxLength(250)]],account:[null,[r.kI.required,r.kI.minLength(3),r.kI.maxLength(250)]],value:[null,[r.kI.required,r.kI.min(0),r.kI.max(999999999),r.kI.maxLength(9),r.kI.pattern("^[0-9]*$")]]}),"edit"===this.dialogMode&&this.warehouseForm.patchValue(this.data.warehouse)}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}closeDialog(){this._dialogRef.close()}createWarehouse(){let t=this.warehouseForm.getRawValue();t=(0,ae.Z)(t,["_id"]),this._fuseConfirmationService.open({title:"Crear Almac\xe9n",message:"\xbfEsta seguro que toda la informaci\xf3n es correcta?",icon:{show:!0,name:"heroicons_outline:question-mark-circle",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(n=>{this._changeDetectorRef.markForCheck()})}updateWarehouse(){this.warehouseForm.getRawValue(),this._fuseConfirmationService.open({title:"Actualizar Almac\xe9n",message:"\xbfEsta seguro que toda la informaci\xf3n es correcta?",icon:{show:!0,name:"heroicons_outline:question-mark-circle",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(n=>{this._changeDetectorRef.markForCheck()})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(x.WI),e.Y36(e.sBO),e.Y36(r.qu),e.Y36(T.R),e.Y36(x.so))},o.\u0275cmp=e.Xpm({type:o,selectors:[["stock-warehouse-dialog"]],decls:11,vars:5,consts:[[1,"relative","flex","flex-col","w-full","max-h-screenl"],[1,"flex","flex-col","items-center","px-8","pt-4","space-y-1","text-center","sm:items-start","sm:mt-0","sm:pr-8","sm:text-left"],["class","text-2xl text-gray-400",4,"ngIf"],[1,"flex","flex-col","items-center","flex-auto","w-full","px-8","pb-6","sm:flex-row","sm:items-start","sm:pb-8"],["class","flex-auto",4,"ngIf"],["class","w-full overflow-hidden",4,"ngIf"],[4,"ngIf"],[1,"text-2xl","text-gray-400"],[1,"flex-auto"],[1,"flex"],[1,"flex","flex-col","w-full","mt-5"],[1,"flex","flex-col","p-8","pb-0","sm:flex-row"],[1,"w-full","py-10","my-10"],[1,"mb-2","font-medium"],[1,"border-sm"],[1,"w-full","overflow-hidden"],[1,"flex","flex-col"],[1,"flex","flex-col","w-full","mt-1",3,"formGroup","autocomplete"],[1,"py-5"],[1,"w-full","fuse-mat-no-subscript"],["matInput","","type","text","required","","maxlength","250",3,"formControlName","placeholder"],["matInput","","matTextareaAutosize","","maxlength","250","required","",3,"matAutosizeMinRows","formControlName"],["matInput","","type","number","min","0","max","999999999","maxlength","9","required","",3,"formControlName"],[1,"flex","flex-col","mt-4"],[1,"mb-4","font-medium"],[3,"formControlName","color"],[1,"flex","items-center","justify-center","px-6","py-4","space-x-3","sm:justify-end","bg-gray-50","dark:bg-black","dark:bg-opacity-10"],["mat-stroked-button","",3,"matDialogClose"],["mat-flat-button","",3,"color","disabled","matDialogClose","click"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e.ynx(1),e.TgZ(2,"div",1),e.YNc(3,Xe,2,0,"h2",2),e.YNc(4,Ke,2,0,"h2",2),e.qZA(),e.BQk(),e.TgZ(5,"div",3),e.ynx(6),e.YNc(7,et,9,1,"div",4),e.BQk(),e.ynx(8),e.YNc(9,tt,29,12,"div",5),e.BQk(),e.qZA(),e.YNc(10,nt,7,3,"ng-container",6),e.qZA()),2&t&&(e.xp6(3),e.Q6J("ngIf","add"===i.data.dialogMode),e.xp6(1),e.Q6J("ngIf","edit"===i.data.dialogMode),e.xp6(3),e.Q6J("ngIf","view"===i.data.dialogMode),e.xp6(2),e.Q6J("ngIf","edit"===i.data.dialogMode||"add"),e.xp6(1),e.Q6J("ngIf","view"!==i.data.dialogMode))},directives:[p.O5,r._Y,r.JL,r.sg,_.KE,_.hX,A.Nt,r.Fj,r.Q7,r.nD,r.JJ,r.u,r.qQ,r.Fd,r.wV,ce.Rr,y.lW,x.ZT],encapsulation:2}),o})();const st={_id:null,active:null,userId:null,merchantId:null,name:null,description:null,account:null,value:null};function at(o,a){1&o&&(e.ynx(0),e._UZ(1,"mat-icon",25),e.BQk()),2&o&&(e.xp6(1),e.Q6J("svgIcon","heroicons_solid:check"))}function ct(o,a){1&o&&(e.ynx(0),e._UZ(1,"mat-icon",26),e.BQk()),2&o&&(e.xp6(1),e.Q6J("svgIcon","heroicons_solid:x"))}function lt(o,a){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",18)(2,"div",19),e._uU(3),e.qZA(),e.TgZ(4,"div",20)(5,"div",21),e._uU(6),e.qZA()(),e.TgZ(7,"div",15),e._uU(8),e.ALo(9,"currency"),e.qZA(),e.TgZ(10,"div",22),e.YNc(11,at,2,1,"ng-container",9),e.YNc(12,ct,2,1,"ng-container",9),e.qZA(),e.TgZ(13,"div")(14,"button",23),e.NdJ("click",function(){const s=e.CHM(t).$implicit;return e.oxw(4).updateWarehouse(s)}),e._UZ(15,"mat-icon",24),e.qZA()()(),e.BQk()}if(2&o){const t=a.$implicit;e.xp6(3),e.hij(" ",t.name," "),e.xp6(3),e.Oqu(t.account),e.xp6(2),e.hij(" ",e.gM2(9,6,t.value,"USD ","symbol","1.2-2")," "),e.xp6(3),e.Q6J("ngIf",t.active),e.xp6(1),e.Q6J("ngIf",!t.active),e.xp6(3),e.Q6J("svgIcon","heroicons_solid:pencil")}}function ut(o,a){if(1&o&&(e.ynx(0),e.YNc(1,lt,16,11,"ng-container",17),e.BQk()),2&o){const t=a.ngIf,i=e.oxw(3);e.xp6(1),e.Q6J("ngForOf",t)("ngForTrackBy",i.trackByFn)}}function dt(o,a){if(1&o&&(e.ynx(0),e.TgZ(1,"div",12)(2,"div",13)(3,"div",14),e._uU(4,"Nombre"),e.qZA(),e.TgZ(5,"div",15),e._uU(6," Cuenta "),e.qZA(),e.TgZ(7,"div",16),e._uU(8," Valor "),e.qZA(),e.TgZ(9,"div",16),e._uU(10," Activo "),e.qZA(),e.TgZ(11,"div",15),e._uU(12,"Detalles"),e.qZA()(),e.YNc(13,ut,2,2,"ng-container",9),e.ALo(14,"async"),e.qZA(),e.BQk()),2&o){const t=e.oxw(2);e.xp6(3),e.Q6J("mat-sort-header","name"),e.xp6(4),e.Q6J("mat-sort-header","value"),e.xp6(2),e.Q6J("mat-sort-header","active"),e.xp6(4),e.Q6J("ngIf",e.lcZ(14,4,t.warehouses$))}}function mt(o,a){if(1&o&&(e.ynx(0),e.YNc(1,dt,15,6,"ng-container",11),e.BQk()),2&o){const t=a.ngIf;e.oxw();const i=e.MAs(14);e.xp6(1),e.Q6J("ngIf",t.length>0)("ngIfElse",i)}}function pt(o,a){1&o&&(e.TgZ(0,"div",27),e._uU(1,"\xa1No se ha creado ning\xfan almac\xe9n!"),e.qZA())}let gt=(()=>{class o{constructor(t,i,n){this._changeDetectorRef=t,this._dialog=i,this._fuseConfirmationService=n,this.flashMessage=null,this.merchantInputControl=new r.NI,this._unsubscribeAll=new w.x}ngOnInit(){this.warehouses$=(0,b.of)([{_id:"1",active:!0,userId:"1",merchantId:"1",name:"Almac\xe9n de productos",description:"Almac\xe9n Mercanc\xedas para la Venta",account:"189 - Mercanc\xedas para la Venta",value:5e4,createdAt:"2020-01-01",updatedAt:"2020-01-01"},{_id:"2",active:!0,userId:"2",merchantId:"2",name:"Almac\xe9n de \xf3rdenes",description:"Almac\xe9n de \xf3rdenes pendientes de despacho",account:"195.0010 - Mercanc\xeda en transito",value:32500,createdAt:"2020-02-02",updatedAt:"2020-02-02"}])}ngAfterViewInit(){}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}createWarehouse(){this._openDialog(st,"add")}updateWarehouse(t){this._openDialog(t,"edit")}trackByFn(t,i){return t||i.id}_openDialog(t,i){this._dialog.open(rt,{data:{warehouse:t,dialogMode:i},panelClass:"ath-dialog-panel"})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(e.sBO),e.Y36(x.uw),e.Y36(T.R))},o.\u0275cmp=e.Xpm({type:o,selectors:[["stock-warehouse"]],viewQuery:function(t,i){if(1&t&&e.Gf(k.YE,5),2&t){let n;e.iGM(n=e.CRH())&&(i._sort=n.first)}},decls:15,vars:4,consts:[[1,"flex","flex-col","flex-auto","min-w-0","sm:absolute","sm:inset-0","sm:overflow-hidden","bg-card","dark:bg-transparent"],[1,"relative","flex","flex-col","px-6","py-8","border-b","sm:flex-row","flex-0","sm:items-center","sm:justify-between","md:px-8"],[1,"text-4xl","font-extrabold","tracking-tight"],[1,"flex","items-center","mt-6","shrink-0","sm:mt-0","sm:ml-4"],["mat-raised-button","",1,"bg-gradient-to-r","from-primary-500","to-primary-600","text-white",3,"click"],[3,"svgIcon"],[1,"ml-2","mr-1","text-white","hidden","sm:block"],[1,"flex","flex-auto","overflow-hidden"],[1,"flex","flex-col","flex-auto","overflow-hidden","sm:mb-18","sm:overflow-y-auto"],[4,"ngIf"],["noWarehouses",""],[4,"ngIf","ngIfElse"],[1,"grid"],["matSort","","matSortDisableClear","",1,"sticky","top-0","z-10","grid","gap-4","px-6","py-4","font-semibold","shadow","warehouse-grid","md:px-8","text-md","text-secondary","bg-gray-50","dark:bg-black","dark:bg-opacity-5"],[3,"mat-sort-header"],[1,"hidden","sm:block"],[1,"hidden","lg:block",3,"mat-sort-header"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"grid","items-center","gap-4","px-6","py-3","border-b","warehouse-grid","md:px-8"],[1,"truncate"],[1,"items-center","hidden","lg:flex"],[1,"min-w-4"],[1,"hidden","lg:block"],["mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"click"],[1,"icon-size-5",3,"svgIcon"],[1,"text-green-400","icon-size-5",3,"svgIcon"],[1,"text-gray-400","icon-size-5",3,"svgIcon"],[1,"p-8","text-4xl","font-semibold","tracking-tight","text-center","border-t","sm:p-16"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e._uU(3,"Almacenes"),e.qZA(),e.TgZ(4,"div",3)(5,"button",4),e.NdJ("click",function(){return i.createWarehouse()}),e._UZ(6,"mat-icon",5),e.TgZ(7,"span",6),e._uU(8,"Agregar"),e.qZA()()()(),e.TgZ(9,"div",7)(10,"div",8),e.YNc(11,mt,2,2,"ng-container",9),e.ALo(12,"async"),e.YNc(13,pt,2,0,"ng-template",null,10,e.W1O),e.qZA()()()),2&t&&(e.xp6(6),e.Q6J("svgIcon","heroicons_outline:plus"),e.xp6(5),e.Q6J("ngIf",e.lcZ(12,2,i.warehouses$)))},directives:[y.lW,Q.Hw,p.O5,k.YE,k.nU,p.sg],pipes:[p.Ov,p.H9],styles:[".warehouse-grid{grid-template-columns:auto 40px}@media (min-width: 600px){.warehouse-grid{grid-template-columns:auto 112px 72px}}@media (min-width: 960px){.warehouse-grid{grid-template-columns:112px auto 112px 72px}}@media (min-width: 1280px){.warehouse-grid{grid-template-columns:auto 250px 150px 72px 72px}}\n"],encapsulation:2,data:{animation:E.L},changeDetection:0}),o})();var j=u(8124);const W=z.N.API_URL;let me=(()=>{class o{constructor(t,i){this._httpClient=t,this.store=i}getBrands(t=0,i=10,n="name",s="asc",c=""){const l=(new S.LE).append("page",t.toString()).append("size",i.toString()).append("sort",n).append("order",s).append("search",c);return this._httpClient.get(`${W}/brands/`,{params:l}).pipe((0,I.b)(({pagination:m,brands:Z})=>{this.store.dispatch((0,re.Jr)({pagination:m})),this.store.dispatch((0,j.dk)({brands:Z}))}))}getBrandById(t){return this._httpClient.get(`${W}/brands/${t}`).pipe((0,ne.j)("brand"),(0,I.b)(i=>{this.store.dispatch((0,j.HB)({brand:i}))}))}createBrand(t){return this.store.select(B).pipe((0,v.q)(1),(0,g.w)(i=>this._httpClient.post(`${W}/brands/`,t).pipe((0,I.b)(n=>{this.store.dispatch((0,j.dk)({brands:[n.brand,...i]}))}))))}updateBrand(t){return this.store.select(B).pipe((0,v.q)(1),(0,g.w)(i=>this._httpClient.patch(`${W}/brands/${t._id}`,t).pipe((0,f.U)(n=>{const s=i.findIndex(c=>c._id===t._id);return i[s]=n.brand,this.store.dispatch((0,j.dk)({brands:i})),n}))))}deleteBrand(t){return this.store.select(B).pipe((0,v.q)(1),(0,g.w)(i=>this._httpClient.delete(`${W}/brands/${t}`).pipe((0,f.U)(n=>{const s=i.findIndex(c=>c._id===t);return i.splice(s,1),this.store.dispatch((0,j.dk)({brands:i})),n}))))}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(S.eN),e.LFG(h.yh))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();function ht(o,a){1&o&&(e.TgZ(0,"h2",7),e._uU(1," Agregar Marca "),e.qZA())}function ft(o,a){1&o&&(e.TgZ(0,"h2",7),e._uU(1," Editar Marca "),e.qZA())}function _t(o,a){if(1&o&&(e.TgZ(0,"div",8)(1,"div",9)(2,"div",10)(3,"div",11)(4,"div",12)(5,"h6",13),e._uU(6,"Nombre"),e.qZA(),e.TgZ(7,"span",14),e._uU(8),e.qZA()()()()()()),2&o){const t=e.oxw();e.xp6(8),e.Oqu(t.data.brand.name||"Sin nombre")}}function xt(o,a){if(1&o&&(e.TgZ(0,"div",15)(1,"div",16)(2,"form",17)(3,"div",18)(4,"mat-form-field",19)(5,"mat-label"),e._uU(6,"Nombre"),e.qZA(),e._UZ(7,"input",20),e.qZA()(),e.TgZ(8,"div",18)(9,"mat-form-field",19)(10,"mat-label"),e._uU(11,"Descripci\xf3n"),e.qZA(),e.TgZ(12,"textarea",21),e._uU(13,"                                "),e.qZA()()(),e.TgZ(14,"div",22)(15,"span",23),e._uU(16,"Estado"),e.qZA(),e.TgZ(17,"mat-slide-toggle",24),e._uU(18),e.qZA()()()()()),2&o){const t=e.oxw();e.xp6(2),e.Q6J("formGroup",t.brandForm)("autocomplete","off"),e.xp6(5),e.Q6J("formControlName","name")("placeholder","Nombre del Marca"),e.xp6(5),e.Q6J("matAutosizeMinRows",1)("formControlName","description"),e.xp6(5),e.Q6J("formControlName","active")("color","primary"),e.xp6(1),e.hij(" ",!0===t.brandForm.get("active").value?"Activo":"Inactivo"," ")}}function vt(o,a){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",27),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).updateBrand()}),e._uU(2," Actualizar "),e.qZA(),e.BQk()}if(2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("color","primary")("disabled",t.brandForm.invalid)("matDialogClose","confirmed")}}function bt(o,a){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",27),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).createBrand()}),e._uU(2," Agregar "),e.qZA(),e.BQk()}if(2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("color","primary")("disabled",t.brandForm.invalid)("matDialogClose","confirmed")}}function kt(o,a){if(1&o&&(e.ynx(0),e.TgZ(1,"div",25),e.ynx(2),e.TgZ(3,"button",26),e._uU(4," Cancelar "),e.qZA(),e.BQk(),e.YNc(5,vt,3,3,"ng-container",6),e.YNc(6,bt,3,3,"ng-container",6),e.qZA(),e.BQk()),2&o){const t=e.oxw();e.xp6(3),e.Q6J("matDialogClose","cancelled"),e.xp6(2),e.Q6J("ngIf","edit"===t.data.dialogMode),e.xp6(1),e.Q6J("ngIf","add"===t.data.dialogMode)}}let Zt=(()=>{class o{constructor(t,i,n,s,c,l,m){this.data=t,this._brandsService=i,this._changeDetectorRef=n,this._formBuilder=s,this._fuseConfirmationService=c,this._dialogRef=l,this.store=m,this.dialogMode="view",this.user$=(0,b.of)(null),this.user=null,this._unsubscribeAll=new w.x,this.dialogMode=t.dialogMode,this.brand=t.brand}ngOnInit(){this.user$=this.store.select(L.rk),this.user$.subscribe(t=>this.user=t),this.brandForm=this._formBuilder.group({_id:[null],user:[this.user._id,[r.kI.required]],active:[!0,[r.kI.required]],name:[null,[r.kI.required,r.kI.minLength(3),r.kI.maxLength(250)]],description:[null,[r.kI.minLength(3),r.kI.maxLength(250)]]}),"edit"===this.dialogMode&&this.brandForm.patchValue(this.brand)}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}closeDialog(){this._dialogRef.close()}createBrand(){let t=this.brandForm.getRawValue();t=(0,ae.Z)(t,["_id"]),this._fuseConfirmationService.open({title:"Crear Marca",message:"\xbfEsta seguro que toda la informaci\xf3n es correcta?",icon:{show:!0,name:"heroicons_outline:question-mark-circle",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(n=>{"confirmed"===n&&this._brandsService.createBrand(t).pipe((0,d.R)(this._unsubscribeAll)).subscribe(s=>{this._fuseConfirmationService.open({title:"Confirmaci\xf3n",message:s.message,icon:{show:!0,name:"heroicons_outline:check",color:"success"},actions:{confirm:{show:!0,label:"Ok",color:"primary"},cancel:{show:!1}},dismissible:!1})},s=>{this._fuseConfirmationService.open({title:`${s.statusText}: ${s.status}`,message:s.error.message,icon:{show:!0,name:"heroicons_outline:exclamation-circle",color:"error"},actions:{confirm:{show:!0,label:"Ok",color:"primary"},cancel:{show:!1}},dismissible:!1})}),this._changeDetectorRef.markForCheck()})}updateBrand(){const t=this.brandForm.getRawValue();this._fuseConfirmationService.open({title:"Actualizar Marca",message:"\xbfEsta seguro que toda la informaci\xf3n es correcta?",icon:{show:!0,name:"heroicons_outline:question-mark-circle",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(n=>{"confirmed"===n&&this._brandsService.updateBrand(t).pipe((0,d.R)(this._unsubscribeAll)).subscribe(s=>{this._fuseConfirmationService.open({title:"Confirmaci\xf3n",message:s.message,icon:{show:!0,name:"heroicons_outline:check",color:"success"},actions:{confirm:{show:!0,label:"Ok",color:"primary"},cancel:{show:!1}},dismissible:!1}),this._changeDetectorRef.markForCheck()},s=>{this._fuseConfirmationService.open({title:`${s.statusText}: ${s.status}`,message:s.error.message,icon:{show:!0,name:"heroicons_outline:exclamation-circle",color:"error"},actions:{confirm:{show:!0,label:"Ok",color:"primary"},cancel:{show:!1}},dismissible:!1})}),this._changeDetectorRef.markForCheck()})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(x.WI),e.Y36(me),e.Y36(e.sBO),e.Y36(r.qu),e.Y36(T.R),e.Y36(x.so),e.Y36(h.yh))},o.\u0275cmp=e.Xpm({type:o,selectors:[["stock-brand-dialog"]],decls:11,vars:5,consts:[[1,"relative","flex","flex-col","w-full","max-h-screenl"],[1,"flex","flex-col","items-center","px-8","pt-4","space-y-1","text-center","sm:items-start","sm:mt-0","sm:pr-8","sm:text-left"],["class","text-2xl text-gray-400",4,"ngIf"],[1,"flex","flex-col","items-center","flex-auto","w-full","px-8","pb-6","sm:flex-row","sm:items-start","sm:pb-8"],["class","flex-auto",4,"ngIf"],["class","w-full overflow-hidden",4,"ngIf"],[4,"ngIf"],[1,"text-2xl","text-gray-400"],[1,"flex-auto"],[1,"flex"],[1,"flex","flex-col","w-full","mt-5"],[1,"flex","flex-col","p-8","pb-0","sm:flex-row"],[1,"w-full","py-10","my-10"],[1,"mb-2","font-medium"],[1,"border-sm"],[1,"w-full","overflow-hidden"],[1,"flex","flex-col"],[1,"flex","flex-col","w-full","mt-1",3,"formGroup","autocomplete"],[1,"py-5"],[1,"w-full","fuse-mat-no-subscript"],["matInput","","type","text","required","","maxlength","250",3,"formControlName","placeholder"],["matInput","","matTextareaAutosize","","maxlength","250",3,"matAutosizeMinRows","formControlName"],[1,"flex","flex-col","mt-4"],[1,"mb-4","font-medium"],[3,"formControlName","color"],[1,"flex","items-center","justify-center","px-6","py-4","space-x-3","sm:justify-end","bg-gray-50","dark:bg-black","dark:bg-opacity-10"],["mat-stroked-button","",3,"matDialogClose"],["mat-flat-button","",3,"color","disabled","matDialogClose","click"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e.ynx(1),e.TgZ(2,"div",1),e.YNc(3,ht,2,0,"h2",2),e.YNc(4,ft,2,0,"h2",2),e.qZA(),e.BQk(),e.TgZ(5,"div",3),e.ynx(6),e.YNc(7,_t,9,1,"div",4),e.BQk(),e.ynx(8),e.YNc(9,xt,19,9,"div",5),e.BQk(),e.qZA(),e.YNc(10,kt,7,3,"ng-container",6),e.qZA()),2&t&&(e.xp6(3),e.Q6J("ngIf","add"===i.data.dialogMode),e.xp6(1),e.Q6J("ngIf","edit"===i.data.dialogMode),e.xp6(3),e.Q6J("ngIf","view"===i.data.dialogMode),e.xp6(2),e.Q6J("ngIf","edit"===i.data.dialogMode||"add"),e.xp6(1),e.Q6J("ngIf","view"!==i.data.dialogMode))},directives:[p.O5,r._Y,r.JL,r.sg,_.KE,_.hX,A.Nt,r.Fj,r.Q7,r.nD,r.JJ,r.u,ce.Rr,y.lW,x.ZT],encapsulation:2}),o})();const Ct={_id:null,userId:null,merchantId:null,active:null,name:null};function It(o,a){1&o&&(e.ynx(0),e._UZ(1,"mat-icon",38),e.BQk()),2&o&&(e.xp6(1),e.Q6J("svgIcon","heroicons_solid:check"))}function wt(o,a){1&o&&(e.ynx(0),e._UZ(1,"mat-icon",39),e.BQk()),2&o&&(e.xp6(1),e.Q6J("svgIcon","heroicons_solid:x"))}function Tt(o,a){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",31)(2,"div",32),e._uU(3),e.qZA(),e.TgZ(4,"div",33)(5,"div",34),e._uU(6),e.qZA()(),e.TgZ(7,"div",35),e.YNc(8,It,2,1,"ng-container",20),e.YNc(9,wt,2,1,"ng-container",20),e.qZA(),e.TgZ(10,"div")(11,"button",36),e.NdJ("click",function(){const s=e.CHM(t).$implicit;return e.oxw(4).updateBrand(s)}),e._UZ(12,"mat-icon",37),e.qZA()()(),e.BQk()}if(2&o){const t=a.$implicit;e.xp6(3),e.hij(" ",t.name," "),e.xp6(3),e.Oqu(t.description),e.xp6(2),e.Q6J("ngIf",t.active),e.xp6(1),e.Q6J("ngIf",!t.active),e.xp6(3),e.Q6J("svgIcon","heroicons_solid:pencil")}}function yt(o,a){if(1&o&&(e.ynx(0),e.YNc(1,Tt,13,5,"ng-container",30),e.BQk()),2&o){const t=a.ngIf,i=e.oxw(3);e.xp6(1),e.Q6J("ngForOf",t)("ngForTrackBy",i.trackByFn)}}const At=function(o){return{"pointer-events-none":o}},St=function(){return[5,10,25,100]};function Ut(o,a){if(1&o&&(e.ynx(0),e.TgZ(1,"div",23)(2,"div",24)(3,"div",25),e._uU(4,"Nombre"),e.qZA(),e.TgZ(5,"div",26),e._uU(6," Descripci\xf3n "),e.qZA(),e.TgZ(7,"div",27),e._uU(8," Activo "),e.qZA(),e.TgZ(9,"div",28),e._uU(10,"Detalles"),e.qZA()(),e.YNc(11,yt,2,2,"ng-container",20),e.ALo(12,"async"),e.qZA(),e._UZ(13,"mat-paginator",29),e.BQk()),2&o){const t=e.oxw(2);e.xp6(3),e.Q6J("mat-sort-header","name"),e.xp6(4),e.Q6J("mat-sort-header","active"),e.xp6(4),e.Q6J("ngIf",e.lcZ(12,9,t.brands$)),e.xp6(2),e.Q6J("ngClass",e.VKq(11,At,t.isLoading))("length",t.pagination.length)("pageIndex",t.pagination.page)("pageSize",t.pagination.size)("pageSizeOptions",e.DdM(13,St))("showFirstLastButtons",!0)}}function qt(o,a){if(1&o&&(e.ynx(0),e.YNc(1,Ut,14,14,"ng-container",22),e.BQk()),2&o){const t=a.ngIf;e.oxw();const i=e.MAs(31);e.xp6(1),e.Q6J("ngIf",t.length>0)("ngIfElse",i)}}function Qt(o,a){1&o&&(e.TgZ(0,"div",40),e._uU(1,"\xa1No se ha creado ninguna marca!"),e.qZA())}let Ft=(()=>{class o{constructor(t,i,n,s,c){this._brandsService=t,this._changeDetectorRef=i,this._dialog=n,this._fuseConfirmationService=s,this.store=c,this.flashMessage=null,this.brands$=(0,b.of)([]),this.merchantInputControl=new r.NI,this.isLoading=!1,this.searchInputControl=new r.NI,this._unsubscribeAll=new w.x}ngOnInit(){this.brands$=this.store.select(B),this.store.select(ie.B).pipe((0,d.R)(this._unsubscribeAll)).subscribe(t=>{this.pagination=t,this._changeDetectorRef.markForCheck()}),this.searchInputControl.valueChanges.pipe((0,d.R)(this._unsubscribeAll),(0,J.b)(300),(0,g.w)(t=>(this.isLoading=!0,this._brandsService.getBrands(0,10,"name","asc",t))),(0,f.U)(()=>{this.isLoading=!1})).subscribe()}ngAfterViewInit(){this._sort&&this._paginator&&(this._sort.sort({id:"name",start:"asc",disableClear:!0}),this._changeDetectorRef.markForCheck(),this._sort.sortChange.pipe((0,d.R)(this._unsubscribeAll)).subscribe(()=>{this._paginator.pageIndex=0}),(0,ee.T)(this._sort.sortChange,this._paginator.page).pipe((0,g.w)(()=>(this.isLoading=!0,this._brandsService.getBrands(this._paginator.pageIndex,this._paginator.pageSize,this._sort.active,this._sort.direction))),(0,f.U)(()=>{this.isLoading=!1})).subscribe())}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}createBrand(){this._openDialog(Ct,"add")}updateBrand(t){this._openDialog(t,"edit")}trackByFn(t,i){return t||i.id}_openDialog(t,i){this._dialog.open(Zt,{data:{brand:t,dialogMode:i},panelClass:"ath-dialog-panel"})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(me),e.Y36(e.sBO),e.Y36(x.uw),e.Y36(T.R),e.Y36(h.yh))},o.\u0275cmp=e.Xpm({type:o,selectors:[["stock-brands"]],viewQuery:function(t,i){if(1&t&&(e.Gf(F.NW,5),e.Gf(k.YE,5)),2&t){let n;e.iGM(n=e.CRH())&&(i._paginator=n.first),e.iGM(n=e.CRH())&&(i._sort=n.first)}},decls:32,vars:10,consts:[[1,"flex","flex-col","flex-auto","min-w-0","sm:absolute","sm:inset-0","sm:overflow-hidden","bg-card","dark:bg-transparent"],[1,"relative","flex","flex-col","px-6","py-8","border-b","sm:flex-row","flex-0","sm:items-center","sm:justify-between","md:px-8"],[1,"flex-1","min-w-0"],[1,"flex","flex-wrap","items-center","font-medium"],["routerLink","/home",1,"whitespace-nowrap","text-primary-500"],[1,"flex","items-center","ml-1","whitespace-nowrap"],[1,"icon-size-5","text-secondary",3,"svgIcon"],["routerLink","/stock/panels",1,"ml-1","text-primary-500"],[1,"ml-1","text-primary-500"],[1,"mt-2"],[1,"text-3xl","font-extrabold","leading-7","tracking-tight","truncate","md:text-4xl","sm:leading-10"],[1,"flex","items-center","mt-6","shrink-0","sm:mt-0","sm:ml-4"],[1,"mr-4","fuse-mat-dense","fuse-mat-no-subscript","fuse-mat-rounded","min-w-64"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"formControl","autocomplete","placeholder"],["mat-raised-button","",1,"bg-gradient-to-r","from-primary-500","to-primary-600","text-white",3,"click"],[3,"svgIcon"],[1,"ml-2","mr-1","text-white","hidden","sm:block"],[1,"flex","flex-auto","overflow-hidden"],[1,"flex","flex-col","flex-auto","overflow-hidden","sm:mb-18","sm:overflow-y-auto"],[4,"ngIf"],["noBrands",""],[4,"ngIf","ngIfElse"],[1,"grid"],["matSort","","matSortDisableClear","",1,"sticky","top-0","z-10","grid","gap-4","px-6","py-4","font-semibold","shadow","brands-grid","md:px-8","text-md","text-secondary","bg-gray-50","dark:bg-black","dark:bg-opacity-5"],[3,"mat-sort-header"],[1,"hidden","md:block"],[1,"hidden","lg:block",3,"mat-sort-header"],[1,"hidden","sm:block"],[1,"z-10","border-b","sm:absolute","sm:inset-x-0","sm:bottom-0","sm:border-t","sm:border-b-0","bg-gray-50","dark:bg-transparent",3,"ngClass","length","pageIndex","pageSize","pageSizeOptions","showFirstLastButtons"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"grid","items-center","gap-4","px-6","py-3","border-b","brands-grid","md:px-8"],[1,"truncate"],[1,"items-center","hidden","lg:flex"],[1,"min-w-4"],[1,"hidden","lg:block"],["mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"click"],[1,"icon-size-5",3,"svgIcon"],[1,"text-green-400","icon-size-5",3,"svgIcon"],[1,"text-gray-400","icon-size-5",3,"svgIcon"],[1,"p-8","text-4xl","font-semibold","tracking-tight","text-center","border-t","sm:p-16"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div")(5,"a",4),e._uU(6,"Inicio"),e.qZA()(),e.TgZ(7,"div",5),e._UZ(8,"mat-icon",6),e.TgZ(9,"a",7),e._uU(10,"Inventario"),e.qZA()(),e.TgZ(11,"div",5),e._UZ(12,"mat-icon",6),e.TgZ(13,"a",8),e._uU(14,"Marcas"),e.qZA()()(),e.TgZ(15,"div",9)(16,"h2",10),e._uU(17," Marcas "),e.qZA()()(),e.TgZ(18,"div",11)(19,"mat-form-field",12),e._UZ(20,"mat-icon",13)(21,"input",14),e.qZA(),e.TgZ(22,"button",15),e.NdJ("click",function(){return i.createBrand()}),e._UZ(23,"mat-icon",16),e.TgZ(24,"span",17),e._uU(25,"Agregar"),e.qZA()()()(),e.TgZ(26,"div",18)(27,"div",19),e.YNc(28,qt,2,2,"ng-container",20),e.ALo(29,"async"),e.YNc(30,Qt,2,0,"ng-template",null,21,e.W1O),e.qZA()()()),2&t&&(e.xp6(8),e.Q6J("svgIcon","heroicons_solid:chevron-right"),e.xp6(4),e.Q6J("svgIcon","heroicons_solid:chevron-right"),e.xp6(8),e.Q6J("svgIcon","heroicons_solid:search"),e.xp6(1),e.Q6J("formControl",i.searchInputControl)("autocomplete","off")("placeholder","Buscar marcas"),e.xp6(2),e.Q6J("svgIcon","heroicons_outline:plus"),e.xp6(5),e.Q6J("ngIf",e.lcZ(29,8,i.brands$)))},directives:[C.yS,Q.Hw,_.KE,_.qo,A.Nt,r.Fj,r.JJ,r.oH,y.lW,p.O5,k.YE,k.nU,p.sg,F.NW,p.mk],pipes:[p.Ov],styles:[".brands-grid{grid-template-columns:auto 40px}@media (min-width: 600px){.brands-grid{grid-template-columns:auto 112px 72px}}@media (min-width: 960px){.brands-grid{grid-template-columns:112px auto 112px 72px}}@media (min-width: 1280px){.brands-grid{grid-template-columns:auto 250px 150px 72px 72px}}\n"],encapsulation:2,data:{animation:E.L},changeDetection:0}),o})();var G=u(1411);const V=z.N.API_URL;let pe=(()=>{class o{constructor(t,i){this._httpClient=t,this.store=i}getUoms(t=0,i=10,n="name",s="asc",c=""){const l=(new S.LE).append("page",t.toString()).append("size",i.toString()).append("sort",n).append("order",s).append("search",c);return this._httpClient.get(`${V}/uoms/`,{params:l}).pipe((0,I.b)(({pagination:m,uoms:Z})=>{this.store.dispatch((0,re.Jr)({pagination:m})),this.store.dispatch((0,G.u8)({uoms:Z}))}))}getUomById(t){return this._httpClient.get(`${V}/uoms/${t}`).pipe((0,ne.j)("uom"),(0,I.b)(i=>{this.store.dispatch((0,G.sh)({uom:i}))}))}createUom(t){return this.store.select(Y).pipe((0,v.q)(1),(0,g.w)(i=>this._httpClient.post(`${V}/uoms/`,t).pipe((0,I.b)(n=>{this.store.dispatch((0,G.u8)({uoms:[n.uom,...i]}))}))))}updateUom(t){return this.store.select(Y).pipe((0,v.q)(1),(0,g.w)(i=>this._httpClient.patch(`${V}/uoms/${t._id}`,t).pipe((0,f.U)(n=>{const s=i.findIndex(c=>c._id===t._id);return i[s]=n.uom,this.store.dispatch((0,G.u8)({uoms:i})),n}))))}deleteUom(t){return this.store.select(Y).pipe((0,v.q)(1),(0,g.w)(i=>this._httpClient.delete(`${V}/uoms/${t}`).pipe((0,f.U)(n=>{const s=i.findIndex(c=>c._id===t);return i.splice(s,1),this.store.dispatch((0,G.u8)({uoms:i})),n}))))}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(S.eN),e.LFG(h.yh))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var ge=u(4107),H=u(508);function Nt(o,a){1&o&&(e.TgZ(0,"h2",7),e._uU(1," Agregar Unidad de Medida "),e.qZA())}function Jt(o,a){1&o&&(e.TgZ(0,"h2",7),e._uU(1," Editar Unidad de Medida "),e.qZA())}function Dt(o,a){if(1&o&&(e.TgZ(0,"div",8)(1,"div",9)(2,"div",10)(3,"div",11)(4,"div",12)(5,"h6",13),e._uU(6,"Nombre"),e.qZA(),e.TgZ(7,"span",14),e._uU(8),e.qZA()()()()()()),2&o){const t=e.oxw();e.xp6(8),e.Oqu(t.data.uom.name||"Sin nombre")}}function Pt(o,a){if(1&o&&(e.TgZ(0,"div",15)(1,"div",16)(2,"form",17)(3,"div",18)(4,"mat-form-field",19)(5,"mat-label"),e._uU(6,"Nombre"),e.qZA(),e._UZ(7,"input",20),e.qZA()(),e.TgZ(8,"div",18)(9,"mat-form-field",19)(10,"mat-label"),e._uU(11,"Sigla"),e.qZA(),e._UZ(12,"input",20),e.qZA()(),e.TgZ(13,"div",18)(14,"mat-form-field",19)(15,"mat-label"),e._uU(16,"Tipo"),e.qZA(),e.TgZ(17,"mat-select",21)(18,"mat-option",22),e._uU(19,"Peso"),e.qZA(),e.TgZ(20,"mat-option",22),e._uU(21,"Volumen"),e.qZA(),e.TgZ(22,"mat-option",22),e._uU(23,"Conteo"),e.qZA()()()(),e.TgZ(24,"div",23)(25,"span",24),e._uU(26,"Estado"),e.qZA(),e.TgZ(27,"mat-slide-toggle",25),e._uU(28),e.qZA()()()()()),2&o){const t=e.oxw();e.xp6(2),e.Q6J("formGroup",t.uomForm)("autocomplete","off"),e.xp6(5),e.Q6J("formControlName","name")("placeholder","Nombre del Unidad de Medida"),e.xp6(5),e.Q6J("formControlName","abbr")("placeholder","Siglas"),e.xp6(5),e.Q6J("formControlName","type"),e.xp6(1),e.Q6J("value","peso"),e.xp6(2),e.Q6J("value","volumen"),e.xp6(2),e.Q6J("value","conteo"),e.xp6(5),e.Q6J("formControlName","active")("color","primary"),e.xp6(1),e.hij(" ",!0===t.uomForm.get("active").value?"Activo":"Inactivo"," ")}}function Bt(o,a){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",28),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).updateUom()}),e._uU(2," Actualizar "),e.qZA(),e.BQk()}if(2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("color","primary")("disabled",t.uomForm.invalid)("matDialogClose","confirmed")}}function Rt(o,a){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",28),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).createUom()}),e._uU(2," Agregar "),e.qZA(),e.BQk()}if(2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("color","primary")("disabled",t.uomForm.invalid)("matDialogClose","confirmed")}}function Lt(o,a){if(1&o&&(e.ynx(0),e.TgZ(1,"div",26),e.ynx(2),e.TgZ(3,"button",27),e._uU(4," Cancelar "),e.qZA(),e.BQk(),e.YNc(5,Bt,3,3,"ng-container",6),e.YNc(6,Rt,3,3,"ng-container",6),e.qZA(),e.BQk()),2&o){const t=e.oxw();e.xp6(3),e.Q6J("matDialogClose","cancelled"),e.xp6(2),e.Q6J("ngIf","edit"===t.data.dialogMode),e.xp6(1),e.Q6J("ngIf","add"===t.data.dialogMode)}}let Yt=(()=>{class o{constructor(t,i,n,s,c,l,m){this.data=t,this._changeDetectorRef=i,this._formBuilder=n,this._fuseConfirmationService=s,this._dialogRef=c,this._uomService=l,this.store=m,this.dialogMode="view",this.user$=(0,b.of)(null),this.user=null,this._unsubscribeAll=new w.x,this.dialogMode=t.dialogMode,this.uom=t.uom}ngOnInit(){this.user$=this.store.select(L.rk),this.user$.subscribe(t=>this.user=t),this.uomForm=this._formBuilder.group({_id:[null],user:[this.user._id,[r.kI.required]],active:[!0,[r.kI.required]],name:[null,[r.kI.required,r.kI.minLength(3),r.kI.maxLength(250)]],abbr:[null,[r.kI.required,r.kI.maxLength(20)]],type:[null,[r.kI.required,r.kI.minLength(3),r.kI.maxLength(100)]]}),"edit"===this.dialogMode&&this.uomForm.patchValue(this.uom)}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}closeDialog(){this._dialogRef.close()}createUom(){let t=this.uomForm.getRawValue();t=(0,ae.Z)(t,["_id"]),this._fuseConfirmationService.open({title:"Crear Unidad de Medida",message:"\xbfEsta seguro que toda la informaci\xf3n es correcta?",icon:{show:!0,name:"heroicons_outline:question-mark-circle",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(n=>{"confirmed"===n&&this._uomService.createUom(t).pipe((0,d.R)(this._unsubscribeAll)).subscribe(s=>{this._fuseConfirmationService.open({title:"Confirmaci\xf3n",message:s.message,icon:{show:!0,name:"heroicons_outline:check",color:"success"},actions:{confirm:{show:!0,label:"Ok",color:"primary"},cancel:{show:!1}},dismissible:!1})},s=>{this._fuseConfirmationService.open({title:`${s.statusText}: ${s.status}`,message:s.error.message,icon:{show:!0,name:"heroicons_outline:exclamation-circle",color:"error"},actions:{confirm:{show:!0,label:"Ok",color:"primary"},cancel:{show:!1}},dismissible:!1})}),this._changeDetectorRef.markForCheck()})}updateUom(){const t=this.uomForm.getRawValue();this._fuseConfirmationService.open({title:"Actualizar Unidad de Medida",message:"\xbfEsta seguro que toda la informaci\xf3n es correcta?",icon:{show:!0,name:"heroicons_outline:question-mark-circle",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(n=>{"confirmed"===n&&this._uomService.updateUom(t).pipe((0,d.R)(this._unsubscribeAll)).subscribe(s=>{this._fuseConfirmationService.open({title:"Confirmaci\xf3n",message:s.message,icon:{show:!0,name:"heroicons_outline:check",color:"success"},actions:{confirm:{show:!0,label:"Ok",color:"primary"},cancel:{show:!1}},dismissible:!1}),this._changeDetectorRef.markForCheck()},s=>{this._fuseConfirmationService.open({title:`${s.statusText}: ${s.status}`,message:s.error.message,icon:{show:!0,name:"heroicons_outline:exclamation-circle",color:"error"},actions:{confirm:{show:!0,label:"Ok",color:"primary"},cancel:{show:!1}},dismissible:!1})}),this._changeDetectorRef.markForCheck()})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(x.WI),e.Y36(e.sBO),e.Y36(r.qu),e.Y36(T.R),e.Y36(x.so),e.Y36(pe),e.Y36(h.yh))},o.\u0275cmp=e.Xpm({type:o,selectors:[["stock-uom-dialog"]],decls:11,vars:5,consts:[[1,"relative","flex","flex-col","w-full","max-h-screenl"],[1,"flex","flex-col","items-center","px-8","pt-4","space-y-1","text-center","sm:items-start","sm:mt-0","sm:pr-8","sm:text-left"],["class","text-2xl text-gray-400",4,"ngIf"],[1,"flex","flex-col","items-center","flex-auto","w-full","px-8","pb-6","sm:flex-row","sm:items-start","sm:pb-8"],["class","flex-auto",4,"ngIf"],["class","w-full overflow-hidden",4,"ngIf"],[4,"ngIf"],[1,"text-2xl","text-gray-400"],[1,"flex-auto"],[1,"flex"],[1,"flex","flex-col","w-full","mt-5"],[1,"flex","flex-col","p-8","pb-0","sm:flex-row"],[1,"w-full","py-10","my-10"],[1,"mb-2","font-medium"],[1,"border-sm"],[1,"w-full","overflow-hidden"],[1,"flex","flex-col"],[1,"flex","flex-col","w-full","mt-1",3,"formGroup","autocomplete"],[1,"py-5"],[1,"w-full","fuse-mat-no-subscript"],["matInput","","type","text","required","","maxlength","250",3,"formControlName","placeholder"],["required","",3,"formControlName"],[3,"value"],[1,"flex","flex-col","mt-4"],[1,"mb-4","font-medium"],[3,"formControlName","color"],[1,"flex","items-center","justify-center","px-6","py-4","space-x-3","sm:justify-end","bg-gray-50","dark:bg-black","dark:bg-opacity-10"],["mat-stroked-button","",3,"matDialogClose"],["mat-flat-button","",3,"color","disabled","matDialogClose","click"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e.ynx(1),e.TgZ(2,"div",1),e.YNc(3,Nt,2,0,"h2",2),e.YNc(4,Jt,2,0,"h2",2),e.qZA(),e.BQk(),e.TgZ(5,"div",3),e.ynx(6),e.YNc(7,Dt,9,1,"div",4),e.BQk(),e.ynx(8),e.YNc(9,Pt,29,13,"div",5),e.BQk(),e.qZA(),e.YNc(10,Lt,7,3,"ng-container",6),e.qZA()),2&t&&(e.xp6(3),e.Q6J("ngIf","add"===i.data.dialogMode),e.xp6(1),e.Q6J("ngIf","edit"===i.data.dialogMode),e.xp6(3),e.Q6J("ngIf","view"===i.data.dialogMode),e.xp6(2),e.Q6J("ngIf","edit"===i.data.dialogMode||"add"),e.xp6(1),e.Q6J("ngIf","view"!==i.data.dialogMode))},directives:[p.O5,r._Y,r.JL,r.sg,_.KE,_.hX,A.Nt,r.Fj,r.Q7,r.nD,r.JJ,r.u,ge.gD,H.ey,ce.Rr,y.lW,x.ZT],encapsulation:2}),o})();const Mt={_id:null,active:null,userId:null,name:null,abbr:null,type:null};function $t(o,a){1&o&&(e.ynx(0),e._UZ(1,"mat-icon",37),e.BQk()),2&o&&(e.xp6(1),e.Q6J("svgIcon","heroicons_solid:check"))}function Et(o,a){1&o&&(e.ynx(0),e._UZ(1,"mat-icon",38),e.BQk()),2&o&&(e.xp6(1),e.Q6J("svgIcon","heroicons_solid:x"))}function Ot(o,a){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",30)(2,"div",31),e._uU(3),e.qZA(),e.TgZ(4,"div",32)(5,"div",33),e._uU(6),e.qZA()(),e.TgZ(7,"div",32)(8,"div",33),e._uU(9),e.qZA()(),e.TgZ(10,"div",34),e.YNc(11,$t,2,1,"ng-container",20),e.YNc(12,Et,2,1,"ng-container",20),e.qZA(),e.TgZ(13,"div")(14,"button",35),e.NdJ("click",function(){const s=e.CHM(t).$implicit;return e.oxw(4).updateUom(s)}),e._UZ(15,"mat-icon",36),e.qZA()()(),e.BQk()}if(2&o){const t=a.$implicit;e.xp6(3),e.hij(" ",t.name," "),e.xp6(3),e.Oqu(t.abbr),e.xp6(3),e.Oqu(t.type),e.xp6(2),e.Q6J("ngIf",t.active),e.xp6(1),e.Q6J("ngIf",!t.active),e.xp6(3),e.Q6J("svgIcon","heroicons_solid:pencil")}}function zt(o,a){if(1&o&&(e.ynx(0),e.YNc(1,Ot,16,6,"ng-container",29),e.BQk()),2&o){const t=a.ngIf,i=e.oxw(3);e.xp6(1),e.Q6J("ngForOf",t)("ngForTrackBy",i.trackByFn)}}const jt=function(){return[5,10,25,100]};function Wt(o,a){if(1&o&&(e.ynx(0),e.TgZ(1,"div",23)(2,"div",24)(3,"div",25),e._uU(4,"Nombre"),e.qZA(),e.TgZ(5,"div",26),e._uU(6," Siglas "),e.qZA(),e.TgZ(7,"div",27),e._uU(8," Tipo "),e.qZA(),e.TgZ(9,"div",27),e._uU(10," Activo "),e.qZA(),e.TgZ(11,"div",26),e._uU(12,"Detalles"),e.qZA()(),e.YNc(13,zt,2,2,"ng-container",20),e.ALo(14,"async"),e.qZA(),e._UZ(15,"mat-paginator",28),e.BQk()),2&o){const t=e.oxw(2);e.xp6(3),e.Q6J("mat-sort-header","name"),e.xp6(4),e.Q6J("mat-sort-header","value"),e.xp6(2),e.Q6J("mat-sort-header","active"),e.xp6(4),e.Q6J("ngIf",e.lcZ(14,9,t.uoms$)),e.xp6(2),e.Q6J("length",t.pagination.length)("pageIndex",t.pagination.page)("pageSize",t.pagination.size)("pageSizeOptions",e.DdM(11,jt))("showFirstLastButtons",!0)}}function Gt(o,a){if(1&o&&(e.ynx(0),e.YNc(1,Wt,16,12,"ng-container",22),e.BQk()),2&o){const t=a.ngIf;e.oxw();const i=e.MAs(31);e.xp6(1),e.Q6J("ngIf",t.length>0)("ngIfElse",i)}}function Vt(o,a){1&o&&(e.TgZ(0,"div",39),e._uU(1,"\xa1No se ha creado ninguna unidad de medida!"),e.qZA())}let Ht=(()=>{class o{constructor(t,i,n,s,c){this._changeDetectorRef=t,this._dialog=i,this._fuseConfirmationService=n,this._uomService=s,this.store=c,this.flashMessage=null,this.uoms$=(0,b.of)([]),this.searchInputControl=new r.NI,this.isLoading=!1,this._unsubscribeAll=new w.x}ngOnInit(){this.uoms$=this.store.select(Y),this.store.select(ie.B).pipe((0,d.R)(this._unsubscribeAll)).subscribe(t=>{this.pagination=t,this._changeDetectorRef.markForCheck()}),this.searchInputControl.valueChanges.pipe((0,d.R)(this._unsubscribeAll),(0,J.b)(300),(0,g.w)(t=>(this.isLoading=!0,this._uomService.getUoms(0,10,"name","asc",t))),(0,f.U)(()=>{this.isLoading=!1})).subscribe()}ngAfterViewInit(){this._sort&&this._paginator&&(this._sort.sort({id:"name",start:"asc",disableClear:!0}),this._changeDetectorRef.markForCheck(),this._sort.sortChange.pipe((0,d.R)(this._unsubscribeAll)).subscribe(()=>{this._paginator.pageIndex=0}),(0,ee.T)(this._sort.sortChange,this._paginator.page).pipe((0,g.w)(()=>(this.isLoading=!0,this._uomService.getUoms(this._paginator.pageIndex,this._paginator.pageSize,this._sort.active,this._sort.direction))),(0,f.U)(()=>{this.isLoading=!1})).subscribe())}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}createUom(){this._openDialog(Mt,"add")}updateUom(t){this._openDialog(t,"edit")}trackByFn(t,i){return t||i.id}_openDialog(t,i){this._dialog.open(Yt,{data:{uom:t,dialogMode:i},panelClass:"ath-dialog-panel"})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(e.sBO),e.Y36(x.uw),e.Y36(T.R),e.Y36(pe),e.Y36(h.yh))},o.\u0275cmp=e.Xpm({type:o,selectors:[["stock-uom"]],viewQuery:function(t,i){if(1&t&&(e.Gf(F.NW,5),e.Gf(k.YE,5)),2&t){let n;e.iGM(n=e.CRH())&&(i._paginator=n.first),e.iGM(n=e.CRH())&&(i._sort=n.first)}},decls:32,vars:10,consts:[[1,"flex","flex-col","flex-auto","min-w-0","sm:absolute","sm:inset-0","sm:overflow-hidden","bg-card","dark:bg-transparent"],[1,"relative","flex","flex-col","px-6","py-8","border-b","sm:flex-row","flex-0","sm:items-center","sm:justify-between","md:px-8"],[1,"flex-1","min-w-0"],[1,"flex","flex-wrap","items-center","font-medium"],["routerLink","/home",1,"whitespace-nowrap","text-primary-500"],[1,"flex","items-center","ml-1","whitespace-nowrap"],[1,"icon-size-5","text-secondary",3,"svgIcon"],["routerLink","/stock/panels",1,"ml-1","text-primary-500"],[1,"ml-1","text-primary-500"],[1,"mt-2"],[1,"text-3xl","font-extrabold","leading-7","tracking-tight","truncate","md:text-4xl","sm:leading-10"],[1,"flex","items-center","mt-6","shrink-0","sm:mt-0","sm:ml-4"],[1,"mr-4","fuse-mat-dense","fuse-mat-no-subscript","fuse-mat-rounded","min-w-64"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"formControl","autocomplete","placeholder"],["mat-raised-button","",1,"bg-gradient-to-r","from-primary-500","to-primary-600","text-white",3,"click"],[3,"svgIcon"],[1,"ml-2","mr-1","text-white","hidden","sm:block"],[1,"flex","flex-auto","overflow-hidden"],[1,"flex","flex-col","flex-auto","overflow-hidden","sm:mb-18","sm:overflow-y-auto"],[4,"ngIf"],["noUoms",""],[4,"ngIf","ngIfElse"],[1,"grid"],["matSort","","matSortDisableClear","",1,"sticky","top-0","z-10","grid","gap-4","px-6","py-4","font-semibold","shadow","uom-grid","md:px-8","text-md","text-secondary","bg-gray-50","dark:bg-black","dark:bg-opacity-5"],[3,"mat-sort-header"],[1,"hidden","sm:block"],[1,"hidden","lg:block",3,"mat-sort-header"],[1,"z-10","border-b","sm:absolute","sm:inset-x-0","sm:bottom-0","sm:border-t","sm:border-b-0","bg-gray-50","dark:bg-transparent",3,"length","pageIndex","pageSize","pageSizeOptions","showFirstLastButtons"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"grid","items-center","gap-4","px-6","py-3","border-b","uom-grid","md:px-8"],[1,"truncate"],[1,"items-center","hidden","lg:flex"],[1,"min-w-4"],[1,"hidden","lg:block"],["mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"click"],[1,"icon-size-5",3,"svgIcon"],[1,"text-green-400","icon-size-5",3,"svgIcon"],[1,"text-gray-400","icon-size-5",3,"svgIcon"],[1,"p-8","text-4xl","font-semibold","tracking-tight","text-center","border-t","sm:p-16"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div")(5,"a",4),e._uU(6,"Inicio"),e.qZA()(),e.TgZ(7,"div",5),e._UZ(8,"mat-icon",6),e.TgZ(9,"a",7),e._uU(10,"Inventario"),e.qZA()(),e.TgZ(11,"div",5),e._UZ(12,"mat-icon",6),e.TgZ(13,"a",8),e._uU(14,"Unidades de Medida"),e.qZA()()(),e.TgZ(15,"div",9)(16,"h2",10),e._uU(17," Unidades de Medida "),e.qZA()()(),e.TgZ(18,"div",11)(19,"mat-form-field",12),e._UZ(20,"mat-icon",13)(21,"input",14),e.qZA(),e.TgZ(22,"button",15),e.NdJ("click",function(){return i.createUom()}),e._UZ(23,"mat-icon",16),e.TgZ(24,"span",17),e._uU(25,"Agregar"),e.qZA()()()(),e.TgZ(26,"div",18)(27,"div",19),e.YNc(28,Gt,2,2,"ng-container",20),e.ALo(29,"async"),e.YNc(30,Vt,2,0,"ng-template",null,21,e.W1O),e.qZA()()()),2&t&&(e.xp6(8),e.Q6J("svgIcon","heroicons_solid:chevron-right"),e.xp6(4),e.Q6J("svgIcon","heroicons_solid:chevron-right"),e.xp6(8),e.Q6J("svgIcon","heroicons_solid:search"),e.xp6(1),e.Q6J("formControl",i.searchInputControl)("autocomplete","off")("placeholder","Buscar unidades"),e.xp6(2),e.Q6J("svgIcon","heroicons_outline:plus"),e.xp6(5),e.Q6J("ngIf",e.lcZ(29,8,i.uoms$)))},directives:[C.yS,Q.Hw,_.KE,_.qo,A.Nt,r.Fj,r.JJ,r.oH,y.lW,p.O5,k.YE,k.nU,p.sg,F.NW],pipes:[p.Ov],styles:[".uom-grid{grid-template-columns:auto 40px}@media (min-width: 600px){.uom-grid{grid-template-columns:auto 112px 72px}}@media (min-width: 960px){.uom-grid{grid-template-columns:112px auto 112px 72px}}@media (min-width: 1280px){.uom-grid{grid-template-columns:auto 250px 150px 72px 72px}}\n"],encapsulation:2,data:{animation:E.L},changeDetection:0}),o})();var Xt=u(8258),D=u(149),Kt=u(449),eo=u(1910),to=u(8675),q=u(1233);class he{}class oo{}const le=z.N.API_URL;let ue=(()=>{class o{constructor(t,i){this._httpClient=t,this.store=i,this.dataChange=new Ce.X([])}get data(){return this.dataChange.value}get data$(){return this.dataChange.asObservable()}getCategoriesByBusiness(t){return this._httpClient.get(`${le}/categories/business/${t}`).pipe((0,f.U)(i=>{const n=this._buildFileTree(i.categories,0);return this.store.dispatch((0,q.Fp)({categoriesNodes:n})),this.store.dispatch((0,q.DG)({categories:i.categories})),i.categories}))}createCategory(t){const i=this.store.select(te);let n=[];return i.subscribe(s=>n=s),this.store.select(oe).pipe((0,v.q)(1),(0,g.w)(s=>this._httpClient.post(`${le}/categories`,t).pipe((0,f.U)(c=>{let l=!0;for(const m of s)if(console.log(t._id),void 0===t._id){if(this.updateChildren(m,c.category)){l=!1;break}}else if(this.addChildren(m,c.category)){l=!1;break}return console.log(s),l&&(c.category.level=0,c.category.parentId="root",s.push({item:c.category,children:[]}),this.sortBrothers({item:c.category,children:s},c.category)),this.store.dispatch((0,q.DG)({categories:[c.category,...n]})),this.store.dispatch((0,q.Fp)({categoriesNodes:s})),c}))))}updateCategory(t){return this.store.select(oe).pipe((0,v.q)(1),(0,g.w)(i=>this._httpClient.patch(`${le}/Categories/${t._id}`,t).pipe((0,f.U)(n=>{for(const l of i){if(l.item._id===n.category._id){i.splice(i.indexOf(l),1);break}if(this.removeChildren(l,n.category))break}let s=!0;for(const l of i)if(this.addChildren(l,n.category)){s=!1;break}s&&(n.category.level=0,n.category.parentId="root",i.push({item:n.category,children:[]}),this.sortBrothers({item:n.category,children:i},n.category));const c=[];return this.getCategoriesFromTree({item:null,children:[...i]},c),this.store.dispatch((0,q.DG)({categories:c})),this.store.dispatch((0,q.Fp)({categoriesNodes:i})),n}))))}deleteCategory(t){return this.store.select(oe).pipe((0,v.q)(1),(0,g.w)(i=>this._httpClient.delete(`${le}/Categories/${t}`).pipe((0,f.U)(n=>{for(const c of i){if(c.item._id===n.category._id){i.splice(i.indexOf(c),1);break}if(this.removeChildren(c,n.category))break}const s=[];return this.getCategoriesFromTree({item:null,children:[...i]},s),this.store.dispatch((0,q.DG)({categories:s})),this.store.dispatch((0,q.Fp)({categoriesNodes:i})),n}))))}insertItem(t){t.children&&(t.children.push({item:{_id:"",parentId:t.item._id,level:t.item.level+1,userId:t.item.userId,businessId:t.item.businessId,active:!0},children:[]}),this.store.dispatch((0,q.Fp)({categoriesNodes:this.data})))}_buildFileTree(t,i=0){const n=t.filter(c=>0===c.level),s=[];for(const c of n){const l=new he;l.item=c,l.children=[],this.getAllDescendent(t,c._id,l),s.push(l)}return s.sort((c,l)=>Number(l.item.isGroup)-Number(c.item.isGroup)),s}getAllDescendent(t,i,n){const s=[],c=t.filter(l=>i===l.parentId);for(const l of c){const m=new he;m.item=l,m.children=[],this.getAllDescendent(t,l._id,m),s.push(m),n.children=s.sort((Z,P)=>Number(P.item.isGroup)-Number(Z.item.isGroup))}}addChildren(t,i){if(t.item._id===i.parentId){const n=new he;return n.item=i,n.children=[],t.children.push(n),this.sortBrothers(t,i),!0}for(const n of t.children)if(this.addChildren(n,i))return!0;return!1}updateChildren(t,i){if(t.item._id===i._id||""===t.item._id)return t.item=i,this.sortBrothers({item:{_id:"sort"},children:this.data},i),!0;for(const n of t.children)if(this.updateChildren(n,i))return!0;return!1}removeChildren(t,i){for(let n=0;n<t.children.length;n++){const s=t.children[n];if(s.item._id===i._id)return t.children.splice(n,1),!0;if(this.removeChildren(s,i))return!0}return!1}getCategoriesFromTree(t,i){t.item&&i.push(t.item);for(const n of t.children)this.getCategoriesFromTree(n,i)}sortBrothers(t,i){for(let n=0;n<t.children.length;n++){const s=t.children[n];if(s.item._id===i._id&&(t.children=t.children.sort((c,l)=>Number(l.item.isGroup)-Number(c.item.isGroup))),this.sortBrothers(s,i))return!0}return!1}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(S.eN),e.LFG(h.yh))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var Ie=u(1079),fe=u(7446);function io(o,a){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El nombre de la categor\xeda es obligatorio. "),e.qZA())}function no(o,a){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," La cueta padre es obligatoria. "),e.qZA())}function ro(o,a){if(1&o&&(e.TgZ(0,"mat-option",22),e._uU(1),e.qZA()),2&o){const t=a.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t.name," ")}}const so=function(o){return{"cursor-not-allowed":o}};let ao=(()=>{class o{constructor(t,i,n,s,c,l,m){this.data=t,this._athConfirmationService=i,this._categoriesService=n,this._changeDetectorRef=s,this._dialogRef=c,this._formBuilder=l,this.store=m,this.categories=[],this.categoriesData=[],this.category=null,this._unsubscribeAll=new w.x}ngOnInit(){this.store.select(L.rk).pipe((0,d.R)(this._unsubscribeAll)).subscribe(t=>{this.user=t}),this.store.select(te).pipe((0,d.R)(this._unsubscribeAll)).subscribe(t=>{this.categories=[...t],this.categoriesData=[...t],this.categories.push({parentId:"root",name:"root"})}),this.searchCategoriesControl=new r.NI(""),this.categoryForm=this._formBuilder.group({_id:[null],userId:[this.user._id,[r.kI.required]],active:[!1],name:[null,[r.kI.required,r.kI.maxLength(250)]],businessId:["000000000000000000000000"],parentId:["000000000000000000000000"],isGroup:[!1,[r.kI.required]],level:[0,[r.kI.required,r.kI.min(0)]]}),this.searchCategoriesControl.setValue("root"),this.filteredCategories=this.searchCategoriesControl.valueChanges.pipe((0,d.R)(this._unsubscribeAll),(0,J.b)(600),(0,to.O)(""),(0,g.w)(t=>(0,b.of)(this.categories.filter(i=>i.name.includes(t)))))}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}fillOwnerCategories(t){const i=t.option.value;this.categories=i?[...this.categoriesData]:[...this.categoriesData.filter(n=>this.category._id!==i._id)],this.categoryForm.get("parentId").setValue(i?i._id:"000000000000000000000000"),this.categoryForm.get("level").setValue(i?i.level+1:0),this.searchCategoriesControl.setValue(i.name)}closeDialog(t){this.category=t,this.data.category=t,this._dialogRef.close(this.data)}createCategory(){let t=this.categoryForm.getRawValue();t=(0,N.omit)(t,["_id","createdAt","updatedAt"]),console.log(t),this._athConfirmationService.open({title:"Crear Categor\xeda",message:"\xbfEst\xe1 seguro que toda la informaci\xf3n es correcta?",icon:{show:!0,name:"heroicons_outline:question-mark-circle",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().pipe((0,d.R)(this._unsubscribeAll)).subscribe(n=>{"confirmed"===n&&this._categoriesService.createCategory(t).pipe((0,d.R)(this._unsubscribeAll)).subscribe(s=>{this._athConfirmationService.open({title:"Confirmaci\xf3n",message:s.message,icon:{show:!0,name:"heroicons_outline:check",color:"success"},actions:{confirm:{show:!0,label:"Ok",color:"primary"},cancel:{show:!1}},dismissible:!1}),this._changeDetectorRef.markForCheck(),this.closeDialog(s.category)},s=>{let c;console.warn(s),c=s.error?s.error.message:s.message,this._athConfirmationService.open({title:`${s.statusText}: ${s.status}`,message:c,icon:{show:!0,name:"heroicons_outline:exclamation-circle",color:"error"},actions:{confirm:{show:!0,label:"Ok",color:"primary"},cancel:{show:!1}},dismissible:!1})})})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(x.WI),e.Y36(T.R),e.Y36(ue),e.Y36(e.sBO),e.Y36(x.so),e.Y36(r.qu),e.Y36(h.yh))},o.\u0275cmp=e.Xpm({type:o,selectors:[["categories-dialog"]],decls:37,vars:20,consts:[[1,"relative","flex","flex-col","w-full","max-h-screen"],[1,"flex","flex-col","items-center","px-8","pt-4","space-y-1","text-center","sm:items-start","sm:mt-0","sm:pr-8","sm:text-left"],["mat-dialog-title",""],[1,"flex","flex-col","items-center","flex-auto","w-full","px-8","pb-6"],[1,"w-full","overflow-hidden"],[1,"flex","border-t"],[1,"flex","flex-col","w-full","pt-8",3,"formGroup","autocomplete"],[1,"grid","grid-cols-1","gap-x-4"],[1,""],[1,"w-full"],["matInput","","require","",3,"formControlName","type","placeholder"],[4,"ngIf"],["aria-label","String","matInput","","required","",3,"type","placeholder","formControl","matAutocomplete"],["autoActiveFirstOption","",3,"optionSelected"],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],[1,"mat-form-field-wrapper","mt-2"],["color","primary",3,"formControlName"],["isGroup",""],[1,"flex","items-center","justify-between","w-full","px-8","py-4","bg-gray-50"],["mat-button","",1,"-ml-4","rounded-full",3,"color","click"],["mat-flat-button","",1,"rounded-full","bg-primary-500","text-black",3,"ngClass","disabled","click"],[3,"value"]],template:function(t,i){if(1&t&&(e.TgZ(0,"div",0),e.ynx(1),e.TgZ(2,"div",1)(3,"h2",2),e._uU(4,"Agregar categor\xeda"),e.qZA()(),e.BQk(),e.TgZ(5,"div",3),e.ynx(6),e.TgZ(7,"div",4)(8,"div",5)(9,"form",6)(10,"div",7)(11,"div",8)(12,"mat-form-field",9)(13,"mat-label"),e._uU(14,"Nombre de la categor\xeda"),e.qZA(),e._UZ(15,"input",10),e.YNc(16,io,2,0,"mat-error",11),e.qZA()(),e.TgZ(17,"div",8)(18,"mat-form-field",9)(19,"mat-label"),e._uU(20,"Categor\xeda Padre"),e.qZA(),e._UZ(21,"input",12),e.YNc(22,no,2,0,"mat-error",11),e.TgZ(23,"mat-autocomplete",13,14),e.NdJ("optionSelected",function(s){return i.fillOwnerCategories(s)}),e.YNc(25,ro,2,2,"mat-option",15),e.ALo(26,"async"),e.qZA()()(),e.TgZ(27,"div",16)(28,"mat-checkbox",17,18),e._uU(30,"Es Grupo "),e.qZA()()()()()(),e.BQk(),e.qZA(),e.ynx(31),e.TgZ(32,"div",19)(33,"button",20),e.NdJ("click",function(){return i.closeDialog(null)}),e._uU(34,"Cancelar"),e.qZA(),e.TgZ(35,"button",21),e.NdJ("click",function(){return i.createCategory()}),e._uU(36,"Agregar"),e.qZA()(),e.BQk(),e.qZA()),2&t){const n=e.MAs(24);e.xp6(9),e.Q6J("formGroup",i.categoryForm)("autocomplete","off"),e.xp6(6),e.Q6J("formControlName","name")("type","text")("placeholder","Introduzca el nombre de la categor\xeda"),e.xp6(1),e.Q6J("ngIf",i.categoryForm.get("name").hasError("required")),e.xp6(5),e.Q6J("type","text")("placeholder","Filtre por nombre o n\xfamero de categor\xeda")("formControl",i.searchCategoriesControl)("matAutocomplete",n),e.xp6(1),e.Q6J("ngIf",i.categoryForm.get("parentId").hasError("required")),e.xp6(3),e.Q6J("ngForOf",e.lcZ(26,16,i.filteredCategories)),e.xp6(3),e.Q6J("formControlName","isGroup"),e.xp6(5),e.Q6J("color","warn"),e.xp6(2),e.Q6J("ngClass",e.VKq(18,so,i.categoryForm.invalid))("disabled",i.categoryForm.invalid)}},directives:[x.uh,r._Y,r.JL,r.sg,_.KE,_.hX,A.Nt,r.Fj,r.JJ,r.u,p.O5,_.TO,Ie.ZL,r.Q7,r.oH,Ie.XC,p.sg,H.ey,fe.oG,y.lW,p.mk],pipes:[p.Ov],encapsulation:2,changeDetection:0}),o})();function co(o,a){if(1&o&&(e.TgZ(0,"mat-tree-node",19),e._UZ(1,"button",20),e._uU(2),e.qZA()),2&o){const t=a.$implicit;e.xp6(2),e.hij(" ",t.item.name," ")}}function lo(o,a){if(1&o){const t=e.EpF();e.TgZ(0,"button",28),e.NdJ("click",function(){e.CHM(t);const n=e.oxw().$implicit,s=e.MAs(8),c=e.MAs(4);return e.oxw().saveNode(n,s.value,c.checked)}),e._uU(1,"Save"),e.qZA()}}function uo(o,a){if(1&o&&(e.TgZ(0,"mat-tree-node",19),e._UZ(1,"button",20),e.TgZ(2,"div",21)(3,"mat-checkbox",22,23),e._uU(5," Grupo "),e.qZA()(),e.TgZ(6,"mat-form-field",24),e._UZ(7,"input",25,26),e.qZA(),e.YNc(9,lo,2,0,"button",27),e.qZA()),2&o){const t=a.$implicit;e.xp6(9),e.Q6J("ngIf",""===t.item._id)}}function mo(o,a){if(1&o){const t=e.EpF();e.TgZ(0,"mat-tree-node",19)(1,"button",29),e._UZ(2,"mat-icon",30),e.qZA(),e._uU(3),e.TgZ(4,"button",31),e.NdJ("click",function(){const s=e.CHM(t).$implicit;return e.oxw().addNewItem(s)}),e._UZ(5,"mat-icon",13),e.qZA(),e.TgZ(6,"button",31),e.NdJ("click",function(){const s=e.CHM(t).$implicit;return e.oxw().deleteAccount(s.item)}),e._UZ(7,"mat-icon",13),e.qZA()()}if(2&o){const t=a.$implicit,i=e.oxw();e.xp6(1),e.uIk("aria-label","Expandir "+t.item.name),e.xp6(1),e.Q6J("svgIcon",i.treeControl.isExpanded(t)?"heroicons_outline:chevron-down":"heroicons_outline:chevron-right"),e.xp6(1),e.hij(" ",t.item.name," "),e.xp6(2),e.Q6J("svgIcon","heroicons_outline:plus"),e.xp6(2),e.Q6J("svgIcon","heroicons_outline:trash")}}let po=(()=>{class o{constructor(t,i,n,s,c){this._changeDetectorRef=t,this._dialog=i,this._fuseConfirmationService=n,this._categoriesService=s,this.store=c,this.merchants=[],this.merchants$=(0,b.of)([]),this.categoriesNodes=[],this.categoriesNodes$=(0,b.of)([]),this.flatNodeMap=new Map,this.nestedNodeMap=new Map,this.selectedParent=null,this.newItemName="",this.checklistSelection=new Kt.Ov(!0),this._unsubscribeAll=new w.x,this.getLevel=l=>l.level,this.isExpandable=l=>l.item?l.item.isGroup:l.expandable,this.getChildren=l=>l.children,this.hasChild=(l,m)=>m.item?m.item.isGroup:m.expandable,this.hasNoContent=(l,m)=>""===m.item._id,this.transformer=(l,m)=>{var Z;const P=this.nestedNodeMap.get(l),M=P&&P.item.name===l.item.name?P:new oo;return M.item=l.item,M.level=m,M.expandable=!!(null===(Z=l.children)||void 0===Z?void 0:Z.length),this.flatNodeMap.set(M,l),this.nestedNodeMap.set(l,M),M},this.treeFlattener=new D.JZ(this.transformer,this.getLevel,this.isExpandable,this.getChildren),this.treeControl=new Xt.C2(this.getLevel,this.isExpandable),this.dataSource=new D.kc(this.treeControl,this.treeFlattener)}ngOnInit(){this.merchants$=this.store.select(eo.UV),this.merchants$.pipe((0,d.R)(this._unsubscribeAll)).subscribe(t=>{this.merchants=t,console.log(t)}),this.categoriesNodes$=this.store.select(oe),this.categoriesNodes$.pipe((0,d.R)(this._unsubscribeAll)).subscribe(t=>{this.categoriesNodes=t,this.dataSource.data=t}),this._categoriesService.getCategoriesByBusiness("000000000000000000000000").subscribe()}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}descendantsAllSelected(t){const i=this.treeControl.getDescendants(t);return i.length>0&&i.every(s=>this.checklistSelection.isSelected(s))}descendantsPartiallySelected(t){return this.treeControl.getDescendants(t).some(s=>this.checklistSelection.isSelected(s))&&!this.descendantsAllSelected(t)}getParentNode(t){const i=this.getLevel(t);if(i<1)return null;for(let s=this.treeControl.dataNodes.indexOf(t)-1;s>=0;s--){const c=this.treeControl.dataNodes[s];if(this.getLevel(c)<i)return c}return null}addNewItem(t){const i=this.flatNodeMap.get(t);console.log(i),this._categoriesService.insertItem(i),this.treeControl.expand(t),this.selectedParent=t}saveNode(t,i,n){const s=this.flatNodeMap.get(t);console.log(n),s.item.name=i,s.item.isGroup=n;const c=(0,N.omit)(s.item,["_id"]);this._categoriesService.createCategory(c).subscribe(l=>{this.treeControl.collapse(this.selectedParent),this.treeControl.expand(this.selectedParent)})}openDialog(){this._dialog.open(ao,{data:{account:null},panelClass:"ath-dialog-panel",minWidth:"200px",maxWidth:"500px",maxHeight:"90vh",disableClose:!0}).afterClosed().subscribe(i=>{let n;if(i.category){for(const s of this.flatNodeMap.keys())s.item._id===i.category.parentId&&(n=s);this.treeControl.expand(n)}})}deleteCategory(t){this._fuseConfirmationService.open({title:"Eliminar categor\xeda",message:`\xbfEst\xe1 seguro que desea eliminar el categor\xeda ${t.name}?`,icon:{show:!0,name:"heroicons_outline:question-mark-circle",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(n=>{"confirmed"===n&&this._categoriesService.deleteCategory(t._id).subscribe(s=>{!s||(this._fuseConfirmationService.open({title:"Confirmaci\xf3n",message:`Categor\xeda ${t.name} eliminado correctamente`,icon:{show:!0,name:"heroicons_outline:check",color:"success"},actions:{confirm:{show:!0,label:"Ok",color:"primary"},cancel:{show:!1}},dismissible:!1}),this._changeDetectorRef.markForCheck())},s=>{console.warn(s),this._fuseConfirmationService.open({title:`${s.statusText}: ${s.status}`,message:s.error.message,icon:{show:!0,name:"heroicons_outline:exclamation-circle",color:"error"},actions:{confirm:{show:!0,label:"Ok",color:"primary"},cancel:{show:!1}},dismissible:!1})})}),this._changeDetectorRef.markForCheck()}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(e.sBO),e.Y36(x.uw),e.Y36(T.R),e.Y36(ue),e.Y36(h.yh))},o.\u0275cmp=e.Xpm({type:o,selectors:[["stock-categories"]],decls:28,vars:7,consts:[[1,"flex","flex-col","flex-auto","min-w-0","sm:absolute","sm:inset-0","sm:overflow-hidden","bg-card","dark:bg-transparent"],[1,"relative","flex","flex-col","px-6","py-8","border-b","sm:flex-row","flex-0","sm:items-center","sm:justify-between","md:px-8"],[1,"flex-1","min-w-0"],[1,"flex","flex-wrap","items-center","font-medium"],["routerLink","/home",1,"whitespace-nowrap","text-primary-500"],[1,"flex","items-center","ml-1","whitespace-nowrap"],[1,"icon-size-5","text-secondary",3,"svgIcon"],["routerLink","/stock/panels",1,"ml-1","text-primary-500"],[1,"ml-1","text-primary-500"],[1,"mt-2"],[1,"text-3xl","font-extrabold","leading-7","tracking-tight","truncate","md:text-4xl","sm:leading-10"],[1,"flex","items-center","mt-6","shrink-0","sm:mt-0","sm:ml-4"],["mat-raised-button","",1,"bg-gradient-to-r","from-primary-500","to-primary-600","text-white",3,"click"],[3,"svgIcon"],[1,"ml-2","mr-1","text-white","hidden","sm:block"],[1,"flex","flex-auto","overflow-hidden","p-10"],[3,"dataSource","treeControl"],["matTreeNodePadding","","class","focus:bg-slate-200",4,"matTreeNodeDef"],["matTreeNodePadding","","class","focus:bg-slate-200",4,"matTreeNodeDef","matTreeNodeDefWhen"],["matTreeNodePadding","",1,"focus:bg-slate-200"],["mat-icon-button","","disabled",""],[1,"mat-form-field-wrapper","mt-2"],["color","primary"],["isGroup",""],[1,"fuse-mat-dense","fuse-mat-no-subscript","fuse-mat-rounded","min-w-64"],["matInput","","placeholder","Nueva categor\xeda","required","","maxlength","100"],["itemValue",""],["mat-button","",3,"click",4,"ngIf"],["mat-button","",3,"click"],["mat-icon-button","","matTreeNodeToggle",""],[1,"mat-icon-rtl-mirror",3,"svgIcon"],["mat-icon-button","",3,"click"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div")(5,"a",4),e._uU(6,"Inicio"),e.qZA()(),e.TgZ(7,"div",5),e._UZ(8,"mat-icon",6),e.TgZ(9,"a",7),e._uU(10,"Inventario"),e.qZA()(),e.TgZ(11,"div",5),e._UZ(12,"mat-icon",6),e.TgZ(13,"a",8),e._uU(14,"Categor\xedas"),e.qZA()()(),e.TgZ(15,"div",9)(16,"h2",10),e._uU(17," Categor\xedas "),e.qZA()()(),e.TgZ(18,"div",11)(19,"button",12),e.NdJ("click",function(){return i.openDialog()}),e._UZ(20,"mat-icon",13),e.TgZ(21,"span",14),e._uU(22,"Agregar"),e.qZA()()()(),e.TgZ(23,"div",15)(24,"mat-tree",16),e.YNc(25,co,3,1,"mat-tree-node",17),e.YNc(26,uo,10,1,"mat-tree-node",18),e.YNc(27,mo,8,5,"mat-tree-node",18),e.qZA()()()),2&t&&(e.xp6(8),e.Q6J("svgIcon","heroicons_solid:chevron-right"),e.xp6(4),e.Q6J("svgIcon","heroicons_solid:chevron-right"),e.xp6(8),e.Q6J("svgIcon","heroicons_outline:plus"),e.xp6(4),e.Q6J("dataSource",i.dataSource)("treeControl",i.treeControl),e.xp6(2),e.Q6J("matTreeNodeDefWhen",i.hasNoContent),e.xp6(1),e.Q6J("matTreeNodeDefWhen",i.hasChild))},directives:[C.yS,Q.Hw,y.lW,D.gi,D.fQ,D.uo,D.ah,fe.oG,_.KE,A.Nt,p.O5,D.eu],encapsulation:2}),o})(),we=(()=>{class o{constructor(t){this._productsService=t}resolve(t,i){return this._productsService.getProducts()}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(se))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})(),go=(()=>{class o{constructor(t){this._productsService=t}resolve(t,i){return this._productsService.getTags()}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(se))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})(),Te=(()=>{class o{constructor(t){this._uomService=t}resolve(t,i){return this._uomService.getUoms()}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(pe))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})(),ye=(()=>{class o{constructor(t){this._brandsService=t}resolve(t,i){return this._brandsService.getBrands()}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(me))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var X=u(3024);const K=z.N.API_URL;let _e=(()=>{class o{constructor(t,i){this._httpClient=t,this.store=i}getSuppliers(t=0,i=10,n="name",s="asc",c=""){const l=(new S.LE).append("page",t.toString()).append("size",i.toString()).append("sort",n).append("order",s).append("search",c);return this._httpClient.get(`${K}/suppliers/`,{params:l}).pipe((0,I.b)(({pagination:m,suppliers:Z})=>{this.store.dispatch((0,re.Jr)({pagination:m})),this.store.dispatch((0,X.bz)({suppliers:Z}))}))}getSupplierById(t){return this._httpClient.get(`${K}/suppliers/${t}`).pipe((0,ne.j)("supplier"),(0,I.b)(i=>{this.store.dispatch((0,X.n2)({supplier:i}))}))}createSupplier(t){return this.store.select(R).pipe((0,v.q)(1),(0,g.w)(i=>this._httpClient.post(`${K}/suppliers/`,t).pipe((0,I.b)(n=>{this.store.dispatch((0,X.bz)({suppliers:[n.supplier,...i]}))}))))}updateSupplier(t){return this.store.select(R).pipe((0,v.q)(1),(0,g.w)(i=>this._httpClient.patch(`${K}/suppliers/${t._id}`,t).pipe((0,f.U)(n=>{const s=i.findIndex(c=>c._id===t._id);return i[s]=n.supplier,this.store.dispatch((0,X.bz)({suppliers:i})),n}))))}deleteSupplier(t){return this.store.select(R).pipe((0,v.q)(1),(0,g.w)(i=>this._httpClient.delete(`${K}/suppliers/${t}`).pipe((0,f.U)(n=>{const s=i.findIndex(c=>c._id===t);return i.splice(s,1),this.store.dispatch((0,X.bz)({suppliers:i})),n}))))}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(S.eN),e.LFG(h.yh))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})(),Ae=(()=>{class o{constructor(t){this._suppliersService=t}resolve(t,i){return this._suppliersService.getSuppliers()}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(_e))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();function ho(o,a){1&o&&(e.TgZ(0,"h2",7),e._uU(1," Agregar Proveedor "),e.qZA())}function fo(o,a){1&o&&(e.TgZ(0,"h2",7),e._uU(1," Editar Proveedor "),e.qZA())}function _o(o,a){if(1&o&&(e.TgZ(0,"div",8)(1,"div",9)(2,"div",10)(3,"div",11)(4,"div",12)(5,"h6",13),e._uU(6,"Nombre"),e.qZA(),e.TgZ(7,"span",14),e._uU(8),e.qZA()()()()()()),2&o){const t=e.oxw();e.xp6(8),e.Oqu(t.data.supplier.name||"Sin nombre")}}function xo(o,a){if(1&o&&(e.TgZ(0,"div",15)(1,"div",16)(2,"form",17)(3,"div",18)(4,"mat-form-field",19)(5,"mat-label"),e._uU(6,"Nombre"),e.qZA(),e._UZ(7,"input",20),e.qZA()(),e.TgZ(8,"div",18)(9,"mat-form-field",19)(10,"mat-label"),e._uU(11,"Categor\xeda"),e.qZA(),e.TgZ(12,"mat-select",21)(13,"mat-option",22),e._uU(14,"Farmac\xe9utico"),e.qZA(),e.TgZ(15,"mat-option",22),e._uU(16,"Material Sanitario"),e.qZA(),e.TgZ(17,"mat-option",22),e._uU(18,"Insumos M\xe9dicos"),e.qZA(),e.TgZ(19,"mat-option",22),e._uU(20,"Equipos M\xe9dicos"),e.qZA()()()(),e.TgZ(21,"div",18)(22,"mat-form-field",19)(23,"mat-label"),e._uU(24,"Tipo"),e.qZA(),e.TgZ(25,"mat-select",21)(26,"mat-option",22),e._uU(27,"Empresa"),e.qZA(),e.TgZ(28,"mat-option",22),e._uU(29,"Individual"),e.qZA()()()(),e.TgZ(30,"div",18)(31,"mat-form-field",19)(32,"mat-label"),e._uU(33,"Direcci\xf3n"),e.qZA(),e._UZ(34,"textarea",23),e.qZA()(),e.TgZ(35,"div",18)(36,"mat-form-field",19)(37,"mat-label"),e._uU(38,"Sitio web"),e.qZA(),e._UZ(39,"input",24),e.qZA()(),e.TgZ(40,"div",25)(41,"span",26),e._uU(42,"Estado"),e.qZA(),e.TgZ(43,"mat-slide-toggle",27),e._uU(44),e.qZA()()()()()),2&o){const t=e.oxw();e.xp6(2),e.Q6J("formGroup",t.supplierForm)("autocomplete","off"),e.xp6(5),e.Q6J("formControlName","name")("placeholder","Nombre del proveedor"),e.xp6(5),e.Q6J("formControlName","category"),e.xp6(1),e.Q6J("value","farmac\xe9utico"),e.xp6(2),e.Q6J("value","material sanitario"),e.xp6(2),e.Q6J("value","insumos m\xe9dicos"),e.xp6(2),e.Q6J("value","equipos m\xe9dicos"),e.xp6(6),e.Q6J("formControlName","type"),e.xp6(1),e.Q6J("value","empresa"),e.xp6(2),e.Q6J("value","individual"),e.xp6(6),e.Q6J("matAutosizeMinRows",1)("formControlName","address"),e.xp6(5),e.Q6J("formControlName","website")("placeholder","https://....."),e.xp6(4),e.Q6J("formControlName","active")("color","primary"),e.xp6(1),e.hij(" ",!0===t.supplierForm.get("active").value?"Activo":"Inactivo"," ")}}function vo(o,a){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",30),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).updateSupplier()}),e._uU(2," Actualizar "),e.qZA(),e.BQk()}if(2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("color","primary")("disabled",t.supplierForm.invalid)("matDialogClose","confirmed")}}function bo(o,a){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",30),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).createSupplier()}),e._uU(2," Agregar "),e.qZA(),e.BQk()}if(2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("color","primary")("disabled",t.supplierForm.invalid)("matDialogClose","confirmed")}}function ko(o,a){if(1&o&&(e.ynx(0),e.TgZ(1,"div",28),e.ynx(2),e.TgZ(3,"button",29),e._uU(4," Cancelar "),e.qZA(),e.BQk(),e.YNc(5,vo,3,3,"ng-container",6),e.YNc(6,bo,3,3,"ng-container",6),e.qZA(),e.BQk()),2&o){const t=e.oxw();e.xp6(3),e.Q6J("matDialogClose","cancelled"),e.xp6(2),e.Q6J("ngIf","edit"===t.data.dialogMode),e.xp6(1),e.Q6J("ngIf","add"===t.data.dialogMode)}}let Zo=(()=>{class o{constructor(t,i,n,s,c,l,m){this.data=t,this._changeDetectorRef=i,this._dialogRef=n,this._formBuilder=s,this._fuseConfirmationService=c,this._suppliersService=l,this.store=m,this.dialogMode="view",this.user$=(0,b.of)(null),this.user=null,this._unsubscribeAll=new w.x,this.dialogMode=t.dialogMode,this.supplier=t.supplier}ngOnInit(){this.user$=this.store.select(L.rk),this.user$.subscribe(t=>this.user=t),this.supplierForm=this._formBuilder.group({_id:[null],user:[this.user._id,[r.kI.required]],active:[!0,[r.kI.required]],name:[null,[r.kI.required,r.kI.minLength(3),r.kI.maxLength(250)]],category:[null,[r.kI.required,r.kI.minLength(3),r.kI.maxLength(250)]],type:[null,[r.kI.required,r.kI.minLength(3),r.kI.maxLength(250)]],address:[null,[r.kI.minLength(3),r.kI.maxLength(250)]],website:[null,[r.kI.minLength(3),r.kI.maxLength(250),r.kI.pattern("/^(?:(?:(?:https?|ftp):)?//)(?:S+(?::S*)?@)?(?:(?!(?:10|127)(?:.d{1,3}){3})(?!(?:169.254|192.168)(?:.d{1,3}){2})(?!172.(?:1[6-9]|2d|3[0-1])(?:.d{1,3}){2})(?:[1-9]d?|1dd|2[01]d|22[0-3])(?:.(?:1?d{1,2}|2[0-4]d|25[0-5])){2}(?:.(?:[1-9]d?|1dd|2[0-4]d|25[0-4]))|(?:(?:[a-z\xa1-\uffff0-9]-*)*[a-z\xa1-\uffff0-9]+)(?:.(?:[a-z\xa1-\uffff0-9]-*)*[a-z\xa1-\uffff0-9]+)*(?:.(?:[a-z\xa1-\uffff]{2,})))(?::d{2,5})?(?:[/?#]S*)?$/i")]]}),"edit"===this.dialogMode&&this.supplierForm.patchValue(this.supplier)}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}closeDialog(){this._dialogRef.close()}createSupplier(){let t=this.supplierForm.getRawValue();t=(0,ae.Z)(t,["_id"]),this._fuseConfirmationService.open({title:"Crear Proveedor",message:"\xbfEsta seguro que toda la informaci\xf3n es correcta?",icon:{show:!0,name:"heroicons_outline:question-mark-circle",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(n=>{"confirmed"===n&&this._suppliersService.createSupplier(t).pipe((0,d.R)(this._unsubscribeAll)).subscribe(s=>{this._fuseConfirmationService.open({title:"Confirmaci\xf3n",message:s.message,icon:{show:!0,name:"heroicons_outline:check",color:"success"},actions:{confirm:{show:!0,label:"Ok",color:"primary"},cancel:{show:!1}},dismissible:!1})},s=>{this._fuseConfirmationService.open({title:`${s.statusText}: ${s.status}`,message:s.error.message,icon:{show:!0,name:"heroicons_outline:exclamation-circle",color:"error"},actions:{confirm:{show:!0,label:"Ok",color:"primary"},cancel:{show:!1}},dismissible:!1})}),this._changeDetectorRef.markForCheck()})}updateSupplier(){const t=this.supplierForm.getRawValue();this._fuseConfirmationService.open({title:"Actualizar Proveedor",message:"\xbfEsta seguro que toda la informaci\xf3n es correcta?",icon:{show:!0,name:"heroicons_outline:question-mark-circle",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(n=>{"confirmed"===n&&this._suppliersService.updateSupplier(t).pipe((0,d.R)(this._unsubscribeAll)).subscribe(s=>{this._fuseConfirmationService.open({title:"Confirmaci\xf3n",message:s.message,icon:{show:!0,name:"heroicons_outline:check",color:"success"},actions:{confirm:{show:!0,label:"Ok",color:"primary"},cancel:{show:!1}},dismissible:!1}),this._changeDetectorRef.markForCheck()},s=>{this._fuseConfirmationService.open({title:`${s.statusText}: ${s.status}`,message:s.error.message,icon:{show:!0,name:"heroicons_outline:exclamation-circle",color:"error"},actions:{confirm:{show:!0,label:"Ok",color:"primary"},cancel:{show:!1}},dismissible:!1})}),this._changeDetectorRef.markForCheck()})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(x.WI),e.Y36(e.sBO),e.Y36(x.so),e.Y36(r.qu),e.Y36(T.R),e.Y36(_e),e.Y36(h.yh))},o.\u0275cmp=e.Xpm({type:o,selectors:[["stock-supplier-dialog"]],decls:11,vars:5,consts:[[1,"relative","flex","flex-col","w-full","max-h-screenl"],[1,"flex","flex-col","items-center","px-8","pt-4","space-y-1","text-center","sm:items-start","sm:mt-0","sm:pr-8","sm:text-left"],["class","text-2xl text-gray-400",4,"ngIf"],[1,"flex","flex-col","items-center","flex-auto","w-full","px-8","pb-6","sm:flex-row","sm:items-start","sm:pb-8"],["class","flex-auto",4,"ngIf"],["class","w-full overflow-hidden",4,"ngIf"],[4,"ngIf"],[1,"text-2xl","text-gray-400"],[1,"flex-auto"],[1,"flex"],[1,"flex","flex-col","w-full","mt-5"],[1,"flex","flex-col","p-8","pb-0","sm:flex-row"],[1,"w-full","py-10","my-10"],[1,"mb-2","font-medium"],[1,"border-sm"],[1,"w-full","overflow-hidden"],[1,"flex","flex-col"],[1,"flex","flex-col","w-full","mt-1",3,"formGroup","autocomplete"],[1,"py-5"],[1,"w-full","fuse-mat-no-subscript"],["matInput","","type","text","required","","maxlength","250",3,"formControlName","placeholder"],["required","",3,"formControlName"],[3,"value"],["matInput","","matTextareaAutosize","","maxlength","250",3,"matAutosizeMinRows","formControlName"],["matInput","","type","text","maxlength","250",3,"formControlName","placeholder"],[1,"flex","flex-col","mt-4"],[1,"mb-4","font-medium"],[3,"formControlName","color"],[1,"flex","items-center","justify-center","px-6","py-4","space-x-3","sm:justify-end","bg-gray-50","dark:bg-black","dark:bg-opacity-10"],["mat-stroked-button","",3,"matDialogClose"],["mat-flat-button","",3,"color","disabled","matDialogClose","click"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e.ynx(1),e.TgZ(2,"div",1),e.YNc(3,ho,2,0,"h2",2),e.YNc(4,fo,2,0,"h2",2),e.qZA(),e.BQk(),e.TgZ(5,"div",3),e.ynx(6),e.YNc(7,_o,9,1,"div",4),e.BQk(),e.ynx(8),e.YNc(9,xo,45,19,"div",5),e.BQk(),e.qZA(),e.YNc(10,ko,7,3,"ng-container",6),e.qZA()),2&t&&(e.xp6(3),e.Q6J("ngIf","add"===i.data.dialogMode),e.xp6(1),e.Q6J("ngIf","edit"===i.data.dialogMode),e.xp6(3),e.Q6J("ngIf","view"===i.data.dialogMode),e.xp6(2),e.Q6J("ngIf","edit"===i.data.dialogMode||"add"),e.xp6(1),e.Q6J("ngIf","view"!==i.data.dialogMode))},directives:[p.O5,r._Y,r.JL,r.sg,_.KE,_.hX,A.Nt,r.Fj,r.Q7,r.nD,r.JJ,r.u,ge.gD,H.ey,ce.Rr,y.lW,x.ZT],encapsulation:2}),o})();const Co={_id:null,user:null,active:null,name:null,category:null,type:null};function Io(o,a){1&o&&(e.ynx(0),e._UZ(1,"mat-icon",38),e.BQk()),2&o&&(e.xp6(1),e.Q6J("svgIcon","heroicons_solid:check"))}function wo(o,a){1&o&&(e.ynx(0),e._UZ(1,"mat-icon",39),e.BQk()),2&o&&(e.xp6(1),e.Q6J("svgIcon","heroicons_solid:x"))}function To(o,a){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",31)(2,"div",32),e._uU(3),e.qZA(),e.TgZ(4,"div",33)(5,"div",34),e._uU(6),e.qZA()(),e.TgZ(7,"div",35),e.YNc(8,Io,2,1,"ng-container",20),e.YNc(9,wo,2,1,"ng-container",20),e.qZA(),e.TgZ(10,"div")(11,"button",36),e.NdJ("click",function(){const s=e.CHM(t).$implicit;return e.oxw(4).updateSupplier(s)}),e._UZ(12,"mat-icon",37),e.qZA()()(),e.BQk()}if(2&o){const t=a.$implicit;e.xp6(3),e.hij(" ",t.name," "),e.xp6(3),e.Oqu(t.description),e.xp6(2),e.Q6J("ngIf",t.active),e.xp6(1),e.Q6J("ngIf",!t.active),e.xp6(3),e.Q6J("svgIcon","heroicons_solid:pencil")}}function yo(o,a){if(1&o&&(e.ynx(0),e.YNc(1,To,13,5,"ng-container",30),e.BQk()),2&o){const t=a.ngIf,i=e.oxw(3);e.xp6(1),e.Q6J("ngForOf",t)("ngForTrackBy",i.trackByFn)}}const Ao=function(o){return{"pointer-events-none":o}},So=function(){return[5,10,25,100]};function Uo(o,a){if(1&o&&(e.ynx(0),e.TgZ(1,"div",23)(2,"div",24)(3,"div",25),e._uU(4,"Nombre"),e.qZA(),e.TgZ(5,"div",26),e._uU(6," Descripci\xf3n "),e.qZA(),e.TgZ(7,"div",27),e._uU(8," Activo "),e.qZA(),e.TgZ(9,"div",28),e._uU(10,"Detalles"),e.qZA()(),e.YNc(11,yo,2,2,"ng-container",20),e.ALo(12,"async"),e.qZA(),e._UZ(13,"mat-paginator",29),e.BQk()),2&o){const t=e.oxw(2);e.xp6(3),e.Q6J("mat-sort-header","name"),e.xp6(4),e.Q6J("mat-sort-header","active"),e.xp6(4),e.Q6J("ngIf",e.lcZ(12,9,t.suppliers$)),e.xp6(2),e.Q6J("ngClass",e.VKq(11,Ao,t.isLoading))("length",t.pagination.length)("pageIndex",t.pagination.page)("pageSize",t.pagination.size)("pageSizeOptions",e.DdM(13,So))("showFirstLastButtons",!0)}}function qo(o,a){if(1&o&&(e.ynx(0),e.YNc(1,Uo,14,14,"ng-container",22),e.BQk()),2&o){const t=a.ngIf;e.oxw();const i=e.MAs(31);e.xp6(1),e.Q6J("ngIf",t.length>0)("ngIfElse",i)}}function Qo(o,a){1&o&&(e.TgZ(0,"div",40),e._uU(1,"\xa1No se ha creado ning\xfan proveedor!"),e.qZA())}let Fo=(()=>{class o{constructor(t,i,n,s,c){this._suppliersService=t,this._changeDetectorRef=i,this._dialog=n,this._fuseConfirmationService=s,this.store=c,this.flashMessage=null,this.suppliers$=(0,b.of)([]),this.merchantInputControl=new r.NI,this.isLoading=!1,this.searchInputControl=new r.NI,this._unsubscribeAll=new w.x}ngOnInit(){this.suppliers$=this.store.select(R),this.store.select(ie.B).pipe((0,d.R)(this._unsubscribeAll)).subscribe(t=>{this.pagination=t,this._changeDetectorRef.markForCheck()}),this.searchInputControl.valueChanges.pipe((0,d.R)(this._unsubscribeAll),(0,J.b)(300),(0,g.w)(t=>(this.isLoading=!0,this._suppliersService.getSuppliers(0,10,"name","asc",t))),(0,f.U)(()=>{this.isLoading=!1})).subscribe()}ngAfterViewInit(){this._sort&&this._paginator&&(this._sort.sort({id:"name",start:"asc",disableClear:!0}),this._changeDetectorRef.markForCheck(),this._sort.sortChange.pipe((0,d.R)(this._unsubscribeAll)).subscribe(()=>{this._paginator.pageIndex=0}),(0,ee.T)(this._sort.sortChange,this._paginator.page).pipe((0,g.w)(()=>(this.isLoading=!0,this._suppliersService.getSuppliers(this._paginator.pageIndex,this._paginator.pageSize,this._sort.active,this._sort.direction))),(0,f.U)(()=>{this.isLoading=!1})).subscribe())}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}createSupplier(){this._openDialog(Co,"add")}updateSupplier(t){this._openDialog(t,"edit")}trackByFn(t,i){return t||i.id}_openDialog(t,i){this._dialog.open(Zo,{data:{supplier:t,dialogMode:i},panelClass:"ath-dialog-panel"})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(_e),e.Y36(e.sBO),e.Y36(x.uw),e.Y36(T.R),e.Y36(h.yh))},o.\u0275cmp=e.Xpm({type:o,selectors:[["stock-suppliers"]],viewQuery:function(t,i){if(1&t&&(e.Gf(F.NW,5),e.Gf(k.YE,5)),2&t){let n;e.iGM(n=e.CRH())&&(i._paginator=n.first),e.iGM(n=e.CRH())&&(i._sort=n.first)}},decls:32,vars:10,consts:[[1,"flex","flex-col","flex-auto","min-w-0","sm:absolute","sm:inset-0","sm:overflow-hidden","bg-card","dark:bg-transparent"],[1,"relative","flex","flex-col","px-6","py-8","border-b","sm:flex-row","flex-0","sm:items-center","sm:justify-between","md:px-8"],[1,"flex-1","min-w-0"],[1,"flex","flex-wrap","items-center","font-medium"],["routerLink","/home",1,"whitespace-nowrap","text-primary-500"],[1,"flex","items-center","ml-1","whitespace-nowrap"],[1,"icon-size-5","text-secondary",3,"svgIcon"],["routerLink","/stock/panels",1,"ml-1","text-primary-500"],[1,"ml-1","text-primary-500"],[1,"mt-2"],[1,"text-3xl","font-extrabold","leading-7","tracking-tight","truncate","md:text-4xl","sm:leading-10"],[1,"flex","items-center","mt-6","shrink-0","sm:mt-0","sm:ml-4"],[1,"mr-4","fuse-mat-dense","fuse-mat-no-subscript","fuse-mat-rounded","min-w-64"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"formControl","autocomplete","placeholder"],["mat-raised-button","",1,"bg-gradient-to-r","from-primary-500","to-primary-600","text-white",3,"click"],[3,"svgIcon"],[1,"ml-2","mr-1","text-white","hidden","sm:block"],[1,"flex","flex-auto","overflow-hidden"],[1,"flex","flex-col","flex-auto","overflow-hidden","sm:mb-18","sm:overflow-y-auto"],[4,"ngIf"],["noSuppliers",""],[4,"ngIf","ngIfElse"],[1,"grid"],["matSort","","matSortDisableClear","",1,"sticky","top-0","z-10","grid","gap-4","px-6","py-4","font-semibold","shadow","suppliers-grid","md:px-8","text-md","text-secondary","bg-gray-50","dark:bg-black","dark:bg-opacity-5"],[3,"mat-sort-header"],[1,"hidden","md:block"],[1,"hidden","lg:block",3,"mat-sort-header"],[1,"hidden","sm:block"],[1,"z-10","border-b","sm:absolute","sm:inset-x-0","sm:bottom-0","sm:border-t","sm:border-b-0","bg-gray-50","dark:bg-transparent",3,"ngClass","length","pageIndex","pageSize","pageSizeOptions","showFirstLastButtons"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"grid","items-center","gap-4","px-6","py-3","border-b","suppliers-grid","md:px-8"],[1,"truncate"],[1,"items-center","hidden","lg:flex"],[1,"min-w-4"],[1,"hidden","lg:block"],["mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"click"],[1,"icon-size-5",3,"svgIcon"],[1,"text-green-400","icon-size-5",3,"svgIcon"],[1,"text-gray-400","icon-size-5",3,"svgIcon"],[1,"p-8","text-4xl","font-semibold","tracking-tight","text-center","border-t","sm:p-16"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div")(5,"a",4),e._uU(6,"Inicio"),e.qZA()(),e.TgZ(7,"div",5),e._UZ(8,"mat-icon",6),e.TgZ(9,"a",7),e._uU(10,"Inventario"),e.qZA()(),e.TgZ(11,"div",5),e._UZ(12,"mat-icon",6),e.TgZ(13,"a",8),e._uU(14,"Proveedores"),e.qZA()()(),e.TgZ(15,"div",9)(16,"h2",10),e._uU(17," Proveedores "),e.qZA()()(),e.TgZ(18,"div",11)(19,"mat-form-field",12),e._UZ(20,"mat-icon",13)(21,"input",14),e.qZA(),e.TgZ(22,"button",15),e.NdJ("click",function(){return i.createSupplier()}),e._UZ(23,"mat-icon",16),e.TgZ(24,"span",17),e._uU(25,"Agregar"),e.qZA()()()(),e.TgZ(26,"div",18)(27,"div",19),e.YNc(28,qo,2,2,"ng-container",20),e.ALo(29,"async"),e.YNc(30,Qo,2,0,"ng-template",null,21,e.W1O),e.qZA()()()),2&t&&(e.xp6(8),e.Q6J("svgIcon","heroicons_solid:chevron-right"),e.xp6(4),e.Q6J("svgIcon","heroicons_solid:chevron-right"),e.xp6(8),e.Q6J("svgIcon","heroicons_solid:search"),e.xp6(1),e.Q6J("formControl",i.searchInputControl)("autocomplete","off")("placeholder","Buscar proveedores"),e.xp6(2),e.Q6J("svgIcon","heroicons_outline:plus"),e.xp6(5),e.Q6J("ngIf",e.lcZ(29,8,i.suppliers$)))},directives:[C.yS,Q.Hw,_.KE,_.qo,A.Nt,r.Fj,r.JJ,r.oH,y.lW,p.O5,k.YE,k.nU,p.sg,F.NW,p.mk],pipes:[p.Ov],styles:[".suppliers-grid{grid-template-columns:auto 40px}@media (min-width: 600px){.suppliers-grid{grid-template-columns:auto 112px 72px}}@media (min-width: 960px){.suppliers-grid{grid-template-columns:112px auto 112px 72px}}@media (min-width: 1280px){.suppliers-grid{grid-template-columns:auto 250px 150px 72px 72px}}\n"],encapsulation:2,data:{animation:E.L},changeDetection:0}),o})(),Se=(()=>{class o{constructor(t){this._categoriesService=t}resolve(t,i){return this._categoriesService.getCategoriesByBusiness("000000000000000000000000")}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(ue))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();const No={_id:null,user:null,active:!0,category:"",name:"",description:"",guaranty:"",tags:[],sku:"",barcode:"",brand:"",supplier:"",uom:"",currency:"",stock:0,onSale:0,cost:0,discount:0,taxPercent:0,price:0,weight:0,thumbnail:"",images:[],cumRatePoints:0,rates:0,comments:[],salesQty:0};var Jo=u(7231),Do=u(393);function Po(o,a){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",59),e.NdJ("click",function(){return e.CHM(t),e.oxw().createProduct()}),e._UZ(2,"mat-icon",60),e.TgZ(3,"span",61),e._uU(4,"Guardar"),e.qZA()(),e.BQk()}2&o&&(e.xp6(2),e.Q6J("svgIcon","heroicons_outline:save"))}function Bo(o,a){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",59),e.NdJ("click",function(){return e.CHM(t),e.oxw().updateProduct()}),e._UZ(2,"mat-icon",60),e.TgZ(3,"span",61),e._uU(4,"Actualizar"),e.qZA()(),e.BQk()}2&o&&(e.xp6(2),e.Q6J("svgIcon","heroicons_outline:refresh"))}function Ro(o,a){if(1&o&&(e.ynx(0),e.TgZ(1,"mat-option",62),e._uU(2),e.qZA(),e.BQk()),2&o){const t=a.$implicit;e.xp6(1),e.Q6J("value",t._id),e.xp6(1),e.hij(" ",t.name," ")}}function Lo(o,a){if(1&o&&(e.ynx(0),e.TgZ(1,"mat-option",62),e._uU(2),e.qZA(),e.BQk()),2&o){const t=a.$implicit;e.xp6(1),e.Q6J("value",t._id),e.xp6(1),e.hij(" ",t.name," ")}}function Yo(o,a){if(1&o&&(e.ynx(0),e.TgZ(1,"mat-option",62),e._uU(2),e.qZA(),e.BQk()),2&o){const t=a.$implicit;e.xp6(1),e.Q6J("value",t._id),e.xp6(1),e.hij(" ",t.name," ")}}function Mo(o,a){1&o&&e._UZ(0,"mat-icon",29),2&o&&e.Q6J("svgIcon","heroicons_solid:pencil-alt")}function $o(o,a){1&o&&e._UZ(0,"mat-icon",29),2&o&&e.Q6J("svgIcon","heroicons_solid:check")}function Eo(o,a){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"mat-checkbox",64),e.NdJ("change",function(n){const c=e.CHM(t).$implicit;return e.oxw(2).toggleProductTag(c,n)}),e._uU(2),e.qZA(),e.BQk()}if(2&o){const t=a.$implicit,i=e.oxw(2);e.xp6(1),e.Q6J("color","primary")("checked",i.selectedProduct.tags.includes(t._id)),e.xp6(1),e.hij(" ",t.name," ")}}function Oo(o,a){if(1&o&&(e.ynx(0),e.YNc(1,Eo,3,3,"ng-container",63),e.BQk()),2&o){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.filteredTags)("ngForTrackBy",t.trackByFn)}}function zo(o,a){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"mat-form-field",66)(2,"input",67),e.NdJ("input",function(n){const c=e.CHM(t).$implicit;return e.oxw(2).updateTagName(c,n)}),e.qZA(),e.TgZ(3,"button",68),e.NdJ("click",function(){const s=e.CHM(t).$implicit;return e.oxw(2).deleteTag(s)}),e._UZ(4,"mat-icon",29),e.qZA()(),e.BQk()}if(2&o){const t=a.$implicit;e.xp6(2),e.Q6J("value",t.name),e.xp6(2),e.Q6J("svgIcon","heroicons_solid:trash")}}function jo(o,a){if(1&o&&(e.ynx(0),e.TgZ(1,"div",65),e.YNc(2,zo,5,2,"ng-container",63),e.qZA(),e.BQk()),2&o){const t=e.oxw();e.xp6(2),e.Q6J("ngForOf",t.filteredTags)("ngForTrackBy",t.trackByFn)}}function Wo(o,a){if(1&o){const t=e.EpF();e.TgZ(0,"div",69),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(),s=e.MAs(65);return n.createTag(s.value),s.value=""}),e._UZ(1,"mat-icon",70),e.TgZ(2,"div",71),e._uU(3,'Crear "'),e.TgZ(4,"b"),e._uU(5),e.qZA(),e._uU(6,'"'),e.qZA()()}if(2&o){e.oxw();const t=e.MAs(65);e.xp6(1),e.Q6J("svgIcon","heroicons_solid:plus-circle"),e.xp6(4),e.Oqu(t.value)}}function Go(o,a){if(1&o&&(e.ynx(0),e.TgZ(1,"mat-option",62),e._uU(2),e.qZA(),e.BQk()),2&o){const t=a.$implicit;e.xp6(1),e.Q6J("value",t._id),e.xp6(1),e.hij(" ",t.abbr," ")}}function Vo(o,a){if(1&o&&e._UZ(0,"img",72),2&o){const t=e.oxw();e.Q6J("alt","Product thumbnail image")("src",t.thumbnail,e.LSH)}}function Ho(o,a){if(1&o){const t=e.EpF();e.TgZ(0,"button",73),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return n.removeFile(n.thumbnail,"thumbnail")}),e._UZ(1,"mat-icon",74),e.qZA()}}function Xo(o,a){1&o&&(e.TgZ(0,"div",75),e._uU(1," SIN IMAGEN "),e.qZA())}function Ko(o,a){if(1&o){const t=e.EpF();e.TgZ(0,"div")(1,"input",54,55),e.NdJ("change",function(n){return e.CHM(t),e.oxw().selectFiles(n,"thumbnail")}),e.qZA(),e.TgZ(3,"label",56)(4,"div",57),e._UZ(5,"mat-icon",29),e.TgZ(6,"span",58),e._uU(7," Agregar imagen principal "),e.qZA()()()()}2&o&&(e.xp6(1),e.Q6J("multiple",!1)("accept","image/jpeg, image/jpg, image/webp, image/png"),e.xp6(4),e.Q6J("svgIcon","heroicons_solid:plus-circle"))}function ei(o,a){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",47)(2,"div",48),e._UZ(3,"img",72),e.TgZ(4,"button",73),e.NdJ("click",function(){const s=e.CHM(t).$implicit;return e.oxw().removeFile(s,"images")}),e._UZ(5,"mat-icon",74),e.qZA()()(),e.BQk()}if(2&o){const t=a.$implicit;e.xp6(3),e.Q6J("alt","Product images")("src",t,e.LSH)}}const ti=[{path:"",pathMatch:"full",redirectTo:"panels"},{path:"panels",component:qe,children:[{path:"",component:Fe},{path:"products",component:Ne,children:[{path:"",component:He,resolve:{products:we}}]},{path:"product/:productId",component:(()=>{class o{constructor(t,i,n,s,c,l,m,Z,P){this._activatedRoute=t,this._categoriesService=i,this._changeDetectorRef=n,this._formBuilder=s,this._fuseConfirmationService=c,this._productsService=l,this._router=m,this._imagesService=Z,this.store=P,this.categories=[],this.editMode=!1,this.flashMessage=null,this.images=[],this.isLoading=!1,this.productId=null,this.products$=(0,b.of)([]),this.searchInputControl=new r.NI,this.selectedProduct=No,this.suppliers$=(0,b.of)(null),this.tagsEditMode=!1,this.uoms=[],this.uoms$=(0,b.of)(null),this.user=null,this.user$=(0,b.of)(null),this.thumbnail="",this._unsubscribeAll=new w.x}ngOnInit(){this._activatedRoute.params.pipe((0,d.R)(this._unsubscribeAll)).subscribe(({productId:t})=>{this.productId=t,"new"!==this.productId&&(this.editMode=!0,this._productsService.getProductById(t).pipe((0,d.R)(this._unsubscribeAll)).subscribe(i=>{this.selectedProduct=i,this.productForm.patchValue(this.selectedProduct),this.productForm.get("category").patchValue(this.selectedProduct.category),i.thumbnail&&(this.thumbnail=i.thumbnail),this.images=this.selectedProduct.images})),this._changeDetectorRef.markForCheck()}),this.user$=this.store.select(L.rk),this.user$.subscribe(t=>this.user=t),this.uoms$=this.store.select(Y),this.uoms$.pipe((0,d.R)(this._unsubscribeAll)).subscribe(t=>{this.uoms=t,this._changeDetectorRef.markForCheck()}),this.suppliers$=this.store.select(R),this.suppliers$.pipe((0,d.R)(this._unsubscribeAll)).subscribe(t=>{this.suppliers=t,this._changeDetectorRef.markForCheck()}),this.store.select(B).pipe((0,d.R)(this._unsubscribeAll)).subscribe(t=>{this.brands=t,this._changeDetectorRef.markForCheck()}),this.store.select(te).pipe((0,d.R)(this._unsubscribeAll)).subscribe(t=>{this.categories=t,this._changeDetectorRef.markForCheck()}),this._productsService.tags$.pipe((0,d.R)(this._unsubscribeAll)).subscribe(t=>{this.tags=t,this.filteredTags=t,this._changeDetectorRef.markForCheck()}),this.productForm=this._formBuilder.group({_id:[""],user:[this.user._id,[r.kI.required]],category:["",[r.kI.required]],name:["",[r.kI.required,r.kI.maxLength(255)]],description:["",[r.kI.maxLength(255)]],tags:[[""]],sku:["",[r.kI.maxLength(50)]],barcode:["",[r.kI.maxLength(50)]],brand:["",[r.kI.required]],supplier:["",[r.kI.required]],uom:["",[r.kI.required]],currency:[{disabled:!0,value:"usd"},[r.kI.required]],stock:[0,[r.kI.required,r.kI.min(0),r.kI.max(999999999),r.kI.maxLength(9)]],onSale:[0,[r.kI.min(0),r.kI.max(999999999),r.kI.maxLength(9)]],cost:[0,[r.kI.min(0),r.kI.max(999999999),r.kI.maxLength(9),r.kI.pattern("[0-9.]+(.[0-9]{2})?")]],basePrice:[0,[r.kI.min(0),r.kI.max(999999999),r.kI.maxLength(9),r.kI.pattern("[0-9.]+(.[0-9]{2})?")]],taxPercent:[0,[r.kI.min(0),r.kI.max(999999999),r.kI.maxLength(9)]],price:[0,[r.kI.required,r.kI.min(0),r.kI.max(999999999),r.kI.maxLength(9),r.kI.pattern("[0-9.]+(.[0-9]{2})?")]],weight:[0,[r.kI.required,r.kI.min(0),r.kI.max(999999999),r.kI.maxLength(9)]],volume:[0,[r.kI.min(0),r.kI.max(999999999),r.kI.maxLength(9)]],size:["",[r.kI.maxLength(9)]],thumbnail:[""],images:[[]],currentImageIndex:[0],active:[!0,[r.kI.required]]},{validators:this._checkOnSaleQty("stock","onSale")}),this.productForm.get("thumbnail").valueChanges.pipe((0,d.R)(this._unsubscribeAll)).subscribe(t=>this.thumbnail=t),this.productForm.get("images").valueChanges.pipe((0,d.R)(this._unsubscribeAll)).subscribe(t=>this.images=t)}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}cycleImages(t=!0){const i=this.productForm.get("images").value.length,n=this.productForm.get("currentImageIndex").value,s=n+1===i?0:n+1,c=n-1<0?i-1:n-1;t?this.productForm.get("currentImageIndex").setValue(s):this.productForm.get("currentImageIndex").setValue(c)}toggleTagsEditMode(){this.tagsEditMode=!this.tagsEditMode}filterTags(t){const i=t.target.value.toLowerCase();this.filteredTags=this.tags.filter(n=>n.name.toLowerCase().includes(i))}filterTagsInputKeyDown(t){if("Enter"!==t.key)return;if(0===this.filteredTags.length)return this.createTag(t.target.value),void(t.target.value="");const i=this.filteredTags[0];this.selectedProduct.tags.find(s=>s===i._id)?this.removeTagFromProduct(i):this.addTagToProduct(i)}createTag(t){this._productsService.createTag({active:!0,user:this.user._id,name:t}).subscribe(n=>{this.addTagToProduct(n)})}updateTagName(t,i){t.name=i.target.value,this._productsService.updateTag(t).pipe((0,J.b)(300)).subscribe(),this._changeDetectorRef.markForCheck()}deleteTag(t){this._productsService.deleteTag(t._id).subscribe(),this._changeDetectorRef.markForCheck()}addTagToProduct(t){const i=(0,N.cloneDeep)(this.selectedProduct);i.tags.unshift(t._id),this.productForm.get("tags").patchValue(i.tags),this._changeDetectorRef.markForCheck()}removeTagFromProduct(t){const i=this.productForm.getRawValue();i.tags.splice(i.tags.findIndex(n=>n===t._id),1),this.productForm.get("tags").patchValue(i.tags),this._changeDetectorRef.markForCheck()}toggleProductTag(t,i){i.checked?this.addTagToProduct(t):this.removeTagFromProduct(t)}shouldShowCreateTagButton(t){return!(""===t||this.tags.findIndex(i=>i.name.toLowerCase()===t.toLowerCase())>-1)}createProduct(){let t=this.productForm.getRawValue();t=(0,N.omit)(t,["_id","currentImageIndex"]),this._fuseConfirmationService.open({title:"Crear Producto",message:"\xbfEsta seguro que toda la informaci\xf3n es correcta?",icon:{show:!0,name:"heroicons_outline:question-mark-circle",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(n=>{"confirmed"===n&&this._productsService.createProduct(t).pipe((0,d.R)(this._unsubscribeAll)).subscribe(s=>{this._router.navigateByUrl("/stock/panels/products"),this._fuseConfirmationService.open({title:"Confirmaci\xf3n",message:s.message,icon:{show:!0,name:"heroicons_outline:check",color:"success"},actions:{confirm:{show:!0,label:"Ok",color:"primary"},cancel:{show:!1}},dismissible:!1})},s=>{this._fuseConfirmationService.open({title:`${s.statusText}: ${s.status}`,message:s.error.message,icon:{show:!0,name:"heroicons_outline:exclamation-circle",color:"error"},actions:{confirm:{show:!0,label:"Ok",color:"primary"},cancel:{show:!1}},dismissible:!1})}),this._changeDetectorRef.markForCheck()})}updateProduct(){let t=this.productForm.getRawValue();t=(0,N.omit)(t,["currentImageIndex"]),this._fuseConfirmationService.open({title:"Actualizar Producto",message:"\xbfEsta seguro que toda la informaci\xf3n es correcta?",icon:{show:!0,name:"heroicons_outline:question-mark-circle",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(n=>{"confirmed"===n&&this._productsService.updateProduct(t).pipe((0,d.R)(this._unsubscribeAll)).subscribe(s=>{this._router.navigateByUrl("/stock/panels/products"),this._fuseConfirmationService.open({title:"Confirmaci\xf3n",message:s.message,icon:{show:!0,name:"heroicons_outline:check",color:"success"},actions:{confirm:{show:!0,label:"Ok",color:"primary"},cancel:{show:!1}},dismissible:!1})},s=>{this._fuseConfirmationService.open({title:`${s.statusText}: ${s.status}`,message:s.error.message,icon:{show:!0,name:"heroicons_outline:exclamation-circle",color:"error"},actions:{confirm:{show:!0,label:"Ok",color:"primary"},cancel:{show:!1}},dismissible:!1})}),this._changeDetectorRef.markForCheck()})}showFlashMessage(t){this.flashMessage=t,this._changeDetectorRef.markForCheck(),setTimeout(()=>{this.flashMessage=null,this._changeDetectorRef.markForCheck()},3e3)}selectFiles(t,i){if(0!==t.target.files.length){this.selectedFiles=t.target.files;for(const n of t.target.files)this._uploadFile(n,i)}}removeFile(t,i){void 0!==t&&this._imagesService.removeImage(t).pipe((0,d.R)(this._unsubscribeAll)).subscribe(()=>{if("thumbnail"===i&&this.productForm.get("thumbnail").reset(),"images"===i){const n=[...this.productForm.get("images").value],s=n.findIndex(c=>c===t);n.splice(s,1),this.productForm.get("images").setValue(n)}this._productsService.updateProduct(this.productForm.getRawValue()).subscribe(n=>{this._fuseConfirmationService.open({title:"Confirmaci\xf3n",message:"Imagen eliminada correctamente",icon:{show:!0,name:"heroicons_outline:check",color:"success"},actions:{confirm:{show:!0,label:"Ok",color:"primary"},cancel:{show:!1}},dismissible:!1})},n=>{this._fuseConfirmationService.open({title:`${n.statusText}: ${n.status}`,message:n.error.message,icon:{show:!0,name:"heroicons_outline:exclamation-circle",color:"error"},actions:{confirm:{show:!0,label:"Ok",color:"primary"},cancel:{show:!1}},dismissible:!1})}),this._changeDetectorRef.markForCheck()},n=>{this._fuseConfirmationService.open({title:`${n.statusText}: ${n.status}`,message:"No se han podido eliminar la imagen del servidor,\n                        int\xe9ntelo nuevamente si el error persistes contacte con el personal de soporte.",icon:{show:!0,name:"heroicons_outline:exclamation-circle",color:"error"},actions:{confirm:{show:!0,label:"Ok",color:"primary"},cancel:{show:!1}},dismissible:!1})})}_uploadFile(t,i){this._imagesService.uploadImage("products",t).pipe((0,d.R)(this._unsubscribeAll)).subscribe(n=>{if("thumbnail"===i&&this.productForm.get("thumbnail").setValue(n.imageUrl),"images"===i){const s=[...this.productForm.get("images").value,n.imageUrl];this.productForm.get("images").setValue(s)}this.editMode&&this._productsService.updateProduct(this.productForm.getRawValue()).subscribe(()=>{this._fuseConfirmationService.open({title:"Confirmaci\xf3n",message:"Imagen guardada correctamente",icon:{show:!0,name:"heroicons_outline:check",color:"success"},actions:{confirm:{show:!0,label:"Ok",color:"primary"},cancel:{show:!1}},dismissible:!1})},s=>{this._fuseConfirmationService.open({title:`${s.statusText}: ${s.status}`,message:s.error.message,icon:{show:!0,name:"heroicons_outline:exclamation-circle",color:"error"},actions:{confirm:{show:!0,label:"Ok",color:"primary"},cancel:{show:!1}},dismissible:!1})}),this._changeDetectorRef.markForCheck()},n=>{this._fuseConfirmationService.open({title:`${n.statusText}: ${n.status}`,message:"No se han podido guardar la im\xe1genes en el servidor,\n                            int\xe9ntelo nuevamente si el error persistes contacte con el personal de soporte.",icon:{show:!0,name:"heroicons_outline:exclamation-circle",color:"error"},actions:{confirm:{show:!0,label:"Ok",color:"primary"},cancel:{show:!1}},dismissible:!1})})}_checkOnSaleQty(t,i){return n=>{const s=n.get(t),c=n.get(i);if(!s||!c||(c.hasError("invalid")&&(delete c.errors.invalid,c.updateValueAndValidity()),s.value<=c.value))return null;const l={invalid:"La cantidad en venta no debe ser mayor a la disponible"};return c.setErrors(l),l}}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(C.gz),e.Y36(ue),e.Y36(e.sBO),e.Y36(r.qu),e.Y36(T.R),e.Y36(se),e.Y36(C.F0),e.Y36(Jo.C),e.Y36(h.yh))},o.\u0275cmp=e.Xpm({type:o,selectors:[["stock-product-detail"]],decls:185,vars:44,consts:[[1,"flex","flex-col","flex-auto","min-w-0","sm:absolute","sm:inset-0","sm:overflow-hidden","bg-card","dark:bg-transparent"],[1,"flex","flex-col","sm:flex-row","flex-0","sm:items-center","sm:justify-between","p-6","sm:py-8","sm:px-10","border-b","bg-card","z-20","dark:bg-transparent"],[1,"flex-1","min-w-0"],[1,"hidden","sm:flex","flex-wrap","items-center","font-medium"],["routerLink","/home",1,"whitespace-nowrap","text-primary-500"],[1,"flex","items-center","ml-1","whitespace-nowrap"],[1,"icon-size-5","text-secondary",3,"svgIcon"],["routerLink","/stock/panels",1,"ml-1","text-primary-500"],["routerLink","/stock/panels/products",1,"ml-1","text-primary-500"],[1,"ml-1","text-primary-500"],[1,"mt-2"],[1,"text-3xl","font-extrabold","leading-7","tracking-tight","truncate","md:text-4xl","sm:leading-10"],[1,"flex","shrink-0","items-center","mt-6","sm:mt-0","sm:ml-4"],[4,"ngIf"],["cdkScrollable","",1,"flex","flex-auto","overflow-y-auto"],[1,"flex","flex-col","w-full","divide-y","divide-dashed",3,"formGroup","autocomplete"],[1,"grid","grid-cols-1","md:grid-cols-2","p-10"],[1,"flex","flex-col"],[1,"text-xl","font-semibold"],[1,"flex","flex-col","bg-card","rounded-2xl","shadow-md","w-full","p-6","border"],[1,"w-full"],["matInput","","type","text","maxlength","250","required","",3,"formControlName"],["matInput","","matTextareaAutosize","","maxlength","250",3,"formControlName"],[3,"formControlName"],[4,"ngFor","ngForOf"],[1,"mb-px","font-medium","leading-tight"],[1,"mt-1.5","rounded-md","border","border-gray-300","dark:border-gray-500","shadow-sm","overflow-hidden"],[1,"flex","items-center","px-3","py-2","-my-px"],[1,"flex","items-center","flex-auto","min-w-0"],[1,"icon-size-5",3,"svgIcon"],["type","text","placeholder","Buscar",1,"min-w-0","py-1","ml-2","border-0",3,"maxLength","input","keydown"],["newTagInput",""],["mat-icon-button","",1,"w-8","h-8","ml-3","min-h-8",3,"click"],["class","icon-size-5",3,"svgIcon",4,"ngIf"],[1,"overflow-y-auto","leading-none","border-t","border-gray-300","h-44","dark:border-gray-500"],["class","flex items-center h-10 min-h-10 -ml-0.5 pl-4 pr-3 leading-none cursor-pointer border-t hover:bg-gray-50 dark:hover:bg-hover","matRipple","",3,"click",4,"ngIf"],["value","usd"],["matPrefix",""],["matInput","","type","number","min","0","max","999999999","maxlength","9","required","",3,"formControlName"],["matSuffix",""],["type","number","matInput","","min","0","max","999999999","maxlength","9","required","",3,"formControlName"],["matInput","","type","number","min","0","max","999999999","maxlength","50",3,"formControlName"],["matInput","","type","text","maxlength","50",3,"formControlName"],["matInput","","type","number","min","0","max","999999999","maxlength","9",3,"formControlName"],["matInput","","type","number","maxlength","9",3,"formControlName"],[1,"flex","flex-col","bg-card","rounded-2xl","shadow-md","w-full","p-6","border","divide-y","gap-y-6"],[1,"font-medium"],[1,"flex","items-center","mt-3"],[1,"relative","flex","items-center","justify-center","w-26","h-26","mr-6","overflow-hidden","border","rounded","flex-0"],[3,"alt","src",4,"ngIf"],["mat-mini-fab","","class","absolute p-5 bg-primary-700 rounded-full opacity-50 hover:opacity-100 transition-opacity ease-linear delay-200",3,"click",4,"ngIf"],["class","flex items-center justify-center w-full h-full text-xs font-semibold leading-none text-center uppercase",4,"ngIf"],[1,"flex","flex-col","pt-6"],[1,"flex","flex-row","flex-wrap"],["id","image-file-input","type","file",1,"absolute","invisible","w-0","h-0","opacity-0","pointer-events-none",3,"multiple","accept","change"],["imageFileInput",""],["for","image-file-input","matRipple",""],[1,"inline-flex","items-center","px-4","py-2","mt-2","-ml-4","rounded","cursor-pointer","group"],[1,"ml-2","font-medium","text-secondary","group-hover:underline"],["mat-raised-button","",1,"bg-gradient-to-r","from-primary-500","to-primary-600","text-white",3,"click"],[3,"svgIcon"],[1,"ml-2","mr-1","text-white","hidden","sm:block"],[3,"value"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"flex","items-center","h-10","px-4","min-h-10",3,"color","checked","change"],[1,"p-4","space-y-2"],[1,"w-full","fuse-mat-dense","fuse-mat-no-subscript"],["matInput","",3,"value","input"],["mat-icon-button","","matSuffix","",3,"click"],["matRipple","",1,"flex","items-center","h-10","min-h-10","-ml-0.5","pl-4","pr-3","leading-none","cursor-pointer","border-t","hover:bg-gray-50","dark:hover:bg-hover",3,"click"],[1,"mr-2","icon-size-5",3,"svgIcon"],[1,"break-all"],[3,"alt","src"],["mat-mini-fab","",1,"absolute","p-5","bg-primary-700","rounded-full","opacity-50","hover:opacity-100","transition-opacity","ease-linear","delay-200",3,"click"],["svgIcon","heroicons_solid:trash",1,"text-white","icon-size-5"],[1,"flex","items-center","justify-center","w-full","h-full","text-xs","font-semibold","leading-none","text-center","uppercase"]],template:function(t,i){if(1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div")(4,"div",3)(5,"div")(6,"a",4),e._uU(7,"Inicio"),e.qZA()(),e.TgZ(8,"div",5),e._UZ(9,"mat-icon",6),e.TgZ(10,"a",7),e._uU(11,"Inventario"),e.qZA()(),e.TgZ(12,"div",5),e._UZ(13,"mat-icon",6),e.TgZ(14,"a",8),e._uU(15,"Productos"),e.qZA()(),e.TgZ(16,"div",5),e._UZ(17,"mat-icon",6),e.TgZ(18,"a",9),e._uU(19,"Nombre del producto"),e.qZA()()()(),e.TgZ(20,"div",10)(21,"h2",11),e._uU(22," Nombre del producto "),e.qZA()()(),e.TgZ(23,"div",12),e.YNc(24,Po,5,1,"ng-container",13),e.YNc(25,Bo,5,1,"ng-container",13),e.qZA()(),e.TgZ(26,"div",14)(27,"form",15)(28,"div",16)(29,"div",17)(30,"span",18),e._uU(31,"Descripci\xf3n"),e.qZA(),e.TgZ(32,"span"),e._uU(33,"Ingrese la informaci\xf3n necesaria para describir e identificar el producto"),e.qZA()(),e.TgZ(34,"div",19)(35,"mat-form-field",20)(36,"mat-label"),e._uU(37,"Nombre"),e.qZA(),e._UZ(38,"input",21),e.qZA(),e.TgZ(39,"mat-form-field",20)(40,"mat-label"),e._uU(41,"Descripci\xf3n"),e.qZA(),e._UZ(42,"textarea",22),e.qZA(),e.TgZ(43,"mat-form-field",20)(44,"mat-label"),e._uU(45,"Categor\xeda"),e.qZA(),e.TgZ(46,"mat-select",23),e.YNc(47,Ro,3,2,"ng-container",24),e.qZA()(),e.TgZ(48,"mat-form-field",20)(49,"mat-label"),e._uU(50,"Marca"),e.qZA(),e.TgZ(51,"mat-select",23),e.YNc(52,Lo,3,2,"ng-container",24),e.qZA()(),e.TgZ(53,"mat-form-field",20)(54,"mat-label"),e._uU(55,"Proveedor"),e.qZA(),e.TgZ(56,"mat-select",23),e.YNc(57,Yo,3,2,"ng-container",24),e.qZA()(),e.TgZ(58,"span",25),e._uU(59,"Etiquetas"),e.qZA(),e.TgZ(60,"div",26)(61,"div",27)(62,"div",28),e._UZ(63,"mat-icon",29),e.TgZ(64,"input",30,31),e.NdJ("input",function(s){return i.filterTags(s)})("keydown",function(s){return i.filterTagsInputKeyDown(s)}),e.qZA()(),e.TgZ(66,"button",32),e.NdJ("click",function(){return i.toggleTagsEditMode()}),e.YNc(67,Mo,1,1,"mat-icon",33),e.YNc(68,$o,1,1,"mat-icon",33),e.qZA()(),e.TgZ(69,"div",34),e.YNc(70,Oo,2,2,"ng-container",13),e.YNc(71,jo,3,2,"ng-container",13),e.YNc(72,Wo,7,2,"div",35),e.qZA()()()(),e.TgZ(73,"div",16)(74,"div",17)(75,"span",18),e._uU(76,"Valores"),e.qZA(),e.TgZ(77,"span"),e._uU(78,"Ingrese los precios, costes e impuestos del producto"),e.qZA()(),e.TgZ(79,"div",19)(80,"mat-form-field",20)(81,"mat-label"),e._uU(82,"Moneda"),e.qZA(),e.TgZ(83,"mat-select",23)(84,"mat-option",36),e._uU(85,"USD"),e.qZA()()(),e.TgZ(86,"mat-form-field",20)(87,"mat-label"),e._uU(88,"Costo"),e.qZA(),e.TgZ(89,"span",37),e._uU(90,"$"),e.qZA(),e._UZ(91,"input",38),e.qZA(),e.TgZ(92,"mat-form-field",20)(93,"mat-label"),e._uU(94,"Precio Base"),e.qZA(),e.TgZ(95,"span",37),e._uU(96,"$"),e.qZA(),e._UZ(97,"input",38),e.qZA(),e.TgZ(98,"mat-form-field",20)(99,"mat-label"),e._uU(100,"Impuesto"),e.qZA(),e.TgZ(101,"span",39),e._uU(102,"%"),e.qZA(),e._UZ(103,"input",40),e.qZA(),e.TgZ(104,"mat-form-field",20)(105,"mat-label"),e._uU(106,"Precio"),e.qZA(),e.TgZ(107,"span",39),e._uU(108,"$"),e.qZA(),e._UZ(109,"input",38),e.qZA()()(),e.TgZ(110,"div",16)(111,"div",17)(112,"span",18),e._uU(113,"Informaci\xf3n log\xedstica"),e.qZA(),e.TgZ(114,"span"),e._uU(115,"Ingrese los relacionados con la tipolog\xeda del producto"),e.qZA()(),e.TgZ(116,"div",19)(117,"mat-form-field",20)(118,"mat-label"),e._uU(119,"Unidad de Medida"),e.qZA(),e.TgZ(120,"mat-select",23),e.YNc(121,Go,3,2,"ng-container",24),e.qZA()(),e.TgZ(122,"mat-form-field",20)(123,"mat-label"),e._uU(124,"Cantidad"),e.qZA(),e._UZ(125,"input",41),e.qZA(),e.TgZ(126,"mat-form-field",20)(127,"mat-label"),e._uU(128,"En Venta"),e.qZA(),e._UZ(129,"input",41),e.qZA(),e.TgZ(130,"mat-form-field",20)(131,"mat-label"),e._uU(132,"SKU"),e.qZA(),e._UZ(133,"input",42),e.qZA(),e.TgZ(134,"mat-form-field",20)(135,"mat-label"),e._uU(136,"C\xf3digo de Barra"),e.qZA(),e._UZ(137,"input",42),e.qZA(),e.TgZ(138,"mat-form-field",20)(139,"mat-label"),e._uU(140,"Peso"),e.qZA(),e.TgZ(141,"span",39),e._uU(142,"g"),e.qZA(),e._UZ(143,"input",38),e.qZA(),e.TgZ(144,"mat-form-field",20)(145,"mat-label"),e._uU(146,"Volumen"),e.qZA(),e.TgZ(147,"span",39),e._uU(148,"cm3"),e.qZA(),e._UZ(149,"input",43),e.qZA(),e.TgZ(150,"mat-form-field",20)(151,"mat-label"),e._uU(152,"Dimensiones"),e.qZA(),e.TgZ(153,"span",39),e._uU(154,"A-L-H"),e.qZA(),e._UZ(155,"input",44),e.qZA()()(),e.TgZ(156,"div",16)(157,"div",17)(158,"span",18),e._uU(159,"Im\xe1genes"),e.qZA(),e.TgZ(160,"span"),e._uU(161,"Inserte las im\xe1genes que del producto"),e.qZA()(),e.TgZ(162,"div",45)(163,"div",17)(164,"span",46),e._uU(165,"Imagen Principal"),e.qZA(),e.TgZ(166,"div",47)(167,"div",48),e.YNc(168,Vo,1,2,"img",49),e.YNc(169,Ho,2,0,"button",50),e.YNc(170,Xo,2,0,"div",51),e.qZA()(),e.YNc(171,Ko,8,3,"div",13),e.qZA(),e.TgZ(172,"div",52)(173,"span",46),e._uU(174,"Im\xe1genes de Apoyo"),e.qZA(),e.TgZ(175,"div",53),e.YNc(176,ei,6,2,"ng-container",24),e.qZA(),e.TgZ(177,"div")(178,"input",54,55),e.NdJ("change",function(s){return i.selectFiles(s,"images")}),e.qZA(),e.TgZ(180,"label",56)(181,"div",57),e._UZ(182,"mat-icon",29),e.TgZ(183,"span",58),e._uU(184," Agregar im\xe1genes "),e.qZA()()()()()()()()()()),2&t){const n=e.MAs(65);e.xp6(9),e.Q6J("svgIcon","heroicons_solid:chevron-right"),e.xp6(4),e.Q6J("svgIcon","heroicons_solid:chevron-right"),e.xp6(4),e.Q6J("svgIcon","heroicons_solid:chevron-right"),e.xp6(7),e.Q6J("ngIf",!i.editMode),e.xp6(1),e.Q6J("ngIf",i.editMode),e.xp6(2),e.Q6J("formGroup",i.productForm)("autocomplete","off"),e.xp6(11),e.Q6J("formControlName","name"),e.xp6(4),e.Q6J("formControlName","description"),e.xp6(4),e.Q6J("formControlName","category"),e.xp6(1),e.Q6J("ngForOf",i.categories),e.xp6(4),e.Q6J("formControlName","brand"),e.xp6(1),e.Q6J("ngForOf",i.brands),e.xp6(4),e.Q6J("formControlName","supplier"),e.xp6(1),e.Q6J("ngForOf",i.suppliers),e.xp6(6),e.Q6J("svgIcon","heroicons_solid:search"),e.xp6(1),e.Q6J("maxLength",50),e.xp6(3),e.Q6J("ngIf",!i.tagsEditMode),e.xp6(1),e.Q6J("ngIf",i.tagsEditMode),e.xp6(2),e.Q6J("ngIf",!i.tagsEditMode),e.xp6(1),e.Q6J("ngIf",i.tagsEditMode),e.xp6(1),e.Q6J("ngIf",i.shouldShowCreateTagButton(n.value)),e.xp6(11),e.Q6J("formControlName","currency"),e.xp6(8),e.Q6J("formControlName","cost"),e.xp6(6),e.Q6J("formControlName","basePrice"),e.xp6(6),e.Q6J("formControlName","taxPercent"),e.xp6(6),e.Q6J("formControlName","price"),e.xp6(11),e.Q6J("formControlName","uom"),e.xp6(1),e.Q6J("ngForOf",i.uoms),e.xp6(4),e.Q6J("formControlName","stock"),e.xp6(4),e.Q6J("formControlName","onSale"),e.xp6(4),e.Q6J("formControlName","sku"),e.xp6(4),e.Q6J("formControlName","barcode"),e.xp6(6),e.Q6J("formControlName","weight"),e.xp6(6),e.Q6J("formControlName","volume"),e.xp6(6),e.Q6J("formControlName","size"),e.xp6(13),e.Q6J("ngIf",i.thumbnail),e.xp6(1),e.Q6J("ngIf",i.thumbnail),e.xp6(1),e.Q6J("ngIf",!i.thumbnail),e.xp6(1),e.Q6J("ngIf",!i.thumbnail),e.xp6(5),e.Q6J("ngForOf",i.images),e.xp6(2),e.Q6J("multiple",!0)("accept","image/jpeg, image/jpg, image/webp, image/png"),e.xp6(4),e.Q6J("svgIcon","heroicons_solid:plus-circle")}},directives:[C.yS,Q.Hw,p.O5,y.lW,Do.PQ,r._Y,r.JL,r.sg,_.KE,_.hX,A.Nt,r.Fj,r.nD,r.Q7,r.JJ,r.u,ge.gD,p.sg,H.ey,fe.oG,_.R9,H.wG,_.qo,r.qQ,r.Fd,r.wV],encapsulation:2}),o})(),resolve:{brands:ye,categories:Se,products:we,tags:go,suppliers:Ae,uoms:Te}},{path:"brands",component:Ft,resolve:{brands:ye}},{path:"categories",component:po,resolve:{categories:Se}},{path:"suppliers",component:Fo,resolve:{suppliers:Ae}},{path:"uom",component:Ht,resolve:{uoms:Te}},{path:"warehouse",component:gt}]}];let oi=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[[C.Bz.forChild(ti),Ue.m]]}),o})()}}]);