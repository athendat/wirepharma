"use strict";(self.webpackChunkwire_store=self.webpackChunkwire_store||[]).push([[100],{4100:(De,_,i)=>{i.r(_),i.d(_,{ShopCheckoutModule:()=>Te});var R=i(4035),M=i(2998),l=i(3075),F=i(9646),$=i(7579),k=i(4004),p=i(2722),A=i(801),j=i(9652),O=i(1650),T=i(5925),D=i(4787);var d=(()=>{return(t=d||(d={})).VISA="VISA",t.MASTERCARD="MASTERCARD",t.AMERICANEXPRESS="AMERICANEXPRESS",t.DISCOVER="DISCOVER",t.DINERSCLUB="DINERSCLUB",t.JCB="JCB",t.MAESTRO="MAESTRO",t.UNIONPAY="UNIONPAY",t.DANKORT="DANKORT",t.FORBRUGSFORENINGEN="FORBRUGSFORENINGEN",d;var t})();const c=t=>Array(t).fill(/\d/),h=/(\d{1,4})/g,b=[...c(4)," ",...c(4)," ",...c(4)," ",...c(4)," ",...c(3)],E=[...c(4)," ",...c(4)," ",...c(4)," ",...c(4)],W=[...c(4)," ",...c(6)," ",...c(4)],z=[...c(4)," ",...c(6)," ",...c(5)],G=Object.freeze([{type:d.VISA,patterns:[4],format:h,mask:b,length:[13,16,19],cvvLength:[3],luhn:!0},{type:d.MAESTRO,patterns:[5018,502,503,506,56,58,639,6220,67],format:h,mask:b,length:[12,13,14,15,16,17,18,19],cvvLength:[3],luhn:!0},{type:d.FORBRUGSFORENINGEN,patterns:[600],format:h,mask:E,length:[16],cvvLength:[3],luhn:!0},{type:d.DANKORT,patterns:[5019],format:h,mask:E,length:[16],cvvLength:[3],luhn:!0},{type:d.MASTERCARD,patterns:[51,52,53,54,55,22,23,24,25,26,27],format:h,mask:E,length:[16],cvvLength:[3],luhn:!0},{type:d.AMERICANEXPRESS,patterns:[34,37],format:/(\d{1,4})(\d{1,6})?(\d{1,5})?/,mask:z,length:[15],cvvLength:[3,4],luhn:!0},{type:d.DINERSCLUB,patterns:[30,36,38,39],format:/(\d{1,4})(\d{1,6})?(\d{1,4})?/,mask:W,length:[14],cvvLength:[3],luhn:!0},{type:d.DISCOVER,patterns:[60,64,65,622],format:h,mask:E,length:[16],cvvLength:[3],luhn:!0},{type:d.UNIONPAY,patterns:[62,88],format:h,mask:b,length:[16,17,18,19],cvvLength:[3],luhn:!1},{type:d.JCB,patterns:[35],format:h,mask:b,length:[16,19],cvvLength:[3],luhn:!0}]);var C=i(8966),e=i(5e3),v=i(9808),P=i(7423);function Y(t,r){if(1&t&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"div",8)(2,"div",9)(3,"span",10),e.\u0275\u0275text(4),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(5,"div",11),e.\u0275\u0275text(6),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementContainerEnd()),2&t){const o=r.$implicit;e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate(o.productName),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(o.onSale)}}let H=(()=>{class t{constructor(o,n){this._dialogRef=o,this.data=n,this.onSaleAvailable=n}ngOnInit(){}acceptClick(){this._dialogRef.close(!0)}rejectClick(){this._dialogRef.close(!1)}}return t.\u0275fac=function(o){return new(o||t)(e.\u0275\u0275directiveInject(C.so),e.\u0275\u0275directiveInject(C.WI))},t.\u0275cmp=e.\u0275\u0275defineComponent({type:t,selectors:[["checkout-stock-dialog"]],decls:15,vars:1,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[1,"flex","flex-col","my-5","divide-y"],[4,"ngFor","ngForOf"],["mat-dialog-actions",""],["mat-button","",3,"click"],[1,"flex-auto"],["mat-raised-button","","cdkFocusInitial","",1,"px-5","py-3","text-white","uppercase","w-60","sm:w-auto","bg-gradient-to-r","from-wire-400","via-wire-500","to-wire-600","hover:bg-gradient-to-br","text-md",3,"click"],[1,"grid","grid-cols-2","py-1","on-sale-grid"],[1,"flex","items-center","mr-2"],[1,"truncate"],[1,"text-red-500","bg-red-100","rounded-sm","p-2","text-center"]],template:function(o,n){1&o&&(e.\u0275\u0275elementStart(0,"h1",0),e.\u0275\u0275text(1,"Comprobaci\xf3n de cantidades"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(2,"div",1)(3,"p"),e.\u0275\u0275text(4,"Lo sentimos, los siguientes productos solo tienen disponibles las cantidades que se muestran a continuaci\xf3n."),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"div",2),e.\u0275\u0275template(6,Y,7,2,"ng-container",3),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(7,"p"),e.\u0275\u0275text(8,"\xbfDesea ajustar las cantidades de su compra autom\xe1ticamente?"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(9,"div",4)(10,"button",5),e.\u0275\u0275listener("click",function(){return n.rejectClick()}),e.\u0275\u0275text(11,"No Gracias"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(12,"div",6),e.\u0275\u0275elementStart(13,"button",7),e.\u0275\u0275listener("click",function(){return n.acceptClick()}),e.\u0275\u0275text(14," Ok "),e.\u0275\u0275elementEnd()()),2&o&&(e.\u0275\u0275advance(6),e.\u0275\u0275property("ngForOf",n.onSaleAvailable))},directives:[C.uh,C.xY,v.sg,C.H8,P.lW],styles:[".on-sale-grid[_ngcontent-%COMP%]{grid-template-columns:80% 20%}"]}),t})();var K=i(5113),Z=i(1135),V=i(8505),S=i(5620);const X=(0,S.PH)("[CHECKOUT] Set PaymentWays",(0,S.Ky)());(0,S.PH)("[CHECKOUT] Clear PaymentWays");var J=i(2340),Q=i(520);const y=J.N.API_URL;let q=(()=>{class t{constructor(o,n){this._httpClient=o,this.store=n,this._orders=new Z.X([])}get orders$(){return this._orders.asObservable()}createOrder(o){return this._httpClient.post(`${y}/orders/single`,o).pipe((0,k.U)(n=>(console.log("Response: ",n),n)))}createOrders(o){return console.log("Orders: ",o),this._httpClient.post(`${y}/orders/`,o).pipe((0,k.U)(n=>(console.log("Response: ",n),n)))}getOrdersByCustomer(o){return this._httpClient.get(`${y}/orders/filter-client/${o}`).pipe((0,V.b)(n=>(console.log(n),this._orders.next(n.orders),n)),(0,k.U)(n=>n.orders))}getPaymentWays(){return this._httpClient.get("assets/data/payment-ways.json").pipe((0,V.b)(o=>this.store.dispatch(X({paymentWays:o}))))}checkStock(o){return this._httpClient.post(`${y}/products/check-stock`,{orderProducts:o})}}return t.\u0275fac=function(o){return new(o||t)(e.\u0275\u0275inject(Q.eN),e.\u0275\u0275inject(S.yh))},t.\u0275prov=e.\u0275\u0275defineInjectable({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var ee=i(1158),te=i(7261),L=i(6688),N=i(7322),ne=i(7531),oe=i(4107),re=i(508),ae=i(5245);function ie(t,r){1&t&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"mat-chip-list",28)(2,"mat-chip",29),e.\u0275\u0275text(3," \xa1Debe Iniciar Sesi\xf3n para confirmar su pedido! "),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementContainerEnd())}function le(t,r){1&t&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"mat-error",30),e.\u0275\u0275text(2,"El n\xfamero de identidad es obligatorio "),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd())}function se(t,r){1&t&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"mat-error",30),e.\u0275\u0275text(2,"El n\xfamero de identidad solo debe contener caracteres num\xe9ricos"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd())}function ce(t,r){1&t&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"mat-error",30),e.\u0275\u0275text(2,"El n\xfamero de identidad debe contener once caracteres"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd())}function me(t,r){1&t&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"mat-error",30),e.\u0275\u0275text(2,"El n\xfamero de identidad debe contener once caracteres"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd())}function de(t,r){if(1&t&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"mat-error",30),e.\u0275\u0275text(2),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd()),2&t){const o=e.\u0275\u0275nextContext();e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",o.checkoutForm.get("idNumber").getError("validateIdNumber")," ")}}function ue(t,r){1&t&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"mat-error",30),e.\u0275\u0275text(2,"El nombre es obligatorio "),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd())}function pe(t,r){1&t&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"mat-error",30),e.\u0275\u0275text(2,"El nombre no debe contener vocales con tildes, n\xfameros o s\xedmbolos"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd())}function he(t,r){1&t&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"mat-error",30),e.\u0275\u0275text(2,"Debe introducir el nombre y al menos un apellido"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd())}function ge(t,r){1&t&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"mat-error",30),e.\u0275\u0275text(2,"El tel\xe9fono es obligatorio "),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd())}function fe(t,r){1&t&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"mat-error",30),e.\u0275\u0275text(2," El tel\xe9fono debe contener solo n\xfameros y un m\xednimo de ocho d\xedgitos "),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd())}function Ce(t,r){1&t&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"mat-error",30),e.\u0275\u0275text(2," El correo electr\xf3nico no presenta un patr\xf3n v\xe1lido "),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd())}function ve(t,r){if(1&t&&(e.\u0275\u0275elementStart(0,"mat-option",19),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&t){const o=r.$implicit;e.\u0275\u0275property("value",o),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1("",o," ")}}function Se(t,r){1&t&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"mat-error",30),e.\u0275\u0275text(2," Debe seleccionar la provincia "),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd())}function ke(t,r){if(1&t&&(e.\u0275\u0275elementStart(0,"mat-option",19),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&t){const o=r.$implicit;e.\u0275\u0275property("value",o.city),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",o.city," ")}}function be(t,r){1&t&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"mat-error",30),e.\u0275\u0275text(2," Debe seleccionar el municipio "),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd())}function Ee(t,r){1&t&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"mat-error",30),e.\u0275\u0275text(2," La direcci\xf3n es obligatoria "),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd())}function ye(t,r){if(1&t&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"div",41)(2,"div",33)(3,"span",42),e.\u0275\u0275text(4),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(5,"div",35)(6,"span",42),e.\u0275\u0275text(7),e.\u0275\u0275pipe(8,"currency"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementContainerEnd()),2&t){const o=r.$implicit;e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate2("",o.product.name," \xd7 ",o.quantity,""),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind4(8,3,o.product.price*o.quantity,"$ ","symbol","1.2-2")," ")}}function xe(t,r){1&t&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275text(1," Confirmar y Pagar Orden "),e.\u0275\u0275elementContainerEnd())}function Ie(t,r){1&t&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"div",43),e.\u0275\u0275namespaceSVG(),e.\u0275\u0275elementStart(2,"svg",44),e.\u0275\u0275element(3,"path",45)(4,"path",46),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementContainerEnd())}function Fe(t,r){if(1&t){const o=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"div",32)(2,"div",33)(3,"span",34),e.\u0275\u0275text(4,"Producto"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(5,"div",35)(6,"span",34),e.\u0275\u0275text(7," Total "),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(8,"div",36),e.\u0275\u0275template(9,ye,9,8,"ng-container",37),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(10,"div",38)(11,"div",39)(12,"div",33)(13,"span",34),e.\u0275\u0275text(14,"Total"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(15,"div",35)(16,"span",34),e.\u0275\u0275text(17),e.\u0275\u0275pipe(18,"currency"),e.\u0275\u0275elementEnd()()()(),e.\u0275\u0275elementStart(19,"button",40),e.\u0275\u0275listener("click",function(){return e.\u0275\u0275restoreView(o),e.\u0275\u0275nextContext(2).confirmOrder()}),e.\u0275\u0275template(20,xe,2,0,"ng-container",3),e.\u0275\u0275template(21,Ie,5,0,"ng-container",3),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd()}if(2&t){const o=e.\u0275\u0275nextContext().ngIf,n=e.\u0275\u0275nextContext();e.\u0275\u0275advance(9),e.\u0275\u0275property("ngForOf",o.basketItems),e.\u0275\u0275advance(8),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind4(18,5,n.basketSubtotal,"$ ","symbol","1.2-2")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",n.checkoutForm.invalid),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!n.checkoutFormSubmitted),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",n.checkoutFormSubmitted)}}function Ne(t,r){if(1&t&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,Fe,22,10,"ng-container",31),e.\u0275\u0275elementContainerEnd()),2&t){const o=r.ngIf;e.\u0275\u0275nextContext();const n=e.\u0275\u0275reference(75);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",o.basketItems.length>0)("ngIfElse",n)}}function _e(t,r){1&t&&(e.\u0275\u0275elementStart(0,"div",47),e.\u0275\u0275element(1,"mat-icon",48),e.\u0275\u0275elementStart(2,"div",49),e.\u0275\u0275text(3,"\xa1Su cesta est\xe1 vac\xeda!"),e.\u0275\u0275elementEnd()()),2&t&&(e.\u0275\u0275advance(1),e.\u0275\u0275property("svgIcon","iconsmind:shopping_bag"))}const Oe=[{path:"",component:(()=>{class t{constructor(o,n,a,s,m,u,f,g,x){this.breakpointObserver=o,this._changeDetectorRef=n,this._checkoutService=a,this._dialog=s,this._formBuilder=m,this._locationService=u,this._router=f,this._snackBar=g,this.store=x,this.cities=[],this.faXmark=A.g82,this.faCircleCheck=A.fV7,this.stateCode="",this.states=[],this.statesCodes=[],this.stateSelected="",this.discount=0,this.isLoading=!1,this.isLogged$=(0,F.of)(!1),this.checkoutFormSubmitted=!1,this.basketSubtotal=0,this.basketSubtotal$=(0,F.of)(0),this.user$=(0,F.of)(),this.orderProducts=[],this.ordersByBusiness=[],this.months=["01","02","03","04","05","06","07","08","09","10","11","12"],this.years=["2022","2023","2024","2025","2026","2027","2028","2029","2030"],this.mask=["(",/[1-9]/,/\d/,/\d/,")"," ",/\d/,/\d/,/\d/,"-",/\d/,/\d/,/\d/,/\d/],this.payments=["Create an Account?","Flat Rate"],this.paymantWay=["Direct Bank Transfer","PayPal"],this._unsubscribeAll=new $.x,this.stepperOrientation=o.observe("(min-width: 800px)").pipe((0,k.U)(({matches:I})=>I?"horizontal":"vertical"))}ngOnInit(){var o;this.basket$=this.store.select(T.Q2),this.basket$.pipe((0,p.R)(this._unsubscribeAll)).subscribe(n=>{this.basket=n;for(let a=0;a<this.basket.basketItems.length;a++){const s=this._mapBasketItemsToOrderProducts(this.basket.basketItems[a]);this.orderProducts.push(s)}this._changeDetectorRef.markForCheck()}),this.basketSubtotal$=this.store.select(T.JN),this.basketSubtotal$.pipe((0,p.R)(this._unsubscribeAll)).subscribe(n=>{this.basketSubtotal=n,this._changeDetectorRef.markForCheck()}),this.isLogged$=this.store.select(D.dD),this.user$=this.store.select(D.dy),this.user$.pipe((0,p.R)(this._unsubscribeAll)).subscribe(n=>{this.user=n,this._changeDetectorRef.markForCheck()}),this._locationService.states$.pipe((0,p.R)(this._unsubscribeAll)).subscribe(n=>{this.states=n,this._changeDetectorRef.markForCheck()}),this._locationService.statesCodes$.pipe((0,p.R)(this._unsubscribeAll)).subscribe(n=>{this.statesCodes=n,this._changeDetectorRef.markForCheck()}),this.checkoutForm=this._formBuilder.group({idNumber:["",[l.Validators.required,l.Validators.pattern("^[0-9]*$"),l.Validators.minLength(11),l.Validators.maxLength(11)]],fullName:["",[l.Validators.required,l.Validators.pattern("^[a-zA-Z ]*$")]],phoneNumber:["",[l.Validators.required,l.Validators.pattern("^[0-9]*$")]],email:["",[l.Validators.required,l.Validators.email,l.Validators.pattern("^[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+.[a-zA-Z0-9-.]+$")]],address:["",[l.Validators.required]],state:[null,[l.Validators.required]],city:[null,[l.Validators.required]],obs:[null]}),null===(o=this.checkoutForm.get("state"))||void 0===o||o.valueChanges.pipe((0,p.R)(this._unsubscribeAll)).subscribe(n=>{this._getCitiesByState(n),this._changeDetectorRef.markForCheck()}),this.cardForm=this._formBuilder.group({fullName:["",[l.Validators.required]],cardNo:["",[l.Validators.required,t=>{const r=(t=>{if(!t.length)return!1;t=t.replace(/\s/g,"");const r=Number(t[t.length-1]),o=t.slice(0,t.length-1).split("").reverse().map(a=>Number(a));let n=0;for(let a=0;a<=o.length-1;a+=2)o[a]=2*o[a],o[a]>9&&(o[a]=o[a]-9);return n=o.reduce((a,s)=>a+s,0),(n+r)%10==0})(t.value);return r?null:{luhnCheck:r}}]],month:["",[l.Validators.required]],year:["",[l.Validators.required]],cvv:["",[l.Validators.required,l.Validators.minLength(3),l.Validators.maxLength(4),l.Validators.pattern("^[0-9]*$")]]})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}validateFullName(o){return n=>{var a;const s=n.get(o);if(!s)return null;const m=null===(a=s.value)||void 0===a?void 0:a.split(" ",3);if(m.length>1&&""!==m[1])return null;s.hasError("validateFullName")&&(delete s.errors.validateFullName,s.updateValueAndValidity());const u={validateFullName:"El nombre completo no es correcto"};return s.setErrors(u),u}}validateIdNumber(o){return n=>{const a=n.get(o);if(!a)return null;const s=a.value,m=parseInt(s.substring(0,2),10),u=parseInt(s.substring(2,4),10)-1,f=parseInt(s.substring(4,6),10),g=new Date(m,u,f);if(g.getFullYear().toString().substring(2,4)===m.toString()&&g.getMonth()===u&&g.getDate()===f)return null;const I={validateIdNumber:"El n\xfamero de identidad introducido es incorrecto"};return a.setErrors(I),I}}getCardNumberControl(){return this.cardForm&&this.cardForm.get("cardNo")}cardMaskFunction(o){const n=(t=>G.find(r=>!!r.patterns.map(a=>new RegExp(`^${a}`,"g")).map(a=>t.match(a)).filter(a=>a).length)||null)(o);return n?n.mask:[/\d/]}confirmOrder(){this.checkoutFormSubmitted=!0;const o=this.checkoutForm.getRawValue(),n={orderType:"Minorista",currency:"USD",clientId:this.user._id,beneficiary:o,products:this.orderProducts,subtotal:this.basketSubtotal,discount:0,tax:0,shippingCost:0,total:this.basketSubtotal,paymentWay:"Transferencia",paymentStatus:"Pendiente",shippingWay:"Entrega a domicilio",tracking:(0,j.kP)("1234567890WIRPHAM",8)(),payed:!1,ready:!1,shipped:!1,delivered:!1,canceled:!1,status:"Pendiente de pago"};console.log("OrderData: ",n),this._checkoutService.checkStock(n.products).subscribe(a=>{console.log("Response",a),a.ok||this._openStockProblemDialog(a.onSaleAvailable,n)}),this._checkoutService.createOrder(n).pipe((0,p.R)(this._unsubscribeAll)).subscribe(a=>{this.store.dispatch((0,O.RT)()),localStorage.removeItem("Basket"),localStorage.removeItem("basketId"),this._snackBar.open(a.message,"",{panelClass:"success",horizontalPosition:"center",verticalPosition:"top",duration:3e3}),this._router.navigateByUrl("/products")},a=>{this._snackBar.open("Lo sentimos ha ocurrido un error inesperado","",{panelClass:"error",horizontalPosition:"center",verticalPosition:"top",duration:3e3}),this.checkoutFormSubmitted=!1,console.warn("ConfirmOrdersError: ",a)})}_getCitiesByState(o){o!==this.stateSelected&&this._locationService.getCitiesByState(o).subscribe(n=>{this.cities=n,this._changeDetectorRef.markForCheck()})}_mapBasketItemsToOrderProducts(o){return{productId:o.product._id,productPrice:o.product.price,productName:o.product.name,quantity:o.quantity}}_openStockProblemDialog(o,n){this._dialog.open(H,{width:"350px",data:o}).afterClosed().subscribe(s=>{if(s){let m=Object.assign({},n),u=m.products;for(const f of o){const g=u.findIndex(x=>x.productId===f.productId);g>-1&&(u[g].quantity=f.onSale)}m.products=u}this._checkoutService.createOrder(n).pipe((0,p.R)(this._unsubscribeAll)).subscribe(m=>{this.store.dispatch((0,O.RT)()),localStorage.removeItem("Basket"),localStorage.removeItem("basketId"),this._snackBar.open(m.message,"",{panelClass:"success",horizontalPosition:"center",verticalPosition:"top",duration:3e3}),this._router.navigateByUrl("/products")},m=>{this._snackBar.open("Lo sentimos ha ocurrido un error inesperado","",{panelClass:"error",horizontalPosition:"center",verticalPosition:"top",duration:3e3}),this.checkoutFormSubmitted=!1,console.warn("ConfirmOrdersError: ",m)})})}}return t.\u0275fac=function(o){return new(o||t)(e.\u0275\u0275directiveInject(K.Yg),e.\u0275\u0275directiveInject(e.ChangeDetectorRef),e.\u0275\u0275directiveInject(q),e.\u0275\u0275directiveInject(C.uw),e.\u0275\u0275directiveInject(l.FormBuilder),e.\u0275\u0275directiveInject(ee.a),e.\u0275\u0275directiveInject(R.F0),e.\u0275\u0275directiveInject(te.ux),e.\u0275\u0275directiveInject(S.yh))},t.\u0275cmp=e.\u0275\u0275defineComponent({type:t,selectors:[["shop-checkout"]],decls:76,vars:26,consts:[[1,"flex-col","w-full","flex","py-5","sm:py-20"],[1,"grid","grid-cols-1","gap-5","bg-white","md:grid-cols-2"],[1,"flex","flex-col","gap-y-5","px-3"],[4,"ngIf"],[1,"text-5xl","font-semibold","text-center","sm:text-left"],[1,"flex","flex-col","items-center","gap-y-5","md:items-start"],[1,"w-50","h-0.5","flex","justify-center","md:justify-start","bg-gray-100"],[1,"flex","w-1/3","h-0.5","bg-wire-500"],[1,"text-lg","mb-7"],[1,"flex","flex-col","w-full",3,"formGroup","autocomplete"],["checkoutNgForm","ngForm"],[1,"flex","flex-col","w-full","gap-5","md:flex-row"],["appearance","standard",1,"w-full","sm:w-1/2"],[1,"font-sans"],["matInput","","formControlName","idNumber","type","text","minlength","11","maxlength","11","required","",1,"font-sans"],["matInput","","formControlName","fullName","type","text","id","fullName","maxlength","150","required","",1,"font-sans"],["matInput","","formControlName","phoneNumber","type","tel","id","phoneNumber","required","","minlength","8","maxlength","10",1,"font-sans"],["matInput","","formControlName","email","type","email","required","",1,"font-sans"],["formControlName","state"],[3,"value"],[3,"value",4,"ngFor","ngForOf"],["formControlName","city"],[1,"w-full"],["appearance","standard",1,"w-full"],["matInput","","formControlName","address","required","",1,"font-sans"],["matInput","","formControlName","obs","rows","2",1,"font-sans"],[1,"flex","flex-col","p-6","border"],["noItems",""],["aria-label","Color selection",1,"mat-chip-list-stacked","flex","items-center","justify-center"],[1,"logged-ship","p-4","mb-4","font-semibold","cursor-pointer"],[1,"mt-2","text-sm","text-red-600","dark:text-red-500"],[4,"ngIf","ngIfElse"],[1,"grid","w-full","grid-cols-3","pb-5","border-b"],[1,"flex","items-center","justify-start","col-span-2"],[1,"text-2xl","font-medium"],[1,"flex","items-center","justify-start"],[1,"flex","flex-col"],[4,"ngFor","ngForOf"],[1,"flex","flex-col","w-full","py-5","border-t","border-b","gap-y-5"],[1,"grid","w-full","grid-cols-3","gap-x-3"],["mat-raised-button","",1,"mt-5","text-white","bg-wire-500",3,"disabled","click"],[1,"grid","w-full","grid-cols-3","py-3","gap-x-3"],[1,""],[1,"flex","items-center","justify-center","w-full"],["role","status","viewBox","0 0 100 101","fill","none","xmlns","http://www.w3.org/2000/svg",1,"w-6","h-6","text-gray-200","animate-spin","dark:text-gray-600","fill-wire-600"],["d","M100 50.5908C100 78.2051 77.6142 100.591 50 100.591C22.3858 100.591 0 78.2051 0 50.5908C0 22.9766 22.3858 0.59082 50 0.59082C77.6142 0.59082 100 22.9766 100 50.5908ZM9.08144 50.5908C9.08144 73.1895 27.4013 91.5094 50 91.5094C72.5987 91.5094 90.9186 73.1895 90.9186 50.5908C90.9186 27.9921 72.5987 9.67226 50 9.67226C27.4013 9.67226 9.08144 27.9921 9.08144 50.5908Z","fill","currentColor"],["d","M93.9676 39.0409C96.393 38.4038 97.8624 35.9116 97.0079 33.5539C95.2932 28.8227 92.871 24.3692 89.8167 20.348C85.8452 15.1192 80.8826 10.7238 75.2124 7.41289C69.5422 4.10194 63.2754 1.94025 56.7698 1.05124C51.7666 0.367541 46.6976 0.446843 41.7345 1.27873C39.2613 1.69328 37.813 4.19778 38.4501 6.62326C39.0873 9.04874 41.5694 10.4717 44.0505 10.1071C47.8511 9.54855 51.7191 9.52689 55.5402 10.0491C60.8642 10.7766 65.9928 12.5457 70.6331 15.2552C75.2735 17.9648 79.3347 21.5619 82.5849 25.841C84.9175 28.9121 86.7997 32.2913 88.1811 35.8758C89.083 38.2158 91.5421 39.6781 93.9676 39.0409Z","fill","currentFill"],[1,"flex","flex-col","items-center","justify-center","flex-automin-h-140","dark:bg-transparent"],[1,"icon-size-20",3,"svgIcon"],[1,"mt-6","text-2xl","font-semibold","tracking-tight","text-secondary"]],template:function(o,n){1&o&&(e.\u0275\u0275elementStart(0,"div",0)(1,"div",1)(2,"div",2),e.\u0275\u0275template(3,ie,4,0,"ng-container",3),e.\u0275\u0275pipe(4,"async"),e.\u0275\u0275elementStart(5,"div",4),e.\u0275\u0275text(6," Datos del destinatario "),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(7,"div",5)(8,"div",6),e.\u0275\u0275element(9,"div",7),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(10,"div",8),e.\u0275\u0275text(11," Introduzca los datos de la persona que recibir\xe1 la orden. "),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(12,"form",9,10)(14,"div",11)(15,"mat-form-field",12)(16,"mat-label",13),e.\u0275\u0275text(17,"N\xfamero de identidad"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(18,"input",14),e.\u0275\u0275template(19,le,3,0,"ng-container",3),e.\u0275\u0275template(20,se,3,0,"ng-container",3),e.\u0275\u0275template(21,ce,3,0,"ng-container",3),e.\u0275\u0275template(22,me,3,0,"ng-container",3),e.\u0275\u0275template(23,de,3,1,"ng-container",3),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(24,"mat-form-field",12)(25,"mat-label",13),e.\u0275\u0275text(26,"Nombre completo "),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(27,"input",15),e.\u0275\u0275template(28,ue,3,0,"ng-container",3),e.\u0275\u0275template(29,pe,3,0,"ng-container",3),e.\u0275\u0275template(30,he,3,0,"ng-container",3),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(31,"div",11)(32,"mat-form-field",12)(33,"mat-label",13),e.\u0275\u0275text(34,"Tel\xe9fono "),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(35,"input",16),e.\u0275\u0275template(36,ge,3,0,"ng-container",3),e.\u0275\u0275template(37,fe,3,0,"ng-container",3),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(38,"mat-form-field",12)(39,"mat-label",13),e.\u0275\u0275text(40,"Correo electr\xf3nico"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(41,"input",17),e.\u0275\u0275template(42,Ce,3,0,"ng-container",3),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(43,"div",11)(44,"mat-form-field",12)(45,"mat-label",13),e.\u0275\u0275text(46,"Provincia"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(47,"mat-select",18)(48,"mat-option",19),e.\u0275\u0275text(49,"Seleccione la provincia"),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(50,ve,2,2,"mat-option",20),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(51,Se,3,0,"ng-container",3),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(52,"mat-form-field",12)(53,"mat-label",13),e.\u0275\u0275text(54,"Municipio"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(55,"mat-select",21)(56,"mat-option",19),e.\u0275\u0275text(57,"Seleccione el municipio"),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(58,ke,2,2,"mat-option",20),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(59,be,3,0,"ng-container",3),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(60,"div",22)(61,"mat-form-field",23)(62,"mat-label",13),e.\u0275\u0275text(63,"Direcci\xf3n"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(64,"textarea",24),e.\u0275\u0275template(65,Ee,3,0,"ng-container",3),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(66,"div",22)(67,"mat-form-field",23)(68,"mat-label",13),e.\u0275\u0275text(69,"Observaciones"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(70,"textarea",25),e.\u0275\u0275elementEnd()()()()(),e.\u0275\u0275elementStart(71,"div",26),e.\u0275\u0275template(72,Ne,2,2,"ng-container",3),e.\u0275\u0275pipe(73,"async"),e.\u0275\u0275template(74,_e,4,1,"ng-template",null,27,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementEnd()()()),2&o&&(e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",!e.\u0275\u0275pipeBind1(4,22,n.isLogged$)),e.\u0275\u0275advance(9),e.\u0275\u0275property("formGroup",n.checkoutForm)("autocomplete","off"),e.\u0275\u0275advance(7),e.\u0275\u0275property("ngIf",n.checkoutForm.get("idNumber").hasError("required")&&n.checkoutForm.get("idNumber").touched),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",n.checkoutForm.get("idNumber").hasError("pattern")&&n.checkoutForm.get("idNumber").touched),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",n.checkoutForm.get("idNumber").hasError("minLength")&&n.checkoutForm.get("idNumber").touched),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",n.checkoutForm.get("idNumber").hasError("maxLength")&&n.checkoutForm.get("idNumber").touched),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",n.checkoutForm.get("idNumber").hasError("validateIdNumber")&&n.checkoutForm.get("idNumber").touched),e.\u0275\u0275advance(5),e.\u0275\u0275property("ngIf",n.checkoutForm.get("fullName").hasError("required")&&n.checkoutForm.get("fullName").touched),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",n.checkoutForm.get("fullName").hasError("pattern")&&n.checkoutForm.get("fullName").touched),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",n.checkoutForm.get("fullName").hasError("validateFullName")&&n.checkoutForm.get("fullName").touched),e.\u0275\u0275advance(6),e.\u0275\u0275property("ngIf",n.checkoutForm.get("phoneNumber").hasError("required")&&n.checkoutForm.get("phoneNumber").touched),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",n.checkoutForm.get("phoneNumber").hasError("pattern")&&n.checkoutForm.get("phoneNumber").touched),e.\u0275\u0275advance(5),e.\u0275\u0275property("ngIf",n.checkoutForm.get("email").hasError("pattern")&&n.checkoutForm.get("email").touched),e.\u0275\u0275advance(6),e.\u0275\u0275property("value",null),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngForOf",n.states),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",n.checkoutForm.get("state").hasError("required")&&n.checkoutForm.get("state").touched),e.\u0275\u0275advance(5),e.\u0275\u0275property("value",null),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngForOf",n.cities),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",n.checkoutForm.get("city").hasError("required")&&n.checkoutForm.get("city").touched),e.\u0275\u0275advance(6),e.\u0275\u0275property("ngIf",n.checkoutForm.get("address").hasError("required")&&n.checkoutForm.get("address").touched),e.\u0275\u0275advance(7),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(73,24,n.basket$)))},directives:[v.O5,L.qn,L.HS,l.\u0275NgNoValidate,l.NgControlStatusGroup,l.FormGroupDirective,N.KE,N.hX,ne.Nt,l.DefaultValueAccessor,l.NgControlStatus,l.FormControlName,l.MinLengthValidator,l.MaxLengthValidator,l.RequiredValidator,N.TO,oe.gD,re.ey,v.sg,P.lW,ae.Hw],pipes:[v.Ov,v.H9],encapsulation:2}),t})(),resolve:{location:i(1227).N}}];let Te=(()=>{class t{}return t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=e.\u0275\u0275defineNgModule({type:t}),t.\u0275inj=e.\u0275\u0275defineInjector({imports:[[R.Bz.forChild(Oe),M.m]]}),t})()}}]);